<!doctype html>
<html full>
<head>
<div id='wx_pic' style='margin:0 auto;display:none;'>
	<img src='img/wx_pic.jpg' />
</div>
<title>功夫集团 新春晚会之参会指引</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">
<script language="javascript" src="js/function.js" type="text/javascript"></script>
<script src="js/easeljs.js"></script>
<script src="js/tweenjs.js"></script>
<script src="js/movieclip.js"></script>
<script src="js/preloadjs.js"></script>
<script src="js/content.js"></script>
<script src="js/APIWrapper.js"></script>
    <script src="js/SCOFunctions.js"></script>
<script type="text/javascript">
var pageTotal=19;//1~20
var page=1; 
var PageNum=0;
var scaleWidth;
var scaleHeight;
var ContentName = "";

var canvas, stage, exportRoot;
window.onresize=centerFun;
function centerFun(){
stageScreenSetting("contentCanvas",720,1158);
}
function stageScreenSetting(divname,curW,curH){
	//<div id="window" style="position:absolute;overflow:hidden; width:1280px; height:720px;">
	var htmlw=document.documentElement.clientWidth;//document.getElementById("htmlfulls").offsetWidth;
	var htmlh=document.documentElement.clientHeight;//document.getElementById("htmlfulls").offsetHeight;
	var scaleX=htmlw/curW;
	var scaleY=htmlh/curH;
	//var scaleXY=Math.min(scaleX,scaleY);
	//scaleX=scaleXY;
	//scaleY=scaleXY;
	var matrixStr="scale3d("+scaleX+","+scaleY+",1)";//var matrixStr="matrix("+scaleX+",0,0,"+scaleY+",0,0)";
	var ContentDiv=document.getElementById(divname);   //最外层包裹id="window"
	ContentDiv.style.transform=matrixStr;
	ContentDiv.style.msTransform=matrixStr;//IE 9 
	ContentDiv.style.MozTransform=matrixStr;//Firefox
	ContentDiv.style.webkitTransform=matrixStr;// Safari 和 Chrome 
	ContentDiv.style.oTransform=matrixStr;// Opera
	
	var tmpw=htmlw*scaleX;
	var tmph=htmlh*scaleY;
	var tmp2w=curW*scaleX;
	var tmp2h=curH*scaleY;
	var tmpL=(tmpw-tmp2w)/2;
	var tmpT=(tmph-tmp2h)/2;
	ContentDiv.style.left=tmpL/scaleX+"px";
	ContentDiv.style.top=tmpT/scaleY+"px";
	ContentDiv.tmpw=tmpw;
	ContentDiv.tmph=tmph;
	ContentDiv.tmp2w=tmp2w;
	ContentDiv.tmp2h=tmp2h;
}
function Canvasinit() {
	canvas = document.getElementById("mycanvas");
	images = images||{};

	var loader = new createjs.LoadQueue(false);
	loader.addEventListener("fileload", handleFileLoad);
	loader.addEventListener("complete", initgamecomplete);
	loader.loadManifest(lib.properties.manifest);
	
	centerFun();
}

function handleFileLoad(evt) {
	if (evt.item.type == "image") { images[evt.item.id] = evt.result; }
}

function handleComplete() {
	exportRoot = new lib.content();

	stage = new createjs.Stage(canvas);
	stage.addChild(exportRoot);
	stage.update();

	createjs.Ticker.setFPS(lib.properties.fps);
	createjs.Ticker.addEventListener("tick", stage);
	
	//exportRoot.frame_0(ContentName);

	exportRoot.frame_1(PN_pageNum);	
}
function gotoContentCanvas(obj){
	//alert(exportRoot)
    console.log(obj)
	if(obj==pageTotal){
		doLMSSetValue("cmi.core.score.raw",100);
		doLMSSetValue("cmi.core.lesson_status","completed");
		doLMSCommit();
		console.log('run')
	}
	exportRoot.frame_1(obj);
	//handleComplete();
	//exportRoot.frame_1(obj);
}
</script>
<link rel="stylesheet" type="text/css" href="css/css.css" />
</head>
<body ondragstart="return false" full onLoad="initPage()" onUnload="javascript:unloadExit()">
<audio id="myAudio" src="" style="display:none"></audio>
<!--overflow:hidden; -->
<div id='window' style=" left:0%; top:0%; width:100%; height:100%;display:none;background:#ffffff;"> 
         <!--<img id="window_bg" class="imgrsp" src="images/p6_1.png" style="position:absolute; top:0%; left:0%; " alt="" />  -->
         <div full id="loadbar">
            <img src="img/loading.gif" style="position:absolute;width:23.148%;height:14.393%;left:38.426%;top:42.804%;">
        </div>
        <div id="PN1" full style="position:absolute; top:0%; left:0%;">
             <div id="contentCanvas" style="position:absolute;overflow:hidden; width:720px; height:1158px;"><canvas id="mycanvas" width="720" height="1158" style="backgroundAlpha:0"></canvas></div>
        </div> 
        <div id="PN2" full style="position:absolute; top:0%; left:0%; ">
        <img class="imgrsp" src="img/mask.jpg" style="position:absolute; top:0%; left:0%; " alt="" />
        </div>
        <div id="PN" full style="position:absolute; top:0%; left:0%; ">
        <img id="p1" class="imgrsp" src="img/btn.png" style="position:absolute; top:0%; left:0%; " alt="" />
        <img id="p2" class="imgrsp" src="img/btn.png" style="position:absolute; top:100%; left:0%; " alt="" />
        <img id="p3" class="imgrsp" src="img/btn.png" style="position:absolute; top:200%; left:0%; " alt="" />
        <img id="p4" class="imgrsp" src="img/btn.png" style="position:absolute; top:300%; left:0%; " alt="" />
        <img id="p5" class="imgrsp" src="img/btn.png" style="position:absolute; top:400%; left:0%; " alt="" />
        <img id="p6" class="imgrsp" src="img/btn.png" style="position:absolute; top:500%; left:0%; " alt="" />
        <img id="p7" class="imgrsp" src="img/btn.png" style="position:absolute; top:600%; left:0%; " alt="" />
        <img id="p8" class="imgrsp" src="img/btn.png" style="position:absolute; top:700%; left:0%; " alt="" />
        <img id="p9" class="imgrsp" src="img/btn.png" style="position:absolute; top:800%; left:0%; " alt="" />
		<img id="p10" class="imgrsp" src="img/btn.png" style="position:absolute; top:900%; left:0%; " alt="" />
		<img id="p11" class="imgrsp" src="img/btn.png" style="position:absolute; top:1000%; left:0%; " alt="" />
		<img id="p12" class="imgrsp" src="img/btn.png" style="position:absolute; top:1100%; left:0%; " alt="" />
		<img id="p13" class="imgrsp" src="img/btn.png" style="position:absolute; top:1200%; left:0%; " alt="" />
		<img id="p14" class="imgrsp" src="img/btn.png" style="position:absolute; top:1300%; left:0%; " alt="" />
		<img id="p15" class="imgrsp" src="img/btn.png" style="position:absolute; top:1400%; left:0%; " alt="" />
		<img id="p16" class="imgrsp" src="img/btn.png" style="position:absolute; top:1500%; left:0%; " alt="" />
		<img id="p17" class="imgrsp" src="img/btn.png" style="position:absolute; top:1600%; left:0%; " alt="" />
		<img id="p18" class="imgrsp" src="img/btn.png" style="position:absolute; top:1700%; left:0%; " alt="" />
		<img id="p19" class="imgrsp" src="img/btn.png" style="position:absolute; top:1800%; left:0%; " alt="" />
              
        </div>
        
        <div id="PN3" full style="position:absolute; top:0%; left:0%; display:block; ">
        <img class="imgrsp" src="img/mask.jpg" style="position:absolute; top:0%; left:0%; opacity:0;" alt="" />
        </div>
        
        <!--<img id="p1" class="imgrsp" src="img/beyy.png" style="position:absolute; top:5%; left:60%;width:25%; height:4%; " alt="" />-->
        <div id="bgSound" style="position:absolute;top:1.5%; left:88%;width:6.667%; height:4.145%;display:none;" onClick="bgSoundOpen()">
            <div full id="musicon" style="position:absolute; top:0%; left:0%;width:110%; height:100%;"><img class="imgrsp Rotation" src="img/music.png"/></div>
            <div full id="musicoff" style="position:absolute; top:0%; left:0%; width:110%; height:110%;display:none;"><img  class="imgrsp" src="img/music2.png"/></div>
        </div>
        
</div>
<script type="text/javascript" src="js/jquery-1.7.2.js"></script>
		<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
		<script type="text/javascript" language="javascript">
bgSoundOpen();
function loadPage(){
}
function unloadExit(){
}
//加载微信
var myurl=location.href.split('#')[0];
var mydir=myurl.substring(0,myurl.lastIndexOf("/",myurl.substring(0,myurl.indexOf(".html")).length)+1);
var isgameok=false;
var iskeyok=(mydir.indexOf("vxuebao.com")>=0)?false:true;
function initgamecomplete(){
	if(!isgameok){
		isgameok=true;
		checkgamekeycomplete();
	}
}
function initkeycomplete(){
	if(!iskeyok){
		iskeyok=true;
		checkgamekeycomplete();
	}
}
function checkgamekeycomplete(){
	//alert(isgameok+":::"+iskeyok);
	if(isgameok && iskeyok){
		handleComplete();
	}
}
$.get("/index.php?c=view&a=huawei&url="+encodeURIComponent(myurl), function(ddd){
	loadjsoncomplete(ddd);
});
function loadjsoncomplete(myJsonObject){
	if(myJsonObject && myJsonObject.appId){
		
	}else{
		myJsonObject=escapemystr(myJsonObject);
		myJsonObject=eval('('+myJsonObject+')');
	}
	////////////////////////////////////////
	if(!isWeiXin()){
		initkeycomplete();
	}
	wx.config({
		debug: false,
		appId: myJsonObject.appId,
		timestamp: myJsonObject.timestamp,
		nonceStr: myJsonObject.nonceStr,
		signature: myJsonObject.signature,
		jsApiList: [
			'onMenuShareTimeline',
			'onMenuShareAppMessage',
			'onMenuShareQQ',
			'onMenuShareWeibo',
			'onMenuShareQZone'
		]
	});

	wx.ready(function () {
		var shareData64 = {
			title: '功夫集团年会邀请函',
			desc: '艰苦奋斗，重塑激情',
			link: myJsonObject.url,
			imgUrl:  mydir+'img/wx_pic.jpg'
		};
		wx.onMenuShareAppMessage(shareData64);
		wx.onMenuShareTimeline(shareData64);
		wx.onMenuShareQQ(shareData64);
		wx.onMenuShareWeibo(shareData64);
		wx.onMenuShareQZone(shareData64);
		initkeycomplete();

	});	  
	wx.error(function (res) {
		//alert(res.errMsg);
	});
	///////////////////////////////////////fun
	function escapemystr(estr) {
		//%5C%22
		estr = escape(estr);
		estr = shieldFixStr(estr, "%5C%22", "%22");
		estr = unescape(estr);
		estr = estr.substring(estr.indexOf("{"), estr.lastIndexOf("}")+1);
		return estr;
	}
	function shieldFixStr(contentStr, searchStr, replaceStr) {
		while (contentStr.indexOf(searchStr) != -1) {
			contentStr = shieldStr(contentStr, searchStr, replaceStr);
		}
		return contentStr;
		function shieldStr(contentStr, searchStr, replaceStr) {
			var tmpIdx = contentStr.indexOf(searchStr);
			if (tmpIdx != -1) {
				contentStr = contentStr.substring(0, tmpIdx)+replaceStr+contentStr.substring(tmpIdx+searchStr.length, contentStr.length);
			}
			return contentStr;
		}
	}
	function isWeiXin(){//是否是微信
		var ua = window.navigator.userAgent.toLowerCase();
		if(ua.match(/MicroMessenger/i) == 'micromessenger'){
			return true;
		}else{
			return false;
		}
	}
	///////////////////////////////////////funend
}


////////////////////////////加载微信 end
		</script>
</body>
</html>
