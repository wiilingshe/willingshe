!function(e,t,o){"use strict";t.module("ui.sortable",[]).value("uiSortableConfig",{}).directive("uiSortable",["uiSortableConfig","$timeout","$log",function(e,i,n){return{require:"?ngModel",link:function(l,r,a,s){function u(e,t){return t&&"function"==typeof t?function(o,i){e(o,i),t(o,i)}:e}function d(e,t){var o=e.sortable("option","helper");return"clone"===o||"function"==typeof o&&t.item.sortable.isCustomHelperUsed()}function c(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}function m(e,t){t.item.sortable._destroy()}var f,b={},p={"ui-floating":o},v={receive:null,remove:null,start:null,stop:null,update:null},g={helper:null};return t.extend(b,p,e,l.$eval(a.uiSortable)),t.element.fn&&t.element.fn.jquery?(s?(l.$watch(a.ngModel+".length",function(){i(function(){r.data("ui-sortable")&&r.sortable("refresh")})}),v.start=function(e,i){if("auto"===b["ui-floating"]){var n=i.item.siblings();t.element(e.target).data("ui-sortable").floating=c(n)}i.item.sortable={model:s.$modelValue[i.item.index()],index:i.item.index(),source:i.item.parent(),sourceModel:s.$modelValue,cancel:function(){i.item.sortable._isCanceled=!0},isCanceled:function(){return i.item.sortable._isCanceled},isCustomHelperUsed:function(){return!!i.item.sortable._isCustomHelperUsed},_isCanceled:!1,_isCustomHelperUsed:i.item.sortable._isCustomHelperUsed,_destroy:function(){t.forEach(i.item.sortable,function(e,t){i.item.sortable[t]=o})}}},v.activate=function(){f=r.contents();var e=r.sortable("option","placeholder");if(e&&e.element&&"function"==typeof e.element){var o=e.element();o=t.element(o);var i=r.find('[class="'+o.attr("class")+'"]');f=f.not(i)}},v.update=function(e,t){if(!t.item.sortable.received){t.item.sortable.dropindex=t.item.index();var o=t.item.parent();t.item.sortable.droptarget=o,t.item.sortable.droptargetModel=o.scope().$eval(o.attr("ng-model")),r.sortable("cancel")}d(r,t)&&!t.item.sortable.received&&"parent"===r.sortable("option","appendTo")&&(f=f.not(f.last())),f.appendTo(r),t.item.sortable.received&&(f=null),t.item.sortable.received&&!t.item.sortable.isCanceled()&&l.$apply(function(){s.$modelValue.splice(t.item.sortable.dropindex,0,t.item.sortable.moved)})},v.stop=function(e,t){!t.item.sortable.received&&"dropindex"in t.item.sortable&&!t.item.sortable.isCanceled()?l.$apply(function(){s.$modelValue.splice(t.item.sortable.dropindex,0,s.$modelValue.splice(t.item.sortable.index,1)[0])}):"dropindex"in t.item.sortable&&!t.item.sortable.isCanceled()||d(r,t)||f.appendTo(r),f=null},v.receive=function(e,t){t.item.sortable.received=!0},v.remove=function(e,t){"dropindex"in t.item.sortable||(r.sortable("cancel"),t.item.sortable.cancel()),t.item.sortable.isCanceled()||l.$apply(function(){t.item.sortable.moved=s.$modelValue.splice(t.item.sortable.index,1)[0]})},g.helper=function(e){return e&&"function"==typeof e?function(t,o){var i=e(t,o);return o.sortable._isCustomHelperUsed=o!==i,i}:e},l.$watch(a.uiSortable,function(e){r.data("ui-sortable")&&t.forEach(e,function(e,t){return t in p?("ui-floating"!==t||e!==!1&&e!==!0||(r.data("ui-sortable").floating=e),void(b[t]=e)):(v[t]?("stop"===t&&(e=u(e,function(){l.$apply()}),e=u(e,m)),e=u(v[t],e)):g[t]&&(e=g[t](e)),b[t]=e,void r.sortable("option",t,e))})},!0),t.forEach(v,function(e,t){b[t]=u(e,b[t]),"stop"===t&&(b[t]=u(b[t],m))})):n.info("ui.sortable: ngModel not provided!",r),void r.sortable(b)):void n.error("ui.sortable: jQuery should be included before AngularJS!")}}}])}(window,window.angular);