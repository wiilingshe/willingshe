angular.module("services.history",[]).factory("historyService",["$rootScope",function(r){var t={},o={},e={};return t.addPage=function(e,n){return o[e]||(o[e]={currentPos:0,inHistory:!1,pageHistory:[]},t.addPageHistory(e,n)),r.$broadcast("history.changed"),JSON.parse(o[e].pageHistory[o[e].currentPos])},t.addPageHistory=function(t,n){e=o[t],e.inHistory&&(e.inHistory=!1,e.pageHistory.length=e.currentPos+1);var s=JSON.stringify(n);s!=e.pageHistory[e.pageHistory.length-1]&&e.pageHistory.push(s),e.currentPos=e.pageHistory.length-1,r.$broadcast("history.changed")},t.clearHistory=function(){o={}},t.canBack=function(r){return e=o[r],e.currentPos>0},t.canForward=function(r){return e=o[r],e.currentPos<e.pageHistory.length-1},t.back=function(t){if(e=o[t],e.pageHistory.length){e.inHistory=!0;var n=0===e.currentPos?e.pageHistory[0]:e.pageHistory[--e.currentPos];return r.$broadcast("history.changed"),JSON.parse(n)}},t.forward=function(t){if(e=o[t],e.pageHistory.length){e.inHistory=!0;var n=e.currentPos==e.pageHistory.length-1?e.pageHistory[e.currentPos]:e.pageHistory[++e.currentPos];return r.$broadcast("history.changed"),JSON.parse(n)}},t}]);