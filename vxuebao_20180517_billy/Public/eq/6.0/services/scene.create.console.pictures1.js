angular.module("scene.create.console.pictures1",["services.file"]).factory("picturesCropService",["$rootScope","fileService",function(e,r){var t,o={},n=[],c=!1,i=0,a=0;return o.getCoordinateObj=function(){return t},o.initCoordinateObj=function(){t={ratio:null,items:[]};for(var e=0;6>e;e++)t.items.push({})},o.setCropCount=function(e){e?i=e:i++},o.getCropCount=function(){return i},o.setCropping=function(e){c=e},o.getCropping=function(){return c},o.cropImage=function(t){r.cropImage(t).success(function(r){if(r.success){var o={width:t.w,height:t.h,src:r.map.path,desc:"",index:r.map.index};n.push(o),a++,i===a&&(i=a=0,e.$broadcast("crop.complete.all",angular.copy(n)),n.length=0)}else alert(r.msg),e.$broadcast("crop.fail")}).error(function(){alert("网络连接超时，请稍后重试"),e.$broadcast("crop.fail")})},o.initCoordinateObj(),o}]);