function fallingObject(e,t){function a(e){e.clearRect(0,0,s,g);for(var t=0;t<d.length;t++)e.save(),e.translate(d[t].x,d[t].y),e.scale(d[t].scale,d[t].scale),e.rotate(d[t].rotate),e.fillRect(0,0,f,f),e.restore()}function r(){Math.random()<.02*c.density&&o(),n()}function n(){for(var e=0;e<d.length;e++)d[e].x+=d[e].vx,d[e].y+=d[e].vy,d[e].vy+=d[e].g;for(var t=0,e=0;e<d.length;e++)d[e].y<g-f&&d[e].x>-f&&d[e].x<s&&(d[t++]=d[e]);for(;d.length>t;)d.pop();d.length>m&&(d.length=m)}function o(){var e=.5*Math.random()+.3,t={x:Math.ceil(Math.random()*s),y:-f,g:.02*e*c.src.vy,vx:.05*Math.pow(-1,Math.ceil(1e3*Math.random())),vy:.01*e*c.src.vy,color:"yellow",scale:e,rotate:Math.pow(-1,Math.ceil(1e3*Math.random()))*Math.random()*(c.src.rotate||0)*Math.PI/180};d.push(t)}var l=e[t-1];if(l.properties){var c=l.properties.fallingObject||{};renderPage(eqShow,t,e);for(var h=0;h<e[t-1].elements.length;h++){var i=eqShow.selectElement(e[t-1].elements[h].id);eqxCommon.bindTrigger(i,e[t-1].elements[h])}var s=$(".m-img").width(),g=$(".m-img").height(),p=document.createElement("canvas");p.width=s,p.height=g,$(p).prependTo("#page"+t+" .edit_wrapper").attr("class","cas page_effect").attr("id","can"+t).attr("style","z-index: 0");var v=p.getContext("2d"),d=[],f=60,m=20,y=new Image;y.src=c.src.path,y.onload=function(){v.beginPath(),pattern=v.createPattern(y,"repeat"),v.fillStyle=pattern,v.closePath(),eqShow.stopFallingObject=setInterval(function(){a(v),r()},20)}}}