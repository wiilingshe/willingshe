!function(){function e(e,n,r,i,p){function s(){timeout=setTimeout(function(){nums>=300*r&&(console.log(r),$(n).fadeOut(500,function(){setTimeout(function(){$(n).removeClass("lock").addClass("unlock")},500),$("#audio_btn").css("opacity",1),1==i&&playVideo(t)}),nums=0)},o)}var c="ontouchstart"in window,u=c?"touchstart":"mousedown",g=c?"touchmove":"mousemove",l=c?"touchend":"mouseup";e.lineCap="round",e.lineJoin="round",e.lineWidth=2*a,e.globalCompositeOperation="destination-out",new RegExp("assets"),n.addEventListener(u,function(t){function a(t){s(),nums++,t.preventDefault(),x2=c?t.targetTouches[0].pageX:t.pageX-$("#can"+i).offset().left,y2=c?t.targetTouches[0].pageY:t.pageY-$("#can"+i).offset().top,e.moveTo(x1,y1),e.lineTo(x2,y2),e.stroke(),x1=x2,y1=y2}$("#tip"+i).remove(),t.preventDefault(),x1=c?t.targetTouches[0].pageX:t.pageX-$("#can"+i).offset().left,y1=c?t.targetTouches[0].pageY:t.pageY-$("#can"+i).offset().top,startX=x1,startY=y1,n.addEventListener(g,a),n.addEventListener(l,function(){n.removeEventListener(g,a)})})}var t,o=200;window.addScratchEffect=function(o,n,r){pageInfo=n,t=o,a=20,nums=0;var i,p=$(".m-img").width(),s=$(".m-img").height(),c=document.createElement("canvas");$(c).prependTo("#page"+r).attr("class","cas scratch-cas page_effect lock").attr("id","can"+r).attr("style","z-index: 1000");var u=c.getContext("2d");c.width=p,c.height=s;var g=new Image;if(n[r-1].properties.image){if(num=r,n[r-1].properties.tip){var l=document.createElement("div");$(l).attr("id","tip"+r).attr("class","tip").prependTo("#page"+r),$(l).html(n[r-1].properties.tip)}g.src=n[r-1].properties.image.path,i=n[r-1].properties.percentage.value}else if(n[r-1].properties.scratch){if(num=r,n[r-1].properties.scratch.tip){var l=document.createElement("div");$(l).attr("id","tip"+r).attr("class","tip").prependTo("#page"+r),$(l).html(n[r-1].properties.scratch.tip)}g.src=n[r-1].properties.scratch.image.path,i=n[r-1].properties.scratch.percentage.value||n[r-1].properties.scratch.percentage}!function(t,a,o,r,i){t.onload=function(){n[r-1].properties.image||!n[r-1].properties.scratch.hasOwnProperty("opacity")?a.globalAlpha=.8:a.globalAlpha=1-parseFloat(n[r-1].properties.scratch.opacity).toFixed(2),a.drawImage(this,0,0,o.width,o.height),renderPage(eqShow,r,pageInfo);for(var p=0;p<pageInfo[r-1].elements.length;p++){var s=eqShow.selectElement(pageInfo[r-1].elements[p].id);eqxCommon.bindTrigger(s,pageInfo[r-1].elements[p])}e(a,o,i,r,t)}}(g,u,c,r,i)}}();