angular.module("security.login.reset",["services.localizedMessages"]).controller("ResetFormController",["$scope","security","localizedMessages","$location","resetKey",function(s,r,e,o,a){s.password={},s.checkPassword=function(){if(s.password.newPw){if(/^[a-zA-Z0-9]{6,16}$/g.test(s.password.newPw))return s.passError=null,!0;s.passError="密码为6~16个字符(英文字母或数字，区分大小写)"}else s.passError="新密码不能为空";return!1},s.checkRepeatPassword=function(){if(s.password.confirm){if(s.password.confirm==s.password.newPw)return s.rPassError="",!0;s.rPassError="两次密码输入不一致，请重新输入"}else s.rPassError="确认密码不能为空";return!1},s.reset=function(){s.checkPassword()&&s.checkRepeatPassword()&&r.resetPassByKey(s.password.newPw,a).then(function(r){200==r.data.code?(alert("修改成功"),s.$close(),o.path("/main").search({})):1011==r.data.code&&(s.authError=r.data.msg)})},s.cancel=function(){s.$dismiss()}}]);