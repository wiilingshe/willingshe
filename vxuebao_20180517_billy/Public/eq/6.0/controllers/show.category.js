angular.module("category",["services.show","services.activity","app.directives.addBanner"]),angular.module("category").controller("CategoryCtrl",["$rootScope","$http","$scope","$translate","showService","activityService","$location","$stateParams","security",function(t,e,a,i,g,o,l,r,s){a.recommend=1,a.pageSize=16,o.getActiveList(null,a.recommend,a.pageNo,3),a.$on("activeList",function(t,e){a.activeList=e.data.list}),a.join=function(t){l.path("/show/active/"+t)};var n=r.id;a.bizType=n;var p={};a.getCategoryTpl=function(t){a.childCat=t,p[t]?(a.childCatrgoryList=p[t],a.childCatrgoryList.length&&(c.tagId=a.categoryId=a.childCatrgoryList[0].id,a.getPageTpls(null,a.childCatrgoryList[0].id))):g.getPageTagLabel(t).then(function(e){a.childCatrgoryList=p[t]=e.data.list,a.childCatrgoryList.length&&(c.tagId=a.categoryId=a.childCatrgoryList[0].id,a.getPageTpls(null,a.childCatrgoryList[0].id))})},a.getCategoryTpl(n);var c={sceneType:"",tagId:"",orderBy:null,bizType:"",template:"",pageNo:"1",targetPage:""};a.tplNew=function(t){a.order=t,c.orderBy=t,a.getPageTpls(t,null,c.tagId,c.pageNo,a.pageSize)},a.getPageTpls=function(t,e){e&&(c.tagId=e),a.categoryId=c.tagId,g.getSceneList(c.orderBy,null,c.tagId,c.pageNo,a.pageSize),a.$on("sceneList",function(t,e){a.tpls=e.list,a.totalItems=e.map.total,a.currentPage=e.map.pageNo,a.allPageCount=e.map.count,a.toPage=e.map.pageNo;for(var i=0;i<a.tpls.length;i++)2==a.tpls[i].isTemplate&&(a.tpls[i].isTemplate=!0),a.tpls[i].headImg&&0===a.tpls[i].headImg.indexOf("http://")?a.tpls[i].headImg=CLIENT_CDN+"assets/images/xiaotouxiang.png":a.tpls[i].headImg=CLIENT_CDN+"assets/images/xiaotouxiang.png"})},a.userTpl=function(e){s.closeLoginDialog(),l.path("/scene"),t.tplId=e},a.pageChanged=function(t){return 1>t||t>a.totalItems/16+1?void alert(i.instant("show.OVER_PAGE_NUMBER")):(c.pageNo=t,void a.getPageTpls(c.orderBy,null,c.tagId,t,a.pageSize))}}]);