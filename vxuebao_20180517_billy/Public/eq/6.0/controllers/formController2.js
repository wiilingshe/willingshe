angular.module("cancelWarm",[]).controller("cancelWarmCtrl",["$scope","$location",function(t,e){t.commit=function(){e.path("/form")},t.cancel=function(){t.$dismiss()}}]),angular.module("viewForm",[]).controller("viewForm",["$scope","$location","$compile","$modal",function($scope,$location,$compile,$modal){$scope.host=$location.url(),$scope.fid=$scope.host.substr(15);var a=$(".marking_title_top");$scope.createForm=function(){$location.path("/form")},$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=preview&fid="+$scope.fid,success:function(data){var data=eval("("+data+")");for(""==data.bg_photo?$(".previewPic").eq(0).attr("src","/view/images/preview.png"):$(".previewPic").eq(0).attr("src",data.bg_photo),$scope.len=data.list.length,i=0;i<$scope.len;i++)if(1==data.list[i].type)$(".marking_title_top").eq(0).text(data.list[i].ipttitle);else if(2==data.list[i].type)$(".marking_inform_desc").eq(0).text(data.list[i].ipttitle);else if(3==data.list[i].type||4==data.list[i].type||6==data.list[i].type||9==data.list[i].type||17==data.list[i].type){var radioHtml="";for(x=0;x<data.list[i].info.length;x++)var a='<div class="form_odd_select" style="background-color: rgb(255, 255, 255); cursor: pointer;"><div class="form_radio_bg" style="margin-top:-2px"><div class="form_redio_mid"></div></div><input style="display:none" type="radio" value="A"><p class="preview_left">'+data.list[i].info[x]+"</p></div>",radioHtml=radioHtml+a;if(9==data.list[i].type)var radioHtml='<div class="form_odd_select" style="background-color: rgb(255, 255, 255); cursor: pointer;"><div class="form_radio_bg" form_radio_bg><div class="form_redio_mid"></div></div><input style="display:none" type="radio" value="A" name="question[3509][]"><p class="preview_left">A.对</p></div><div class="form_odd_select" style="background-color: rgb(255, 255, 255); cursor: pointer;"><div class="form_radio_bg" form_radio_bg><div class="form_redio_mid"></div></div><input style="display:none" type="radio" value="B" name="question[3509][]"><p class="preview_left">B.错</p></div>';var html='<div class="div_question" style="border:2px solid #fff"><div class="div_title_question_all"><div class="div_topic_question">'+data.list[i].sort+'.</div><div class="duo" style="color: #ff766c;display:none;font-size:16px">【多选题】</div><div class="form_type">3</div><div class="form_id">3504</div><div class="div_title_question preview_left">'+data.list[i].ipttitle+'</div><div class="preview_score">（分值：'+data.list[i].score+'分）</div></div><div class="div_table_radio_question"><div class="opt_all" style="margin-top:15px">'+radioHtml+'</div></div><hr style="height:1px;border:none;border-top:1px solid #ddd;margin-bottom:0px"></div>';$(".div_question:last").after($compile(html)($scope)),4==data.list[i].type&&$(".div_question:last").find(".duo").eq(0).css("display","inline-block"),0==data.list[i].score&&$(".div_question:last").find(".preview_score").eq(0).css("display","none")}else if(7==data.list[i].type){var leftData=data.list[i].info.left,rightData=data.list[i].info.right;leftData=leftData.replace(/&quot;/g,'"'),rightData=rightData.replace(/&quot;/g,'"'),leftData=eval("("+leftData+")"),rightData=eval("("+rightData+")");var leftHtmls="",rightHtmls="";for(var key in leftData){var two="L"+key,leftHtml='<input class="left" value="'+leftData[key][two]+'" disabled="disabled">';leftHtmls+=leftHtml}for(var key2 in rightData){var two2="R"+key2,rightHtml='<input class="right" value="'+rightData[key2][two2]+'" disabled="disabled">';rightHtmls+=rightHtml}var html='<div class="div_question" style="border:2px solid #fff"><div class="div_title_question_all"><div class="div_topic_question">'+data.list[i].sort+'.</div><div class="form_type">'+data.list[i].type+'</div><div class="form_id">'+data.list[i].id+'</div><div class="div_title_question preview_left">'+data.list[i].ipttitle+'</div><div class="preview_score">（分值：'+data.list[i].score+'分）</div></div><div class="opt_all" style="margin-top:15px;"><div style="width:25%;display:inline-block">'+leftHtmls+'</div><div style="width:25%;display:inline-block">'+rightHtmls+'</div></div><hr style="height:1px;border:none;border-top:1px solid #ddd;margin-bottom:0px"></div>';$(".div_question:last").after(html),0==data.list[i].score&&$(".div_question:last").find(".preview_score").eq(0).css("display","none")}else if(5==data.list[i].type||8==data.list[i].type){var html='<div class="div_question" style="border:2px solid #fff"><div class="div_title_question_all"><div class="div_topic_question">'+data.list[i].sort+'.</div><div class="div_title_question preview_left">'+data.list[i].ipttitle+'</div><div class="preview_score">（分值：'+data.list[i].score+'分）</div></div><div class="div_table_clear_top"></div><textarea disabled="disabled" class="write_area" placeholder="作答区..." type="text" name="question[3506][]"></textarea><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #ddd;margin-bottom:0px"></div>';$(".div_question:last").after(html),0==data.list[i].score&&$(".div_question:last").find(".preview_score").eq(0).css("display","none")}else if(11==data.list[i].type||12==data.list[i].type||13==data.list[i].type||14==data.list[i].type||15==data.list[i].type||16==data.list[i].type){var html='<div class="div_question" style="border:2px solid #fff"><div class="div_title_question_all"><div class="div_topic_question">'+data.list[i].sort+'.</div><div class="div_title_question">'+data.list[i].ipttitle+'</div></div><div class="div_table_clear_top"></div><input disabled="disabled" type="text" class="form_name" name="question[3511][]" style="margin-top:5px"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #ddd;margin-bottom:0px"></div>';$(".div_question:last").after(html),0==data.list[i].score&&$(".div_question:last").find(".preview_score").eq(0).css("display","none")}}}),$scope.savePic=function(){$scope.urlTpl=$(".previewPic").eq(0).attr("src"),$scope.pathname=window.location.hash,$scope.pathname=$scope.pathname.slice(16),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=bgphoto",data:{fid:$scope.pathname,tpl:$scope.urlTpl},success:function(data){var data=eval("("+data+")");$(".tishi").eq(0).css("display","none"),alert("成功修改背景图！")}})},$scope.fileNameChanged=function(t){if(t.files.length>0&&$(".tishi").eq(0).css("display","block"),t.files.length>0){var e=new FormData($("#viewPicUpload")[0]);e.append("bgphone","true"),$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=upload_photo",data:e,async:!1,cache:!1,contentType:!1,processData:!1,success:function(t){$(".previewPic").eq(0).attr("src","Uploads/"+t.src),$scope.savePic()}})}}}]),angular.module("tpl",["toBottom"]).controller("formTpl",["$scope","$location","formService",function($scope,$location,formService){function getData(t){for($scope.lists=t.list,$scope.length=t.list.length,$scope.number=Math.ceil(t.count/t.pageSize),$scope.pages=[],i=0;i<$scope.number;i++)x=i+1,$scope.pages.push(x);$scope.$apply()}$scope.formType=1,$scope.createForm=function(){$location.path("/form")},$scope.myForm=function(){return formService.myForm()},$scope.myTest=function(){return formService.myTest()},$scope.tplSearch=function(){var text=$("#tpl_search").val();$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=template",data:{search:text},success:function(data){var data=eval("("+data+")");getData(data)}})},$scope.nextPage=function($event){var nub=parseInt($($event.target).parent().find(".pageNo").text())+parseInt("1");nub>$scope.pageNub?alert("已是最后一页"):($($event.target).parent().find(".pageNo").html(nub),$($event.target).parent().find("input").val(nub),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=template&pageNo="+nub,success:function(data){var data=eval("("+data+")");getData(data)}}))},$scope.prePage=function($event){if(1==$($event.target).parent().find(".pageNo").text())alert("当前页为首页");else{var nub=$($event.target).parent().find(".pageNo").text()-1;$($event.target).parent().find(".pageNo").html(nub),$($event.target).parent().find("input").val(nub),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=template&pageNo="+nub,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})}},$scope.dingPage=function($event){var nub=$($event.target).parent().find("input").val();nub>$scope.number?alert("最大页码为"+$scope.number):$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=template&pageNo="+nub,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})},$scope.toPage=function($event){var text=$($event.target).text();$($event.target).parent().find(".pageNo").html(text),$($event.target).parent().find("input").val(text),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=template&pageNo="+text,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})},$scope.weiPage=function($event){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=template&pageNo="+$scope.number,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})},$scope.firstPage=function($event){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=template&pageNo=1",success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})},$("body").on("mouseover",".tpl_list_demo",function(){$(this).css("cursor","pointer")}),$("body").on("mouseout",".tpl_list_demo",function(){$(this).css("cursor","")}),$("body").on("mouseover",".translucent_form",function(){$(this).css("background-color","rgba(0, 0, 0, 0.8)"),$(this).find(".translucent_mid span").css("display","block"),$(this).find(".translucent_mid").css("background","url(view/images/form_view_see.png)"),$(this).find(".translucent_mid").css("background-position-x","10px"),$(this).find(".translucent_mid").css("background-position-y","15px"),$(this).find(".translucent_mid").css("background-repeat","no-repeat"),$(this).find(".translucent_mid").css("background-color","rgba(255, 255, 255, 0.2)"),$(this).find(".translucent_see span").css("display","block"),$(this).find(".translucent_see").css("background","url(view/images/form_view_edit.png)"),$(this).find(".translucent_see").css("background-size","45%"),$(this).find(".translucent_see").css("background-position-x","14px"),$(this).find(".translucent_see").css("background-position-y","13px"),$(this).find(".translucent_see").css("background-repeat","no-repeat"),$(this).find(".translucent_see").css("background-color","rgba(255, 255, 255, 0.2)")}),$("body").on("mouseout",".translucent_form",function(){$(this).css("background-color","rgba(0, 0, 0,0)"),$(this).find(".translucent_mid").css("background-color","rgba(255, 255, 255, 0)"),$(this).find(".translucent_mid").css("background",""),$(this).find(".translucent_mid span").css("display","none"),$(this).find(".translucent_see").css("background-color","rgba(255, 255, 255, 0)"),$(this).find(".translucent_see").css("background",""),$(this).find(".translucent_see span").css("display","none")}),$scope.useTpl=function($event){var id=$($event.target).parent().parent().find(".tpl_id").text(),type=$($event.target).parent().parent().find(".tpl_type").text();$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=paraphrase&fid="+id,success:function(data){var data=eval("("+data+")");1==type?($location.path("/form/blank/"+data.obj),$scope.$apply()):2==type&&($location.path("/form/tests/"+data.obj),$scope.$apply())}})},$scope.preview=function(t){var e=$(t.target).parent().parent().find(".tpl_id").text();window.open("#/form/viewForm/"+e)},$.ajax({type:"GET",async:!1,url:PREFIX_HOST+"/index.php?c=form&a=template",success:function(data){var data=eval("("+data+")");getData(data)}}),$scope.change=function(sort){0==sort?$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=template",success:function(data){var data=eval("("+data+")");getData(data)}}):$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=template&form_type="+sort,success:function(data){var data=eval("("+data+")");getData(data)}})},$scope.tplNew=function(){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=template&new_form=1",success:function(data){var data=eval("("+data+")");getData(data)}})},$scope.tplHot=function(){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=template&hot_form=1",success:function(data){var data=eval("("+data+")");getData(data)}})}}]),angular.module("view",["toBottom"]).controller("studentView",["$scope","$modal","$location","formService","usercenterService",function($scope,$modal,$location,formService,usercenterService){function showCoords(t){$("#x1").val(t.x),$("#y1").val(t.y),$("#x2").val(t.x2),$("#y2").val(t.y2),$("#w").val(t.w),$("#h").val(t.h)}$scope.formType=1,$("body").on("mouseover",".view_edit",function(){$(this).children("a").eq(0).css("color","#6c0")}),$("body").on("mouseout",".view_edit",function(){$(this).children("a").eq(0).css("color","#76838f"),$(this).css("color","#6c0")}),$scope.createForm=function(){$location.path("/form")},$("body").on("mouseover",".view_see",function(){$(this).find(".view_see_top").eq(0).css("background-color","#6c0"),$(this).css("color","#6c0"),$(this).find("img").attr("src","../view/images/form_view_see.png")}),$("body").on("mouseout",".view_see",function(){$(this).find(".view_see_top").eq(0).css("background-color","#fff"),$(this).css("color","#76838f"),$(this).find("img").attr("src","../view/images/form_view_see2.png")}),$("body").on("mouseover",".view_edit",function(){$(this).find(".view_edit_top").eq(0).css("background-color","#6c0"),$(this).find("img").attr("src","../view/images/form_view_edit.png")}),$("body").on("mouseout",".view_edit",function(){$(this).find(".view_edit_top").eq(0).css("background-color","#fff"),$(this).find("img").attr("src","../view/images/form_view_edit2.png")});var jcropApi,url=$location.url(),fid=url.substr(11),getData=function(t){$scope.ifFormType=t.list.type};$scope.viewForm=function(){$scope.eid=fid,window.open("#/form/viewForm/"+$scope.eid)},$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=view&id="+fid,async:!1,success:function(data){var data=eval("("+data+")");getData(data);var a=$(".form_title").eq(0);$(".form_pic").eq(0).attr("src",data.list.photo);var b=$(".form_title").eq(0).text();"null"!=b?$(".form_title").eq(0).text(data.list.title):$(".form_title").eq(0).text("未设置标题"),$(".create_time").eq(0).text(data.list.create_time),"1"==data.list.publishint?$(".form_status").eq(0).text("已发布"):$(".form_status").eq(0).text("未发布")}}),$("body").on("click",".pic_upload_k",function(){$(".pic_upload").eq(0).animate({opacity:"1"}),$(".pic_upload").eq(0).css("height","inherit"),$(".view_box").eq(0).css("height","inherit"),$(".pic_upload").eq(0).css("display","block")}),$scope.doUpload=function(){var t=new FormData($("#uploadForm")[0]);$.ajax({url:PREFIX_HOST+"/index.php?c=form&a=upload_photo",type:"POST",data:t,async:!1,cache:!1,contentType:!1,processData:!1,success:function(t){$(".pic_path").eq(0).text(t.src),jcropApi.setImage("Uploads/"+t.src),$("#xuwanting").Jcrop({onChange:showCoords,onSelect:showCoords,boxWidth:300,boxHeight:300,aspectRatio:1,bgOpacity:.6,setSelect:[0,0,300,300]},function(){jcropApi=this}),$(".pic_hint").eq(0).css("display","none")},error:function(t){alert(t)}})},$("#xuwanting").Jcrop({onChange:showCoords,onSelect:showCoords,boxWidth:300,boxHeight:300,aspectRatio:1,bgOpacity:.6,setSelect:[0,0,300,300]},function(){jcropApi=this}),$scope.myForm=function(){return formService.myForm()},$scope.myTest=function(){return formService.myTest()},$scope.fileChanged=function(t){$(".pic_hint").eq(0).css("display","inline-block"),$scope.files=t.files,$scope.$apply(),$scope.doUpload()},$scope.confirm=function(){$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=page&a=crop",data:{x:$("#x1").val(),y:$("#y1").val(),w:$("#w").val(),h:$("#h").val(),src:$(".pic_path").eq(0).text(),fileType:"1"},success:function(t){var e=t.obj;$(".form_pic").eq(0).attr("src",PREFIX_HOST+"/Uploads/"+e);var i="/Uploads/"+e;$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=view&id="+fid,data:{photo:i},success:function(t){$("#picCut").css({display:"block",opacity:"1"}),$("#picCut").attr("class","saveSuccesss"),setTimeout(function(){$("#picCut").css({display:"none",opacity:"0"}),$("#picCut").removeClass("saveSuccesss")},1e3),$(".pic_upload").eq(0).css({overflow:"hidden"}),$(".pic_upload").eq(0).animate({height:"0",opacity:"0"})}})}})};var href=PREFIX_HOST+"/form/ipt/fid/"+fid;$("#student_pre").attr("href",href),$("#student_pre").attr("target","_blank"),$("#form_url").html(href),$("#form_code").qrcode({width:150,height:150,text:href}),$scope.copyUrl=function(){var t=document.getElementById("form_url");t.select(),document.execCommand("Copy"),alert("已复制好，可贴粘。")},$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=outscore&efid="+fid,success:function(data){var data=eval("("+data+")"),url=PREFIX_HOST+"/"+data.forwardUrl;$("#form_export").attr("href",url)}}),$scope.editForm=function(){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=view&id="+fid,success:function(data){var data=eval("("+data+")"),type=data.list.type;1==type?($location.path("/form/blank/"+fid),$scope.$apply()):2==type&&($location.path("/form/tests/"+fid),$scope.$apply())}})},$("#student_pre").click(function(){window.open(href)}),$("#data").click(function(){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,success:function(data){var data=eval("("+data+")")}})})}]),angular.module("ggg",["toBottom"]).controller("marking",["$scope","$location","formService",function($scope,$location,formService){function getData(t){$scope.lists=t.list,$scope.length=t.list.length,$scope.data=t,$("#marking_inform").find(".marking_inform_time").eq(0).html($scope.data.time)}$scope.formType=1,$scope.createForm=function(){$location.path("/form")},$scope.myForm=function(){return formService.myForm()},$scope.myTest=function(){return formService.myTest()};var href=$location.url(),eid=href.substr(14,href.length);for($.ajax({type:"GET",async:!1,url:PREFIX_HOST+"/index.php?c=form&a=readpaper&eid="+eid,success:function(data){var data=eval("("+data+")");$("#form_test_time").html(data.time),$("#form_marking").find(".marking_title_top").html(data.title),$("#mark_sore").html(data.score+"分"),getData(data)}}),i=0;i<$scope.length;i++){var a=$scope.lists[i].question,htmls="",sort=i+1;if(0==i)if(null!=a){for(x=0;x<a.length;x++)var html='<div class="preview_left">'+a[x]+"</div>",htmls=htmls+html;if(9==$scope.lists[i].type&&(htmls='<div class="preview_left">A.对</div><div class="preview_left">B.错</div>'),7==$scope.lists[i].type){var leftData=$scope.lists[i].question.left,rightData=$scope.lists[i].question.right;leftData=leftData.replace(/&quot;/g,'"'),rightData=rightData.replace(/&quot;/g,'"'),leftData=eval("("+leftData+")"),rightData=eval("("+rightData+")");var leftHtmls="",rightHtmls="";for(var key in leftData){var l="L"+key,r="R"+key,leftHtml='<input disabled="disabled" class="'+l+'" value="'+leftData[key][l]+'" style="margin-bottom:15px;">';leftHtmls+=leftHtml;var rightHtml='<input disabled="disabled" class="'+r+'" value="'+rightData[key][r]+'" style="margin-bottom:15px;">';rightHtmls+=rightHtml}var html='<div class="div_question"><div class="marking_opt"><span class="div_topic_question">'+sort+'</span><div class="marking_title div_title_question preview_left" style="display:inline-block">'+$scope.lists[i].ipttitle+'</div><div class="preview_score">（分值：'+$scope.lists[i].e_score+'）</div><div class="form_opt opt_all">'+htmls+'</div><hr style="height:1px;border:none;border-top:1px dashed #d4d4d4;" /><div style="color:#f3695f;margin-bottom:20px">正确答案：</div><canvas id="canvas'+$scope.lists[i].id+'" width="400" height="300" style="position:absolute"></canvas><div class="left" style="display:inline-block;width:156px">'+leftHtmls+'</div><div class="right" style="display:inline-block;width:156px;margin-left:100px">'+rightHtmls+'</div><div style="color:#6c0;margin-bottom:20px">学生答案：</div><canvas id="myCanvas'+$scope.lists[i].id+'" width="400" height="300" style="position:absolute"></canvas><div class="sleft" style="display:inline-block;width:156px">'+leftHtmls+'</div><div class="sright" style="display:inline-block;width:156px;margin-left:100px">'+rightHtmls+"</div></div></div>";$("#form_marking").after(html);var canvasId=$(".marking_opt:last").find("canvas").eq(0).attr("id"),canvasLeft=$(".marking_opt:last").find("#"+canvasId).offset().left,canvasTop=$(".marking_opt:last").find("#"+canvasId).offset().top,inputWidth=$(".marking_opt:last").find("input").eq(0).css("width");inputWidth=parseInt(inputWidth);var c=document.getElementById(canvasId),cxt=c.getContext("2d"),tanswer=$scope.lists[i].tanswer;for(var key in tanswer){var leftClass=tanswer[key].substring(0,2),rightClass=tanswer[key].substr(2),leftTop=$(".marking_opt:last").find("."+leftClass).eq(0).offset().top,leftLeft=$(".marking_opt:last").find("."+leftClass).eq(0).offset().left,rightTop=$(".marking_opt:last").find("."+rightClass).eq(0).offset().top,rightLeft=$(".marking_opt:last").find("."+rightClass).eq(0).offset().left;cxt.moveTo(inputWidth,parseInt(leftTop-canvasTop+8)),cxt.lineTo(parseInt(rightLeft-canvasLeft),parseInt(rightTop-canvasTop+8)),cxt.stroke()}var scanvasId=$(".marking_opt:last").find("canvas").eq(1).attr("id"),scanvasLeft=$(".marking_opt:last").find("#"+scanvasId).offset().left,scanvasTop=$(".marking_opt:last").find("#"+scanvasId).offset().top,sc=document.getElementById(scanvasId),scxt=sc.getContext("2d"),answer=$scope.lists[i].answer;for(var key in answer){var leftClass=answer[key].substring(0,2),rightClass=answer[key].substr(2),leftTop=$(".marking_opt:last").find("."+leftClass).eq(1).offset().top,leftLeft=$(".marking_opt:last").find("."+leftClass).eq(1).offset().left,rightTop=$(".marking_opt:last").find("."+rightClass).eq(1).offset().top,rightLeft=$(".marking_opt:last").find("."+rightClass).eq(1).offset().left;scxt.moveTo(inputWidth+1,parseInt(leftTop-scanvasTop+8)),scxt.lineTo(parseInt(rightLeft-scanvasLeft+1),parseInt(rightTop-scanvasTop+8)),scxt.stroke()}}else $("#form_marking").after('<div class="div_question"><div class="marking_opt"><span class="div_topic_question">'+sort+'.</span><div class="marking_title div_title_question preview_left" style="display:inline-block">'+$scope.lists[i].ipttitle+'</div><div class="preview_score">（分值：'+$scope.lists[i].e_score+'）</div><div class="form_opt opt_all">'+htmls+'</div><hr style="height:1px;border:none;border-top:1px dashed #d4d4d4;" /><div class="t_answer"><span>正确答案：</span><span class="stu_tanswer">'+$scope.lists[i].tanswer+'</span></div><div class="s_answer"><span>学生答案：</span><span class="stu_answer">'+$scope.lists[i].answer+"</span></div></div></div>")}else if(5==$scope.lists[i].type)$("#form_marking").after('<div class="div_question"><div class="marking_opt"><span class="div_topic_question">'+sort+'.</span><div class="marking_title div_title_question preview_left" style="display:inline-block">'+$scope.lists[i].ipttitle+'</div><div class="preview_score">（分值：'+$scope.lists[i].e_score+'）</div><div class="form_opt opt_all">'+htmls+'</div><div class="t_answer"><span>正确答案：</span><span class="stu_tanswer">'+$scope.lists[i].tanswer+'</span></div><div class="s_answer"><span>学生答案：</span><span class="stu_answer">'+$scope.lists[i].answer+"</span></div></div></div>");else{if(12==$scope.lists[i].type||13==$scope.lists[i].type||14==$scope.lists[i].type||15==$scope.lists[i].type||16==$scope.lists[i].type)return;11==$scope.lists[i].type?($("#marking_inform").find(".marking_inform_name").eq(0).html($scope.lists[i].answer[0]),$("#form_marking").after('<div class="div_question"><div class="marking_opt" style="display:none"></div></div>')):$("#form_marking").after('<div class="div_question"><div class="marking_opt"><span class="div_topic_question">'+sort+'.</span><div class="marking_title div_title_question preview_left" style="display:inline-block">'+$scope.lists[i].ipttitle+'</div><div class="preview_score">（分值：'+$scope.lists[i].e_score+'）</div><div class="form_opt opt_all">'+htmls+'</div><div class="s_answer"><span>学生答案：</span><span class="stu_answer">'+$scope.lists[i].answer+"</span></div></div></div>")}else if(i>0)if(null!=a){for(x=0;x<a.length;x++)var html='<div class="preview_left">'+a[x]+"</div>",htmls=htmls+html;if(9==$scope.lists[i].type&&(htmls='<div class="preview_left">A.对</div><div class="preview_left">B.错</div>'),7!=$scope.lists[i].type)$(".marking_opt:last").after('<div class="marking_opt"><span class="div_topic_question">'+sort+'</span><div class="marking_title div_title_question preview_left" style="display:inline-block">'+$scope.lists[i].ipttitle+'</div><div class="preview_score">（分值：'+$scope.lists[i].e_score+'）</div><div class="form_opt opt_all">'+htmls+'</div><hr style="height:1px;border:none;border-top:1px dashed #d4d4d4;" /><div class="t_answer"><span>正确答案：</span><span class="stu_tanswer">'+$scope.lists[i].tanswer+'</span></div><div class="s_answer"><span>学生答案：</span><span class="stu_answer">'+$scope.lists[i].answer+"</span></div></div>");else if(7==$scope.lists[i].type){var leftData=$scope.lists[i].question.left,rightData=$scope.lists[i].question.right;leftData=leftData.replace(/&quot;/g,'"'),rightData=rightData.replace(/&quot;/g,'"'),leftData=eval("("+leftData+")"),rightData=eval("("+rightData+")");var leftHtmls="",rightHtmls="";for(var key in leftData){var l="L"+key,r="R"+key,leftHtml='<input disabled="disabled" class="'+l+'" value="'+leftData[key][l]+'" style="margin-bottom:15px;">';leftHtmls+=leftHtml;var rightHtml='<input disabled="disabled" class="'+r+'" value="'+rightData[key][r]+'" style="margin-bottom:15px;">';rightHtmls+=rightHtml}var html='<div class="marking_opt"><span class="div_topic_question">'+sort+'</span><div class="marking_title div_title_question preview_left" style="display:inline-block">'+$scope.lists[i].ipttitle+'</div><div class="preview_score">（分值：'+$scope.lists[i].e_score+'）</div><div class="form_opt opt_all">'+htmls+'</div><hr style="height:1px;border:none;border-top:1px dashed #d4d4d4;" /><div style="color:#f3695f;margin-bottom:20px">正确答案：</div><canvas id="canvas'+$scope.lists[i].id+'" width="400" height="300" style="position:absolute"></canvas><div class="left" style="display:inline-block;width:156px">'+leftHtmls+'</div><div class="right" style="display:inline-block;width:156px;margin-left:100px">'+rightHtmls+'</div><div style="color:#6c0;margin-bottom:20px">学生答案：</div><canvas id="myCanvas'+$scope.lists[i].id+'" width="400" height="300" style="position:absolute"></canvas><div class="sleft" style="display:inline-block;width:156px">'+leftHtmls+'</div><div class="sright" style="display:inline-block;width:156px;margin-left:100px">'+rightHtmls+"</div></div>";$(".marking_opt:last").after(html);var canvasId=$(".marking_opt:last").find("canvas").eq(0).attr("id"),canvasLeft=$(".marking_opt:last").find("#"+canvasId).offset().left,canvasTop=$(".marking_opt:last").find("#"+canvasId).offset().top,inputWidth=$(".marking_opt:last").find("input").eq(0).css("width");inputWidth=parseInt(inputWidth);var c=document.getElementById(canvasId),cxt=c.getContext("2d"),tanswer=$scope.lists[i].tanswer;for(var key in tanswer){var leftClass=tanswer[key].substring(0,2),rightClass=tanswer[key].substr(2),leftTop=$(".marking_opt:last").find("."+leftClass).eq(0).offset().top,leftLeft=$(".marking_opt:last").find("."+leftClass).eq(0).offset().left,rightTop=$(".marking_opt:last").find("."+rightClass).eq(0).offset().top,rightLeft=$(".marking_opt:last").find("."+rightClass).eq(0).offset().left;cxt.moveTo(inputWidth,parseInt(leftTop-canvasTop+8)),cxt.lineTo(parseInt(rightLeft-canvasLeft),parseInt(rightTop-canvasTop+8)),cxt.stroke()}var scanvasId=$(".marking_opt:last").find("canvas").eq(1).attr("id"),scanvasLeft=$(".marking_opt:last").find("#"+scanvasId).offset().left,scanvasTop=$(".marking_opt:last").find("#"+scanvasId).offset().top,sc=document.getElementById(scanvasId),scxt=sc.getContext("2d"),answer=$scope.lists[i].answer;for(var key in answer){var leftClass=answer[key].substring(0,2),rightClass=answer[key].substr(2),leftTop=$(".marking_opt:last").find("."+leftClass).eq(1).offset().top,leftLeft=$(".marking_opt:last").find("."+leftClass).eq(1).offset().left,rightTop=$(".marking_opt:last").find("."+rightClass).eq(1).offset().top,rightLeft=$(".marking_opt:last").find("."+rightClass).eq(1).offset().left;scxt.moveTo(inputWidth+1,parseInt(leftTop-scanvasTop+8)),scxt.lineTo(parseInt(rightLeft-scanvasLeft+1),parseInt(rightTop-scanvasTop+8)),scxt.stroke()}}}else if(5==$scope.lists[i].type)$(".marking_opt:last").after('<div class="marking_opt"><span class="div_topic_question">'+sort+'</span><div class="marking_title div_title_question preview_left" style="display:inline-block">'+$scope.lists[i].ipttitle+'</div><div class="preview_score">（分值：'+$scope.lists[i].e_score+'）</div><div class="form_opt opt_all">'+htmls+'</div><div class="t_answer"><span>正确答案：</span><span class="stu_tanswer">'+$scope.lists[i].tanswer+'</span></div><div class="s_answer"><span>学生答案：</span><span class="stu_answer">'+$scope.lists[i].answer+"</span></div></div>");else if(7==$scope.lists[i].type){var leftData=$scope.lists[i].question.left;leftData=leftData.replace(/&quot;/g,'"'),leftData=eval("("+leftData+")")}else{if(12==$scope.lists[i].type||13==$scope.lists[i].type||14==$scope.lists[i].type||15==$scope.lists[i].type||16==$scope.lists[i].type)return;11==$scope.lists[i].type?($("#marking_inform").find(".marking_inform_name").html($scope.lists[i].answer[0]),$("#marking_inform").find(".marking_inform_time").html($scope.data.time),$("#form_marking:last").after('<div class="marking_opt" style="display:none"></div>')):$(".marking_opt:last").after('<div class="marking_opt"><span class="div_topic_question">'+sort+'</span><div class="marking_title div_title_question preview_left" style="display:inline-block">'+$scope.lists[i].ipttitle+'</div><div class="preview_score">（分值：'+$scope.lists[i].e_score+'）</div><div class="form_opt opt_all">'+htmls+'</div><div class="s_answer"><span>学生答案：</span><span class="stu_answer">'+$scope.lists[i].answer+"</span></div></div>")}6!=$scope.lists[i].type&&17!=$scope.lists[i].type||$(".marking_opt").eq(i).find(".preview_score").eq(0).text("（此题为投票题，不计入总分）")}}]);var testStatistics=angular.module("ddd",["toBottom"]);testStatistics.controller("testStatistics",["$scope","$location","formService",function($scope,$location,formService){function getData(e){$scope.lists=e.list,$scope.pageNub=Math.ceil(e.map.count/e.map.pageSize);var a=[];for(i=0;i<$scope.pageNub;i++){var s=i+1;a.push(s)}for($scope.pages=a,$scope.$apply(),$("html,body").animate({scrollTop:0},500),e.map.count<15&&$(".page_tpl").eq(0).css("display","none"),$scope.listsLen=e.list.length,t=0;t<$scope.listsLen;t++){var o=[],d=[];for(var l in e.list[t].einfo){var n=l,r=e.list[t].einfo[l];o.push(n),d.push(r[0])}$scope.lists[t].arr_info_name=o,$scope.lists[t].arr_info_val=d}}$scope.formType=1,$scope.legend=["不及格","及格","良好","优秀"],$scope.getPer=function(){$scope.fine_score=$(".statistics_per_header").eq(0).find("input").eq(0).val(),$scope.good_score=$(".statistics_per_header").eq(0).find("input").eq(1).val(),$.ajax({type:"GET",async:!1,url:PREFIX_HOST+"/index.php?c=form&a=scorelist&fid="+fid+"&fine_score="+$scope.fine_score+"&good_score="+$scope.good_score,success:function(data){var data=eval("("+data+")");$scope.legend=["不及格","及格","良好","优秀"],$scope.value=[data.st_res.pnum.failed_num,data.st_res.pnum.pass_num,data.st_res.pnum.fine_num,data.st_res.pnum.good_num];var myChart=echarts.init(document.getElementById("piemain"),"macarons"),myChart2=echarts.init(document.getElementById("linemain"),"macarons");option={tooltip:{trigger:"item",formatter:"{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"right",data:$scope.legend},color:["#ff766c","#7fd7a2","#83c0e9","#f898bf"],series:[{
name:"访问来源",type:"pie",radius:"50%",center:["45%","35%"],data:function(){var t=[];for(i=0;i<$scope.legend.length;i++){var e={value:$scope.value[i],name:$scope.legend[i]};t.push(e)}return t}(),itemStyle:{normal:{label:{show:!0,formatter:"{b} : {c}人 \n ({d}%)"},labelLine:{show:!0}},emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},option2={tooltip:{formatter:"{b} : {c}人"},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},xAxis:{data:["不及格","及格","良好","优秀"]},yAxis:{splitArea:{show:!0}},series:[{name:"成绩",type:"bar",center:["20%","30%"],data:[data.st_res.pnum.failed_num,data.st_res.pnum.pass_num,data.st_res.pnum.fine_num,data.st_res.pnum.good_num],itemStyle:{normal:{color:function(t){var e=["#ff766c","#7fd7a2","#83c0e9","#f898bf","#27727B","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD","#D7504B","#C6E579","#F4E001","#F0805A","#26C0C0"];return e[t.dataIndex]},label:{show:!0,position:"top",formatter:"{c}"}}}}]},myChart.setOption(option),myChart2.setOption(option2)},error:function(t){console.log(t)}})},$scope.percentage=function(){var t=$(".statistics_per").eq(0).css("height");"0px"==t?$(".statistics_per").eq(0).animate({height:"470px"},"1000",function(){$(".all_title button").eq(0).text("收起统计")}):$(".statistics_per").eq(0).animate({height:"0px"},"1000",function(){$(".all_title button").eq(0).text("查看统计百分比")})},$scope.stu_info=function($event){var status=$($event.target).closest(".repeat_count").eq(0).find(".stu_info_id").eq(0).css("display");if("none"==status){var div_stu_len=$(".stu_info_id").length;for(r=0;r<div_stu_len;r++){var ss=$(".stu_info_id").eq(r).css("display");"block"==ss&&($(".stu_info_id").eq(r).css("display","none"),$(".stu_info_id").eq(r).children(".stu_info_id_name").eq(0).remove())}$($event.target).closest(".repeat_count").eq(0).find(".stu_info_id").eq(0).css("display","block");var einfo=$($event.target).closest(".repeat_count").eq(0).find(".mid_stu_info").eq(0).text();for(einfo=eval("("+einfo+")"),i=0;i<einfo.arr_info_name.length;i++)$($event.target).closest(".repeat_count").eq(0).find(".stu_info_id").eq(0).children(".stu_info_id_name").after('<div class="col-xs-6">'+einfo.arr_info_name[i]+'</div><div class="col-xs-6">'+einfo.arr_info_val[i]+"</div><br/>")}else $($event.target).closest(".repeat_count").eq(0).find(".stu_info_id").eq(0).css("display","none"),$($event.target).closest(".repeat_count").eq(0).find(".stu_info_id").eq(0).children(".stu_info_id_name").eq(0).remove()},$scope.createForm=function(){$location.path("/form")},$scope.myForm=function(){return formService.myForm()},$scope.myTest=function(){return formService.myTest()};var a=$location.url(),fid=a.substr(21,a.length);$.ajax({type:"GET",async:!1,url:PREFIX_HOST+"/index.php?c=form&a=scorelist&fid="+fid,success:function(data){var data=eval("("+data+")");getData(data)}}),$("body").on("mouseover",".repeat_count",function(){$(this).css("background-color","#f0f0f0")}),$("body").on("mouseout",".repeat_count",function(){$(this).css("background-color","#fff")}),$scope.marking=function(t){$scope.eid=$(t.target).parent().parent().find(".formFid").text(),window.open("#/form/marking/"+$scope.eid)},$scope.nextPage=function($event){var nub=parseInt($($event.target).parent().find(".pageNo").text())+parseInt("1");nub>$scope.pageNub?alert("已是最后一页"):($($event.target).parent().find(".pageNo").html(nub),$($event.target).parent().find("input").val(nub),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=scorelist&fid="+fid+"&pageNo="+nub,success:function(data){var data=eval("("+data+")");getData(data)}}))},$scope.prePage=function($event){if(1==$($event.target).parent().find(".pageNo").text())alert("当前页为首页");else{var nub=$($event.target).parent().find(".pageNo").text()-1;$($event.target).parent().find(".pageNo").html(nub),$($event.target).parent().find("input").val(nub),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=scorelist&fid="+fid+"&pageNo="+nub,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})}},$scope.dingPage=function($event){var nub=$($event.target).parent().find("input").val();nub>$scope.pageNub?alert("最大页码为"+$scope.pageNub):$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=scorelist&fid="+fid+"&pageNo="+nub,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})},$scope.toPage=function($event){var text=$($event.target).text();$($event.target).parent().find(".pageNo").html(text),$($event.target).parent().find("input").val(text),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=scorelist&fid="+fid+"&pageNo="+text,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})},$scope.weiPage=function($event){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=scorelist&fid="+fid+"&pageNo="+$scope.pageNub,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})},$scope.firstPage=function($event){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=scorelist&fid="+fid+"&pageNo=1",success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})}}]),testStatistics.directive("line",function(){return{scope:{id:"@",legend:"=",item:"="},restrict:"E",template:'<div style="height:400px;"></div>',replace:!0,link:function($scope,element,attrs,controller){var href=window.location.hash,fid=href.substr(22);$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=scorelist&fid="+fid,async:!1,success:function(data){var data=eval("("+data+")");$(".statistics_per_header").eq(0).find("input").eq(0).val(data.st_res.fine_score),$(".statistics_per_header").eq(0).find("input").eq(1).val(data.st_res.good_score);var option={tooltip:{trigger:"item",formatter:"{b} : {c}人 ({d}%)"},legend:{orient:"vertical",left:"right",data:$scope.legend},color:["#ff766c","#7fd7a2","#83c0e9","#f898bf"],series:[{name:"访问来源",type:"pie",radius:"50%",center:["45%","45%"],data:[{value:data.st_res.pnum.failed_num,name:"不及格"},{value:data.st_res.pnum.pass_num,name:"及格"},{value:data.st_res.pnum.fine_num,name:"良好"},{value:data.st_res.pnum.good_num,name:"优秀"}],itemStyle:{normal:{label:{show:!0,formatter:"{b} : {c}人 \n ({d}%)"},labelLine:{show:!0}},emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},option2={tooltip:{formatter:"{b} : {c}人"},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},magicType:{show:!0,type:["line","bar"]},restore:{show:!0},saveAsImage:{show:!0}}},xAxis:{data:["不及格","及格","良好","优秀"]},yAxis:{splitArea:{show:!0}},series:[{name:"成绩",type:"bar",data:[data.st_res.pnum.failed_num,data.st_res.pnum.pass_num,data.st_res.pnum.fine_num,data.st_res.pnum.good_num],itemStyle:{normal:{color:function(t){var e=["#ff766c","#7fd7a2","#83c0e9","#f898bf","#27727B","#FE8463","#9BCA63","#FAD860","#F3A43B","#60C0DD","#D7504B","#C6E579","#F4E001","#F0805A","#26C0C0"];return e[t.dataIndex]},label:{show:!0,position:"top",formatter:"{c}"}}},barWidth:60}]},myChart=echarts.init(document.getElementById("piemain"),"macarons");myChart.setOption(option);var myChart2=echarts.init(document.getElementById("linemain"),"macarons");myChart2.setOption(option2)},error:function(data){var data=eval("("+data+")");console.log(data)}})}}}),angular.module("ccc",["toBottom"]).controller("formStatistics",["$scope","$location","$modal","formService","$compile",function($scope,$location,$modal,formService,$compile){function getData(data,fid){var listsLen=data.list.length,lists=data.list,score=data.score;for(i=0;i<data.list.length;i++)if(3==data.list[i].type||4==data.list[i].type||6==data.list[i].type||9==data.list[i].type||17==data.list[i].type){var question=eval("("+data.list[i].question+")"),htmls="";for(x=0;x<question.length;x++)var sort=String.fromCharCode(65+x),html='<div class="count_opt">'+question[x]+'</div><div class="count_pre" style="text-align: left;"><div style="background-color: #eee;width: 200px;height: 20px;display: inline-block;margin-right: 10px;margin-bottom: -5px;    margin-left:30%;"><div style="background-color: #6c0;height: 20px;width:'+data.list[i].answer[sort]+'"></div></div>'+data.list[i].answer[sort]+"</div>",htmls=htmls+html;var len=$(".form_statistics").length,sort=i+1;0==len?($("#form_all").after('<div class="form_statistics"><div class="count_title">1.'+data.list[i].ipttitle+'</div><div class="form_statistics_top"><div class="col-md-6 col-xs-6">选项</div><div class="col-md-6 col-xs-6">比例</div></div>'+htmls+'<div class="count_opt" style="background-color:#eee">本题有效填写人数</div><div class="count_pre" style="background-color:#eee">'+data.score+"</div></div><div></div>"),3==data.list[i].type?$(".count_title").eq(i).after('<div style="display:inline-block;color:#6c0;font-size:16px;">（单选题）</div>'):4==data.list[i].type&&$(".count_title").eq(i).after('<div style="display:inline-block;color:#6c0;font-size:16px;">（多选题）</div>')):($(".form_statistics:last").after('<div class="form_statistics"><div class="count_title">'+(len+1)+"."+data.list[i].ipttitle+'</div><div class="form_statistics_top"><div class="col-md-6 col-xs-6">选项</div><div class="col-md-6 col-xs-6">比例</div></div>'+htmls+'<div class="count_opt" style="background-color:#eee">本题有效填写人数</div><div class="count_pre" style="background-color:#eee">'+data.score+"</div></div><div></div>"),3==data.list[i].type?$(".count_title").eq(i).after('<div style="display:inline-block;color:#6c0;font-size:16px;">（单选题）</div>'):4==data.list[i].type&&$(".count_title").eq(i).after('<div style="display:inline-block;color:#6c0;font-size:16px;">（多选题）</div>')),9==data.list[i].type}else{var answer=data.list[i].answer,htmls="";for(l=0;l<answer.length;l++)if("null"==data.list[i].answer[l]);else var html='<div class="form_answer">'+data.list[i].answer[l]+"</div>",htmls=htmls+html;var len=$(".form_statistics").length;if(0==len){var demo='<div class="form_statistics"><div class="count_title" style="width:100%">1.'+data.list[i].ipttitle+'</div><a class="askCount" ng-click="askCount($event)">查看本题答案详细信息</a><div class="ask_answer" style="display:none">'+htmls+"</div></div>";$("#form_all").after($compile(demo)($scope))}else{var demo='<div class="form_statistics"><div class="count_title" style="width:100%">'+(len+1)+"."+data.list[i].ipttitle+'</div><a class="askCount" ng-click="askCount($event)">查看本题答案详细信息</a><div class="ask_answer" style="display:none">'+htmls+"</div></div>";$(".form_statistics:last").after($compile(demo)($scope))}}}$scope.formType=1,$scope.createForm=function(){$location.path("/form")},$scope.myForm=function(){return formService.myForm()},$scope.myTest=function(){return formService.myTest()};var href=$location.url(),fid=href.substr(21,href.length);$("body").on("click","#form_bg",function(){$("#form_win").css("display","none"),$("#form_bg").css("display","none"),$("#form_win_answer").remove()}),$("body").on("click",".form_close",function(){$("#form_win").css("display","none"),$("#form_bg").css("display","none"),$("#form_win_answer").remove()}),$scope.askCount=function(t){var e=$(t.target).parent().find(".form_answer").length,a=$(t.target).parent().find(".count_title").text();$(".answer_tan_last").length>0&&$(".answer_tan_last").remove();var s="";for($("#form_win").children(".form_win_title").eq(0).html(a),i=0;i<e;i++)var o=$(t.target).parent().find(".form_answer").eq(i).text(),d=i+1,l='<div class="answer_tan"><div class="col-md-6 col-xs-6 form_win_answer">'+d+'</div><div class="col-md-6 col-xs-6">'+o+"</div></div>",s=s+l;$("#form_win").children(".form_win_title").eq(0).after('<div id="form_win_answer"><div class="answer_tan"><div class="col-md-6 col-xs-6"  style="color:black">序号</div><div class="col-md-6 col-xs-6" style="color:black">答案文本</div></div>'+s+'</div><div class="answer_tan answer_tan_last" style="background-color:#fff"><div class="col-md-6 col-xs-6">本题有效填写人次</div><div class="col-md-6 col-xs-6">'+d+"</div></div>"),$("#form_win").css("display","block"),$("#form_bg").css("display","block")},$.ajax({type:"POST",async:!1,url:PREFIX_HOST+"/index.php?c=form&a=surveynum&efid="+fid,success:function(data){var data=eval("("+data+")");getData(data,fid)}})}]),angular.module("fff",["toBottom"]).controller("grade",["$scope","$location","formService",function($scope,$location,formService){function getData(t){$scope.lists=t.list}$scope.formType=1,$scope.createForm=function(){$location.path("/form")},$scope.myForm=function(){return $scope.createForm=function(){$location.path("/form")},formService.myForm()},$scope.myTest=function(){return formService.myTest()};var href=$location.url(),fid=href.substr(12,href.length);$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=makescore&eid="+fid,async:!1,success:function(data){var data=eval("("+data+")");getData(data)}});var href=PREFIX_HOST+"/index.php?c=form&a=makescore&eid="+fid;$("#form_score").attr("action",href),$scope.postFen=function(){$("#form_score").submit()}}]),angular.module("eee",["toBottom"]).controller("checkQuestion",["$scope","$location","formService",function($scope,$location,formService){function getData(t){$scope.lists=t.list,$scope.counts=Math.ceil(t.map.count/t.map.pageSize);var e=[];for(i=0;i<$scope.counts;i++){var a=i+1;e.push(a)}$scope.pages=e,$scope.$apply(),$("html,body").animate({scrollTop:0},500),t.map.count<15&&$(".page_tpl").eq(0).css("display","none")}$scope.formType=1,$scope.createForm=function(){$location.path("/form")},$scope.myForm=function(){return $scope.createForm=function(){$location.path("/form")},formService.myForm()},$scope.myTest=function(){return formService.myTest()};var href=$location.url(),fid=href.substr(20,href.length);$("body").on("mouseover",".repeat_count",function(){$(this).css("background-color","#eee")}),$("body").on("mouseout",".repeat_count",function(){$(this).css("background-color","#fff")}),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=needhand&id="+fid,async:!1,success:function(data){var data=eval("("+data+")");getData(data)}}),$scope.nextPage=function($event){if($($event.target).parent().find(".pageNo").text()==$scope.counts)alert("已是最后一页");else{var nub=parseInt($($event.target).parent().find(".pageNo").text())+parseInt("1");$($event.target).parent().find(".pageNo").html(nub),$($event.target).parent().find("input").val(nub),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=needhand&id="+fid+"&pageNo="+nub,success:function(data){var data=eval("("+data+")");getData(data)}})}},$scope.prePage=function($event){if(1==$($event.target).parent().find(".pageNo").text())alert("当前页为首页");else{var nub=$($event.target).parent().find(".pageNo").text()-1;$($event.target).parent().find(".pageNo").html(nub),$($event.target).parent().find("input").val(nub),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=needhand&id="+fid+"&pageNo="+nub,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})}},$scope.dingPage=function($event){var nub=$($event.target).parent().find("input").val();nub>$scope.counts?alert("最大页码为"+$scope.counts):$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=needhand&id="+fid+"&pageNo="+nub,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})},$scope.toPage=function($event){var text=$($event.target).text();$($event.target).parent().find(".pageNo").html(text),$($event.target).parent().find("input").val(text),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=needhand&id="+fid+"&pageNo="+text,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})},$scope.weiPage=function($event){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=needhand&id="+fid+"&pageNo="+$scope.counts,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})},$scope.firstPage=function($event){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=needhand&id="+fid+"&pageNo=1",success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(data)}})},$scope.score=function(t){$scope.fid=$(t.target).parent().parent().find(".formFid").text(),$location.path("/form/grade/"+$scope.fid)}}]),angular.module("bbb",["toBottom"]).controller("myForm",["$scope","$location","$modal","formService",function($scope,$location,$modal,formService){function getData(t,e,a){$(".repeat_count").empty();var s=Math.ceil(a.map.count/a.map.pageSize);$scope.pages=s;var o=[];for(i=0;i<s;i++){var d=i+1;o.push(d)}$scope.formLists=t,$scope.formLists.PREFIX_HOST=window.location.host;var l=$scope.formLists.length;for(d=0;d<l;d++){var n=a.map.pageNo-1,r=d+1+17*n;$scope.formLists[d].myForm_nums=r}$scope.pageCounts=o,$scope.$apply(),a.map.count<17&&$(".page_tpl").eq(0).css("display","none")}$scope.formType=1,$scope.createForm=function(){$location.path("/form")},$scope.createForm=function(){$location.path("/form")},$scope.details=function(t){var e=$(t.target).parent().parent().find(".formFid").eq(0).text();window.open("#/form/view/"+e)},$scope.preview=function(t){var e=$(t.target).parent().parent().find(".formFid").eq(0).text();window.open("#/form/viewForm/"+e)},$scope.myForm=function(){return formService.myForm()},$scope.myTest=function(){return formService.myTest()},$.ajax({type:"GET",async:!1,url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=1&pageNo=1",success:function(data){var data=eval("("+data+")"),arr=[],arr2=[];for(i=0;i<data.list.length;i++)1==data.list[i].type?arr.push(data.list[i]):2==data.list[i].type&&arr2.push(data.list[i]);getData(arr,arr2,data)}}),$scope.nextPage=function($event){if($($event.target).parent().find(".pageNo").text()==$scope.pages)alert("已是最后一页");else{var nub=parseInt($($event.target).parent().find(".pageNo").text())+parseInt("1");$($event.target).parent().find(".pageNo").html(nub),$($event.target).parent().find("input").val(nub),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=1&pageNo="+nub,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(arr,0,data)}})}},$scope.prePage=function($event){if(1==$($event.target).parent().find(".pageNo").text())alert("当前页为首页");else{var nub=$($event.target).parent().find(".pageNo").text()-1;$($event.target).parent().find(".pageNo").html(nub),$($event.target).parent().find("input").val(nub),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=1&pageNo="+nub,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(arr,0,data)}})}},$scope.dingPage=function($event){var nub=$($event.target).parent().find("input").val();nub>$scope.pages?alert("码数超过限制"):$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=1&pageNo="+nub,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(arr,0,data)}})},$scope.toPage=function($event){var text=$($event.target).text();$($event.target).parent().find(".pageNo").html(text),$($event.target).parent().find("input").val(text),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=1&pageNo="+text,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(arr,0,data)}})},$scope.weiPage=function($event){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=1&pageNo="+$scope.pages,success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(arr,0,data)}})},$scope.firstPage=function($event){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=1&pageNo=1",success:function(data){var data=eval("("+data+")"),arr=[];for(i=0;i<data.list.length;i++)arr.push(data.list[i]);getData(arr,0,data)}})},$("body").on("mouseover",".repeat_count",function(){$(this).css("background-color","#eee")}),$("body").on("mouseout",".repeat_count",function(){$(this).css("background-color","#fff")}),$scope.edit=function(t){var e=$(t.target).parent().parent().find(".formFid").text();$location.path("form/blank/"+e)},$scope.myCount=function(t){$scope.fid=$(t.target).parent().parent().find(".formFid").text(),window.open("#/form/formStatistics/"+$scope.fid)},$scope.delete=function($event){$scope.fid=$($event.target).parent().parent().find(".formFid").text(),$.ajax({type:"get",url:PREFIX_HOST+"/index.php?c=form&a=del_form&del_fid="+$scope.fid,success:function(data){var data=eval("("+data+")");200==data.code&&($($event.target).parent().parent().css("display","none"),alert(data.msg))}})}}]),angular.module("llll",["toBottom"]).controller("myTest",["$scope","$location","$modal","formService","$state",function($scope,$location,$modal,formService,$state){function getData(t,e,a){var s=Math.ceil(a.map.count/a.map.pageSize);$scope.counts=s,$scope.pages=s;var o=[];for(i=0;i<s;i++){var d=i+1;o.push(d)}$scope.formLists=t,$scope.testLists=e,$scope.pageCounts=o;var l=$scope.testLists.length;for(d=0;d<l;d++){var n=d+1+17*(a.map.pageNo-1);$scope.testLists[d].myTest_nums=n}$scope.$apply(),a.map.count<17&&$(".page_tpl").eq(0).css("display","none")}$scope.formType=1,$scope.createForm=function(){$location.path("/form")},$scope.createForm=function(){$location.path("/form")},$scope.details=function(t){var e=$(t.target).parent().parent().find(".formFid").eq(0).text();window.open("#/form/view/"+e)},$scope.preview=function(t){$scope.formFid=$(t.target).parent().parent().find(".formFid").eq(0).text(),window.open("#/form/viewForm/"+$scope.formFid)},$scope.export=function($event){var fid=$($event.target).closest(".repeat_count ").find(".formFid").eq(0).text();$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=outscore&efid="+fid,success:function(data){var data=eval("("+data+")");console.log(data.forwardUrl),window.open(data.forwardUrl)}})},$scope.myForm=function(){return formService.myForm()},$scope.myTest=function(){return formService.myTest()},$.ajax({type:"GET",async:!1,url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=2",success:function(data){var data=eval("("+data+")"),arr=[],arr2=[];for(i=0;i<data.list.length;i++)1==data.list[i].type?arr.push(data.list[i]):2==data.list[i].type&&arr2.push(data.list[i]);getData(arr,arr2,data)}}),$scope.nextPage=function($event){var nub=parseInt($($event.target).parent().find(".pageNo").text())+parseInt("1");$($event.target).parent().find(".pageNo").text()==$scope.counts?alert("已是最后一页"):($($event.target).parent().find(".pageNo").html(nub),$($event.target).parent().find("input").val(nub),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=2&pageNo="+nub,success:function(data){var data=eval("("+data+")"),arr2=[];for(i=0;i<data.list.length;i++)arr2.push(data.list[i]);getData(0,arr2,data)}}))},$scope.prePage=function($event){var nub=$($event.target).parent().find(".pageNo").text()-1;1==$($event.target).parent().find(".pageNo").text()?alert("当前页为首页"):($($event.target).parent().find(".pageNo").html(nub),$($event.target).parent().find("input").val(nub),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=2&pageNo="+nub,success:function(data){var data=eval("("+data+")"),arr2=[];for(i=0;i<data.list.length;i++)arr2.push(data.list[i]);getData(0,arr2,data)}}))},$scope.dingPage=function($event){var nub=$($event.target).parent().find("input").val();nub>$scope.counts?alert("码数超过限制"):$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=2&pageNo="+nub,success:function(data){var data=eval("("+data+")"),arr2=[];for(i=0;i<data.list.length;i++)arr2.push(data.list[i]);getData(0,arr2,data)}})},$scope.toPage=function($event){var text=$($event.target).text();$($event.target).parent().find(".pageNo").html(text),$($event.target).parent().find("input").val(text),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=2&pageNo="+text,success:function(data){var data=eval("("+data+")"),arr2=[];for(i=0;i<data.list.length;i++)arr2.push(data.list[i]);getData(0,arr2,data)}})},$scope.weiPage=function($event){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=2&pageNo="+$scope.pages,success:function(data){var data=eval("("+data+")"),arr2=[];for(i=0;i<data.list.length;i++)arr2.push(data.list[i]);getData(0,arr2,data)}})},$scope.firstPage=function($event){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=haveexam&type=2&pageNo=1",success:function(data){var data=eval("("+data+")"),arr2=[];for(i=0;i<data.list.length;i++)arr2.push(data.list[i]);getData(0,arr2,data)}})},$("body").on("mouseover",".repeat_count",function(){$(this).css("background-color","#eee")}),$("body").on("mouseout",".repeat_count",function(){$(this).css("background-color","#fff")}),$scope.delete=function($event){$scope.fid=$($event.target).parent().parent().find(".formFid").text(),$.ajax({type:"get",url:PREFIX_HOST+"/index.php?c=form&a=del_form&del_fid="+$scope.fid,success:function(data){var data=eval("("+data+")");200==data.code&&($($event.target).parent().parent().parent().css("display","none"),alert(data.msg))}})},$scope.checkQuestion=function(t){$scope.fid=$(t.target).parent().parent().find(".formFid").text(),window.open("#/form/checkQuestion/"+$scope.fid)},$scope.countTest=function(t){$scope.fid=$(t.target).parent().parent().find(".formFid").text(),window.open("#/form/testStatistics/"+$scope.fid)},$scope.editTest=function(t){$scope.fid=$(t.target).parent().parent().find(".formFid").text(),$location.path("/form/tests/"+$scope.fid)}}]),angular.module("aaaa",["toBottom"]).controller("createForm2",["$scope","$http","$location","$state","formService",function(t,e,i,a,s){t.formType=1,t.createForm=function(){i.path("/form")};var o=function(e){t.userType=e.obj.type};$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=user&a=check&time=1487571408261",async:!1,success:function(t){o(t)}}),t.viewTpl=function(){i.path("form/tpl")},t.createTest=function(){var t={headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8;"}},a={ftype:"2"};a=$.param(a);var s=PREFIX_HOST+"/index.php?c=form&a=design";e.post(s,a,t).success(function(t){i.path("form/tests/"+t.fid)})},t.create=function(){var t={headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8;"}},a={ftype:"1"};a=$.param(a);var s=PREFIX_HOST+"/index.php?c=form&a=design";e.post(s,a,t).success(function(t){i.path("form/blank/"+t.fid)})},t.myForm=function(){i.path("form/myForm")},t.myTest=function(){i.path("form/myTest")}}]),angular.module("preview",[]).controller("previewCtrl",["$scope","$location",function($scope,$location){$scope.formType=1,$scope.createForm=function(){$location.path("/form")},$scope.formPreClose=function(){$scope.$dismiss()};var href=$location.url(),x=href.substring(6,11);if("blank"==x)var fid=href.substr(12);else{var formId_len=$("#formId").length;if(0!=formId_len)var fid=$("#formId").text();else var fid=$("#testId").text()}$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=preview&fid="+href.substr(12),success:function(data){var data=eval("("+data+")");for(i=0;i<data.list.length;i++){var htmls="";if(1==data.list[i].type)$("#preview_title").html(data.list[i].ipttitle);else if(3==data.list[i].type||4==data.list[i].type||6==data.list[i].type){for(a=0;a<data.list[i].info.length;a++){var html='<div style="margin-top:2px"><div class="circle_pre"></div><div style="display:inline-block">'+data.list[i].info[a]+"</div></div>";htmls+=html}$(".preview_opt:last").after('<div class="preview_opt"><div style="display:inline-block">'+data.list[i].sort+'.</div><div class="preview_title preview_left2" style="display:inline-block">'+data.list[i].ipttitle+'</div><div class="score_pre">（分值：'+data.list[i].score+'分）</div><div class="">'+htmls+'</div><hr style="height:1px;border:none;border-top:1px solid #ddd;margin-bottom:20px"></div>'),4==data.list[i].type?$(".preview_opt:last").find(".preview_title").after('<div style="color:red;display:inline-block">【多选题】</div>'):6==data.list[i].type&&$(".preview_opt:last").find(".preview_title").after('<div style="color:red;display:inline-block">【投票】</div>')}else $(".preview_opt:last").after('<div class="preview_opt"><div style="display:inline-block">'+data.list[i].sort+'.</div><div class="preview_title preview_left2" style="display:inline-block">'+data.list[i].ipttitle+'</div><input class="input_pre" disabled="true"><hr style="height:1px;border:none;border-top:1px solid #ddd;margin-bottom:0px"></div>')}}})}]),angular.module("questionnaire",["toBottom"]).controller("createForm",["$rootScope","$http","$scope","$timeout","security","$window","$stateParams","$modal","formService","$location","$state","$compile",function($rootScope,$http,$scope,$setTimeout,security,$window,$stateParams,$modal,formService,$location,$state,$compile){document.documentElement.clientHeight<920&&$("#left").children("a").css({height:"38px","padding-top":"7px"}),$("html, body").animate({scrollTop:0});var left_color="",href=window.location.hash,formFid=href.substr(13,href.length),testFid=href.substring(7,12);$scope.nocreateAttachment=function(){return alert("问卷无连线功能，考卷可使用连线题功能"),!1},$scope.left=function(t){var e=$(t.target).closest(".edit_area").find(".attchment_left").eq(0).children("input").length;for(i=0;i<e;i++)$(t.target).closest(".edit_area").find(".attchment_left").eq(0).children("input").eq(i).css("border","1px solid #ccd5db");$(t.target).css("border","1px solid #6c0")},$scope.right=function(t){var e=$(t.target).parent().children("div").text(),a=$(t.target).closest(".edit_area").find(".attchment_left").eq(0).children("input").length,s=$(t.target).closest(".edit_area").find(".attchment_right").eq(0).children().children("div");if(""!=e)for(w=0;w<a;w++){var o=$(t.target).closest(".edit_area").find(".attchment_left").eq(0).children("input").eq(w).css("border-color");if("rgb(102, 204, 0)"==o)return alert("已被选择！"),!1}for(ww=0;ww<a;ww++){var o=$(t.target).closest(".edit_area").find(".attchment_left").eq(0).children("input").eq(ww).css("border-color");if("rgb(102, 204, 0)"==o){var d="L"+ww;for(l=0;l<a;l++){var n=s.eq(l).text();if(n==d)return alert("已被选择！"),!1}}}var r=$(t.target).closest(".div_question").find("canvas").eq(1).attr("id"),c="#"+r,v=document.getElementById(r),p=v.getContext("2d");p.beginPath();var _=($(t.target).closest(".edit_area").find(".right").length,$(t.target).offset().top),f=$(c).offset().top,u=$(t.target).offset().left,m=$(c).offset().left;for(i=0;i<a;i++){var h=$(t.target).closest(".edit_area").find(".attchment_left").eq(0).children("input").eq(i).css("border-color");if("rgb(102, 204, 0)"==h){var g=$(t.target).closest(".edit_area").find(".attchment_left").eq(0).children("input").eq(i).offset().top,b=$(t.target).closest(".edit_area").find(".attchment_left").eq(0).children("input").eq(i).attr("class");b=b.substring(0,2),$(t.target).parent().find("div").eq(0).text(b)}}for(p.moveTo(153,parseInt(g-f+10)),p.lineTo(parseInt(u-m),parseInt(_-f+10)),p.stroke(),p.closePath(),l=0;l<a;l++)$(t.target).closest(".edit_area").find(".attchment_left").eq(0).children("input").eq(l).css("border","1px solid rgb(204, 213, 219)")},$scope.addAtm=function(t){var e=$(t.target).closest(".edit_area").find(".attchment_left input").length;if(5==e)return alert("连线题最多为5条"),!1;var i=$(t.target).closest(".edit_area").find(".attchment_right").children("div").length,a='<input class="L'+e+'" ng-click="left($event)">',s='<div style="display: inline-block;" class="right_div"><input class="right" ng-click="right($event)"><div class="R'+i+'" style="display:none"></div></div>';$(t.target).closest(".edit_area").find(".attchment_left input:last-child").after($compile(a)($scope)),$(t.target).closest(".edit_area").find(".attchment_right").children("div:last").after($compile(s)($scope));
},$scope.atmBack=function(t){var e=$(t.target).closest(".edit_area").find("canvas").eq(0).attr("id"),a=document.getElementById(e),s=a.getContext("2d");s.clearRect(0,0,400,220);var o=$(t.target).closest(".edit_area").find(".right").length;for(i=0;i<o;i++)$(t.target).closest(".edit_area").find(".right").eq(i).parent().children("div").text("")},$scope.conAtm=function(t){var e=$(t.target).closest(".div_question").find(".atm_title").eq(0).val(),a=$(t.target).closest(".div_question").find(".atm_score").eq(0).val(),s=$(t.target).closest(".div_question").find(".attchment_left input").length,o=$(t.target).closest(".div_question").find(".attchment_right").children("div").length;for(q=0;q<s;q++){var d=$(t.target).closest(".div_question").find(".attchment_left input").eq(q).val();if(""==d)return alert("编辑框左侧列表内容缺失"),!1}for(j=0;j<o;j++){var l=$(t.target).closest(".div_question").find(".attchment_right").children("div").eq(j).children("input").eq(0).val(),n=$(t.target).closest(".div_question").find(".attchment_right").children("div").eq(j).children("div").eq(0).text();if(""==l)return alert("编辑框右侧列表内容缺失"),!1;if(""==n)return alert("连线有缺失，请连好每道题"),!1}if(""==e)return alert("题目未设置"),!1;if(""==a)return alert("分数未设置"),!1;var r=$(t.target).closest(".div_question").find(".right_div").length;if(a%r!=0)return alert("连线题分数除以题数不是整数，请修改连线题分数！"),!1;$(t.target).closest(".div_question").find(".form_score").eq(0).text(a),$(t.target).closest(".div_question").find(".div_title_question").eq(0).text(e);var c=[];for(i=0;i<r;i++){var v=$(t.target).closest(".div_question").find(".right_div").eq(i).find("div").eq(0).text(),p=$(t.target).closest(".div_question").find(".right_div").eq(i).find("div").eq(0).attr("class"),_=v+p;c.push(_)}$(t.target).closest(".div_question").find(".form_info").eq(0).text(c),$(t.target).closest(".edit_area").css("display","none");var f=$(t.target).closest(".div_question").find(".attchment_left").eq(0).children("input"),u=($(t.target).closest(".div_question").find(".left_jia").eq(0).children("input").length,"");for(el=0;el<f.length;el++){var m="L"+el,h='<input disabled="disabled" class="'+m+'" value="'+f.eq(el).val()+'">';u+=h}$(t.target).closest(".div_question").find(".left_jia").eq(0).html($compile(u)($scope));var g=$(t.target).closest(".div_question").find(".right_div input.right"),b=($(t.target).closest(".div_question").find(".right_jia").eq(0).children("input").length,"");for(er=0;er<g.length;er++){var m="R"+er,h='<input disabled="disabled" class="'+m+'" value="'+g.eq(er).val()+'">';b+=h}$(t.target).closest(".div_question").find(".right_jia").eq(0).html($compile(b)($scope));var y=$(t.target).closest(".div_question").find("canvas").eq(0).attr("id"),x=document.getElementById(y).getContext("2d");x.clearRect(0,0,400,170);var w=$(t.target).closest(".div_question").find("canvas").eq(0).attr("id");for(lx=0;lx<c.length;lx++){var v=c[lx].substring(1,2),p=c[lx].substr(-1),k=$(t.target).closest(".div_question").find(".left_jia").eq(0).children("input").eq(0).css("width"),k=parseInt(k),T=$(t.target).closest(".div_question").find(".left_jia").eq(0).children("input").eq(v).offset().top,S=$(t.target).closest(".div_question").find(".right_jia").eq(0).children("input").eq(p).offset().top,E=$(t.target).closest(".div_question").find(".right_jia").eq(0).children("input").eq(p).offset().left,I=$(t.target).closest(".div_question").find("canvas").eq(0).offset().left,P=$(t.target).closest(".div_question").find("canvas").eq(0).offset().top,C=document.getElementById(w),F=C.getContext("2d");F.beginPath(),F.moveTo(parseInt(k),parseInt(T-P+10)),F.lineTo(parseInt(E-I),parseInt(S-P+10)),F.stroke(),F.closePath()}},$scope.createAttachment=function(){var div_len=$(".div_question").length,this_sort=div_len+1;$.ajax({type:"POST",async:!1,url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+formFid,data:{sort:this_sort,ipttitle:"连线题目",type:"7"},success:function(data){var data=eval("("+data+")"),div_question_len=$(".div_question").length,atm_id="myCanvas"+div_question_len,a="canvas"+div_question_len,html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+(parseInt(div_question_len)+1)+'</div><div class="form_id">'+data.obj+'</div><div class="form_type">7</div><div class="form_score"></div><div class="form_info"></div><div class="div_title_question">连线题题目</div></div><div class="div_table_radio_question"><canvas id="'+a+'" width="400" height="220" style="position: absolute;">Your browser does not support the HTML5 canvas tag.</canvas><div class="left_jia" style="padding-left:0px;width:30%;display:inline-block;position:relative;"></div><div class="right_jia" style="width:30%;display: inline-block;position:relative;"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;"><div style="height:35px"><button class="dan_delete" ng-click="atm_delete($event)" style="display: none;"><span class=""></span>删除</button><button class="cancel" style="display: none;"><span class=""></span>取消</button><button class="edit" style="display: none;"><span class=""></span>编辑</button></div><div class="edit_area"><div class="col-md-8"><canvas id="'+atm_id+'" width="400" height="220" style="position: absolute;">Your browser does not support the HTML5 canvas tag.</canvas><div class="attchment_left col-md-6" style="padding-left:0px"><input class="L0" ng-click="left($event)"><input class="L1" ng-click="left($event)"><input class="L2" ng-click="left($event)"></div><div class="attchment_right col-md-6"><div style="display: inline-block;" class="right_div"><input class="right" ng-click="right($event)"><div class="R0" style="display:none"></div></div><div style="display: inline-block;" class="right_div"><input class="right" ng-click="right($event)"><div class="R1" style="display:none"></div></div><div style="display: inline-block;" class="right_div"><input class="right" ng-click="right($event)"><div class="R2" style="display:none"></div></div></div><div class="col-md-12"><button class="attchmentbtn" ng-click="addAtm($event)" style="margin-left: -15px;">添加一项</button><button class="attchmentbtn" ng-click="atmBack($event)">重置</button></div></div><div class="col-md-4"><div class="col-md-12"><div style="height:26px;background-color:#6c0;color: #fff;padding-left: 8px;padding-top: 5px;">题目：</div><textarea class="atm_title" style="background-color:#fff;width: 100%;height: 88px;margin-bottom:10px"></textarea></div><div class="col-md-12"><div class="" style="width:28%;display:inline-block;height:26px;background-color:#6c0;color: #fff;padding-left: 8px;padding-top: 5px;">分数：</div><textarea class="atm_score" style="width:72%;background-color:#fff;height: 26px;display:inline-block;margin-bottom:3px"></textarea></div></div><div class="col-md-12"><button class="attchment_confirm" ng-click="conAtm($event)">完成编辑</button></div></div></div></div>',div_question_len=$(".div_question").length;0==div_question_len?$("#question").after($compile(html)($scope)):$(".div_question:last").after($compile(html)($scope))}});var h=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:h},200)},$(document).scroll(function(){$("#formContent").css("height");$("#left").css({"margin-top":window.scrollY})}),$scope.formType=1,$scope.createTitle=function(t){var e=$("#divId").length;if(0!=e)return void alert("标题已创建，请点击标题进行修改");$modal.open({windowClass:"console six-contain",templateUrl:BASE_URL+"templates/form/create_name.html",controller:"createNameCtrl",files:["controllers/formController"]})},$scope.cancel=function(){$modal.open({windowClass:"six-contain mobile-contain",templateUrl:BASE_URL+"templates/form/tishiForm.html",controller:"cancelWarmCtrl",files:["controllers/formController"]})},$scope.createJudge=function(returndata){var href=window.location.hash,fid=href.substr(13,href.length),length=$("#formContent").find(".div_question").length,lengths=length+1,arr=["对","错",""],answer=["A","B"],data={type:"9",ipttitle:"题目",info:arr,sort:lengths};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")"),html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+lengths+'</div><div class="form_id">'+data.obj+'</div><div class="form_type">9</div><div class="form_score"></div><div class="form_info"></div><div class="div_title_question">题目</div></div><div class="div_table_radio_question"><div class="div_table_clear_top"></div><div class="del_all"><div><div class="circle"></div><div style="display:none" class="judge_opt">A</div><p style="display:inline-block">对</p></div><div><div class="circle"></div><div style="display:none" class="judge_opt">B</div><p style="display:inline-block">错</p></div></div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;"><div style="height:35px"><button class="dan_delete" ng-click="dan_delete($event)" style="display: none;"><span class=""></span>删除</button><button class="cancel" style="display: none;"><span class=""></span>取消</button><button class="edit" style="display: none;"><span class=""></span>编辑</button></div><div class="edit_area"><div class="p_title col-md-5"><p class="edit_title">标题</p><textarea class="edit_text">题目</textarea></div><div class="p_cont col-md-7"><div class="edit_opt">选项文字</div><div class="cont_opt"><p style="color:#666;display:none" class="judge_opt">A</p><input disabled="disabled" type="text" value="对" class="select_dan"><div class="dan_suan ng-scope">1</div><button class="rightAnswer ng-scope" ng-click="rightAnswer($event)">设置为正确答案</button></div><div class="cont_opt"><p style="color:#666;display:none" class="judge_opt">B</p><input disabled="disabled" type="text" value="错" class="select_dan"><div class="dan_suan ng-scope">2</div><button class="rightAnswer ng-scope" ng-click="rightAnswer($event)">设置为正确答案</button></div><div class="score"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><input class="edit_score"></div>\t</div><div class="col-md-12 col-xs-12"><button class="confirm">完成编辑</button></div></div></div></div>',html2='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+lengths+'</div><div class="form_id">'+data.obj+'</div><div class="form_type">9</div><div class="form_score"></div><div class="form_info"></div><div class="div_title_question">题目</div></div><div class="div_table_radio_question"><div class="div_table_clear_top"></div><div class="del_all"><div><div class="circle"></div><div style="display:none" class="judge_opt">A</div><p style="display:inline-block">对</p></div><div><div class="circle"></div><div style="display:none" class="judge_opt">B</div><p style="display:inline-block">错</p></div></div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;"><div style="height:35px"><button class="dan_delete" ng-click="dan_delete($event)" style="display: none;"><span class=""></span>删除</button><button class="cancel" style="display: none;"><span class=""></span>取消</button><button class="edit" style="display: none;"><span class=""></span>编辑</button></div><div class="edit_area"><div class="p_title col-md-12"><p class="edit_title">标题</p><textarea class="edit_text">题目</textarea></div><div class="col-md-12 col-xs-12"><button class="confirm">完成编辑</button></div></div></div></div>';if(0==length){1==returndata?$("#question").after($compile(html2)($scope)):$("#question").after($compile(html)($scope));var h=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:h},200)}else{1==returndata?$(".div_question:last").after($compile(html2)($scope)):$(".div_question:last").after($compile(html)($scope));var h=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:h},200)}}}),formService.toBottom()},$scope.createForm=function(){$location.path("/form")};var getType=function(t){$scope.userType=t.obj.type};$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=user&a=check&time=1487571408261",async:!1,success:function(t){getType(t)}}),$scope.myForm=function(){return formService.myForm()},$scope.myTest=function(){return formService.myTest()},$scope.preview=function(){$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=preview&fid="+formFid,success:function(data){var data=eval("("+data+")");1001==data.code?alert("尚未保存发布，请先保存发布"):200==data.code&&$modal.open({windowClass:"console ppt_console",templateUrl:"/Public/eq/dist/templates/form/preview.html",controller:"previewCtrl"})}})},$scope.dan_delete=function(t){$(t.target).parent().removeClass();var e=$(t.target).parent().parent().find(".cont_opt").length;for(i=0;i<e;i++){var a=String.fromCharCode(65+i),s=i+1;$(t.target).parent().parent().children(".cont_opt").eq(i).find("p").html(a);$(t.target).parent().parent().children(".cont_opt").eq(i).find(".dan_suan").html(s)}$(t.target).parent().remove()},$scope.write_delete=function($event){var r=confirm("确定删除此题目？");if(1==r){var id=$($event.target).parent().parent().children().eq(0).children().eq(2).text();$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=del_form&del_id="+id,success:function(data){var data=eval("("+data+")")}}),$($event.target).parent().parent().remove(),formService.sort()}},$scope.vote_delete=function($event){var r=confirm("确定删除此题目？");if(1==r){var id=$($event.target).parent().parent().children().eq(0).children().eq(2).text();$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=del_form&del_id="+id,success:function(data){var data=eval("("+data+")")}}),$($event.target).parent().parent().remove(),formService.sort()}},$scope.delete=function($event){var r=confirm("确定删除此题目？");if(1==r){var id=$($event.target).parent().parent().find(".form_id").eq(0).text();$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=del_form&del_id="+id,success:function(data){var data=eval("("+data+")");200==data.code&&$($event.target).parent().parent().parent().remove()},error:function(t){alert("系统出错")}}),$($event.target).parent().parent().remove(),formService.sort()}},$scope.delete_opt=function(t){$(t.target).parent().removeClass();var e=$(t.target).parent().parent().find(".cont_opt").length;for(i=0;i<e;i++){var a=String.fromCharCode(65+i),s=i+1;$(t.target).parent().parent().children(".cont_opt").eq(i).find("p").html(a);$(t.target).parent().parent().children(".cont_opt").eq(i).find(".dan_suan").html(s)}$(t.target).parent().remove()},$("body").on("click",".free_confirm",function(){var t=window.location.hash,e=(t.substr(13,t.length),$(this).parent().parent().find(".write_title").eq(0).val());$(this).parent().parent().find(".form_id").eq(0).text();$(this).parent().parent().parent().children().children().eq(1).html(e),$(this).parent().parent().css("display","none")}),$scope.name_delete=function($event){var r=confirm("确定删除此题目？");if(1==r){var id=$($event.target).parent().parent().find(".edit_area").children().eq(2).text();$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=del_form&del_id="+id,success:function(data){var data=eval("("+data+")")},error:function(t){alert("系统出错")}}),$($event.target).parent().parent().remove(),formService.sort()}else if(0==r)return!1},$scope.asd=function(t){var e=$(t.target).parent().find(".cont_opt").length,i=e+1,a=String.fromCharCode(65+e),s=$(t.target).parent().find(".rightAnswer").length;if(0!=s){var o='<div class="cont_opt"><p>'+a+'</p>.<input type="text" class="select_dan"><button class=\'delete_opt\' ng-click="delete_opt($event)">删除</button><div class="dan_suan">'+i+'</div><button class="rightAnswer" ng-click="rightAnswer($event)">设置为正确答案</button></div>';$(t.target).parent().find(".cont_opt:last").after($compile(o)($scope))}else{var d=window.location.hash,l=d.substring(7,12);if("blank"==l){var o='<div class="cont_opt"><p>'+a+'</p>.<input type="text" class="select_dan"><button class=\'delete_opt\' ng-click="delete_opt($event)">删除</button><div class="dan_suan">'+i+"</div></div>";$(t.target).parent().find(".cont_opt:last").after($compile(o)($scope))}else{var o='<div class="cont_opt"><p>'+a+'</p>.<input type="text" class="select_dan"><button class=\'delete_opt\' ng-click="delete_opt($event)">删除</button><div class="dan_suan">'+i+'</div><button class="duoAnswer" ng-click="duoAnswer($event)">设置为正确答案</button></div>';$(t.target).parent().find(".cont_opt:last").after($compile(o)($scope))}}},$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+formFid,success:function(data){var data=eval("("+data+")");if(0!=data.list){for(y=0;y<data.list.length;y++){if(1==data.list[y].type){var form_title_id=data.list[y].id,form_title_type=data.list[y].type,form_title_sort=data.list[y].sort,form_title_desc=data.list[y].iptval,form_title_title=data.list[y].ipttitle;$("#question").html('<div id="divId"><h1 id="pater_title" style="color:#f53d05">'+form_title_title+'</h1><div id="pater_desc"></div><hr style="height:1px;border:none;border-top:1px dashed #c1c1c1;margin-bottom:0px" /><div class="form_id">'+form_title_id+'</div><div class="form_type">1</div></div>'),document.getElementById("divId").addEventListener("mouseover",function(){$("#question").css("border","1px solid #f53d05"),$("#question").css("cursor","Pointer")}),document.getElementById("divId").addEventListener("click",function(){$modal.open({windowClass:"console six-contain",templateUrl:BASE_URL+"templates/form/create_name.html",controller:"createNameCtrl2",files:["controllers/formController"]})}),document.getElementById("divId").addEventListener("mouseout",function(){$("#question").css("border","1px solid #fff"),$("#question").css("cursor","")})}if(2==data.list[y].type&&($("#pater_desc").html(data.list[y].ipttitle),$("#pater_desc").after('<p style="display:none">'+data.list[y].id+"</p>")),3==data.list[y].type||4==data.list[y].type){var form_dan_id=data.list[y].id,form_dan_type=data.list[y].type,form_dan_sort=data.list[y].sort,form_dan_title=data.list[y].ipttitle,form_dan_info=eval("("+data.list[y].info+")"),form_opt=[];for(k=0;k<form_dan_info.length;k++)form_opt.push(form_dan_info[k].substr(2));var form_title_score=data.list[y].score,htmls="",htmls2="";for(a=0;a<form_dan_info.length;a++)var html='<div><div class="circle"></div><p style="display:inline-block">'+form_dan_info[a]+"</p></div>",htmls=htmls+html;var length=$("#formContent").find(".div_question").length;for(b=0;b<form_dan_info.length;b++)var sort=String.fromCharCode(65+b),html2='<div class="cont_opt"><p>'+sort+'</p>.<input type="text" value="'+form_opt[b]+'" class="select_dan"><button class="delete_opt" ng-click="delete_opt($event)">删除</button></div>',htmls2=htmls2+html2;if(3==data.list[y].type)if(0==length){var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_dan_sort+'</div><div class="form_id">'+form_dan_id+'</div><div class="form_type">3</div><div class="form_score">'+form_title_score+'</div><div class="form_info"></div><div class="div_title_question">'+form_dan_title+'</div></div><div class="div_table_radio_question"><div class="div_table_clear_top"></div><div class="del_all">'+htmls+'</div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="dan_delete" ng-click="dan_delete($event)">删除</button><button class="cancel" style="display: none;"><span class=""></span>取消</button><button class="edit">编辑</button></div><div class="edit_area" style="display:none"><div class="p_title col-md-5"><p class="edit_title">标题</p><textarea class="edit_text col">'+form_dan_title+'</textarea><div class="score"><p style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</p><input class="edit_score" value="'+form_title_score+'"></div></div><div class="p_cont col-md-7"><div class="edit_opt">选项文字</div>'+htmls2+'<button class="add_opt" ng-click="asd($event)">添加选项</button></div><div class="col-md-12 col-xs-12"><button class="confirm">完成编辑</button></div></div></div></div>';if($("div #question").after($compile(html)($scope)),"tests"==testFid){var tihao=data.list[y].sort-1,str=eval("("+data.list[y].iptanswer+")"),a=$(".div_question").eq(tihao).find(".delete_opt").length;for(s=0;s<a;s++){var html='<button class="rightAnswer" ng-click="rightAnswer($event)">设置为正确答案</button>';$(".div_question").eq(tihao).find(".delete_opt").eq(s).after($compile(html)($scope))}if(""!=str){var str2=str[0].charCodeAt()-65;$(".div_question").eq(tihao).find(".circle").eq(str2).html('<div class="selected"></div>'),$(".div_question").eq(tihao).find(".form_info").html(str),$(".div_question").eq(tihao).find(".rightAnswer").eq(str2).css("color","#fff"),$(".div_question").eq(tihao).find(".rightAnswer").eq(str2).css("background-color","#6c0")}}else{var tihao=data.list[y].sort-1;$(".div_question").eq(tihao).find(".score").eq(0).remove()}}else{var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_dan_sort+'</div><div class="form_id">'+form_dan_id+'</div><div class="form_type">3</div><div class="form_score">'+form_title_score+'</div><div class="form_info"></div><div class="div_title_question">'+form_dan_title+'</div></div><div class="div_table_radio_question"><div class="div_table_clear_top"></div><div class="del_all">'+htmls+'</div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="dan_delete" ng-click="dan_delete($event)">删除</button><button class="cancel" style="display: none;"><span class=""></span>取消</button><button class="edit">编辑</button></div><div class="edit_area" style="display:none"><div class="p_title col-md-5"><p class="edit_title">标题</p><textarea class="edit_text col">'+form_dan_title+'</textarea><div class="score"><p style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</p><input class="edit_score" value="'+form_title_score+'"></div></div><div class="p_cont col-md-7"><div class="edit_opt">选项文字</div>'+htmls2+'<button class="add_opt" ng-click="asd($event)">添加选项</button></div><div class="col-md-12 col-xs-12"><button class="confirm">完成编辑</button></div></div></div></div>';if($("div .div_question:last").after($compile(html)($scope)),"tests"==testFid){var tihao=data.list[y].sort-1,str=eval("("+data.list[y].iptanswer+")"),a=$(".div_question").eq(tihao).find(".delete_opt").length;for(s=0;s<a;s++){var html='<button class="rightAnswer" ng-click="rightAnswer($event)">设置为正确答案</button>';$(".div_question").eq(tihao).find(".delete_opt").eq(s).after($compile(html)($scope))}if(""!=str){$(".div_question").eq(tihao).children(".form_info").html(str);var str2=str[0].charCodeAt()-65;$(".div_question").eq(tihao).find(".circle").eq(str2).html('<div class="selected"></div>'),$(".div_question").eq(tihao).find(".form_info").html(str),$(".div_question").eq(tihao).find(".rightAnswer").eq(str2).css("color","#fff"),$(".div_question").eq(tihao).find(".rightAnswer").eq(str2).css("background-color","#6c0")}}else{var tihao=data.list[y].sort-1;$(".div_question").eq(tihao).find(".score").eq(0).remove()}}else if(4==data.list[y].type)if(0==length){var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_dan_sort+'</div><div class="form_id"">'+form_dan_id+'</div><div class="form_type">4</div><div class="form_score">'+form_title_score+'</div><div class="form_info"></div><div class="div_title_question">'+form_dan_title+'</div><div class="duo" style="display: inline-block;color: red;">【多选题】</div></div><div class="div_table_radio_question"><div class="div_table_clear_top"></div><div class="del_all">'+htmls+'</div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="dan_delete" ng-click="dan_delete($event)">删除</button><button class="cancel" style="display: none;"><span class=""></span>取消</button><button class="edit">编辑</button></div><div class="edit_area" style="display:none"><div class="p_title col-md-5"><p class="edit_title">标题</p><textarea class="edit_text">'+form_dan_title+'</textarea><div class="score"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><input value="'+form_title_score+'" class="edit_score"></div></div><div class="p_cont col-md-7"><div class="edit_opt">选项文字</div>'+htmls2+'<button class="add_opt" ng-click="asd($event)">添加选项</button></div><div class="col-md-12 col-xs-12"><button class="duo_confirm">完成编辑</button></div></div></div></div>';if($("div #question").after($compile(html)($scope)),"tests"==testFid){var tihao=data.list[y].sort-1,duoInfo=eval("("+data.list[y].iptanswer+")"),info_len=duoInfo.length,duo_list=data.list[y],htmls3="",finfo=data,a=$(".div_question").eq(tihao).find(".delete_opt").length;for(s=0;s<a;s++){var html='<button class="duoAnswer" ng-click="duoAnswer($event)">设置为正确答案</button>';$(".div_question").eq(tihao).find(".delete_opt").eq(s).after($compile(html)($scope))}for(g=0;g<info_len;g++){var str_duo1=eval("("+duo_list.iptanswer+")"),str_duo=str_duo1[g],str_duo2=str_duo.charCodeAt(),str_duo3=str_duo2-65;$(".div_question").eq(tihao).find(".circle").eq(str_duo3).html('<div class="selected"></div>'),$(".div_question").eq(tihao).find(".duoAnswer").eq(str_duo3).css("color","#fff"),$(".div_question").eq(tihao).find(".duoAnswer").eq(str_duo3).css("background-color","#6c0");var html4='<div class="form_info_dan">'+str_duo1[g]+"</div>",htmls3=htmls3+html4}$(".div_question").eq(tihao).find(".form_info").after(htmls3)}else{var tihao=data.list[y].sort-1;$(".div_question").eq(tihao).find(".score").eq(0).remove()}}else{var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_dan_sort+'</div><div class="form_id"">'+form_dan_id+'</div><div class="form_type">4</div><div class="form_score">'+form_title_score+'</div><div class="form_info"></div><div class="div_title_question">'+form_dan_title+'</div><div class="duo" style="display: inline-block;color: red;">【多选题】</div></div><div class="div_table_radio_question"><div class="div_table_clear_top"></div><div class="del_all">'+htmls+'</div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="dan_delete" ng-click="dan_delete($event)">删除</button><button class="cancel" style="display: none;"><span class=""></span>取消</button><button class="edit">编辑</button></div><div class="edit_area" style="display:none"><div class="p_title col-md-5"><p class="edit_title">标题</p><textarea class="edit_text">'+form_dan_title+'</textarea><div class="score"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><input value="'+form_title_score+'" class="edit_score"></div></div><div class="p_cont col-md-7"><div class="edit_opt">选项文字</div>'+htmls2+'<button class="add_opt" ng-click="asd($event)">添加选项</button></div><div class="col-md-12 col-xs-12"><button class="duo_confirm">完成编辑</button></div></div></div></div>';if($("div .div_question:last").after($compile(html)($scope)),"tests"==testFid){var tihao=data.list[y].sort-1,duoInfo=eval("("+data.list[y].iptanswer+")"),info_len=duoInfo.length,duo_list=data.list[y],htmls3="",finfo=data,a=$(".div_question").eq(tihao).find(".delete_opt").length;for(s=0;s<a;s++){var html='<button class="duoAnswer" ng-click="duoAnswer($event)">设置为正确答案</button>';$(".div_question").eq(tihao).find(".delete_opt").eq(s).after($compile(html)($scope))}}else{var tihao=data.list[y].sort-1;$(".div_question").eq(tihao).find(".score").eq(0).remove()}for(g=0;g<info_len;g++){var str_duo1=eval("("+duo_list.iptanswer+")"),str_duo=str_duo1[g],str_duo2=str_duo.charCodeAt(),str_duo3=str_duo2-65;$(".div_question").eq(tihao).find(".circle").eq(str_duo3).html('<div class="selected"></div>'),$(".div_question").eq(tihao).find(".duoAnswer").eq(str_duo3).css("color","#fff"),$(".div_question").eq(tihao).find(".duoAnswer").eq(str_duo3).css("background-color","#6c0");var html3='<div class="form_info_dan">'+str_duo1[g]+"</div>",htmls3=htmls3+html3}$(".div_question").eq(tihao).find(".form_info").after(htmls3)}}else if(5==data.list[y].type){var form_write_id=data.list[y].id,form_write_sort=data.list[y].sort,form_write_title=data.list[y].ipttitle,form_write_type=data.list[y].type,form_write_score=data.list[y].score,form_write_answers=eval("("+data.list[y].iptanswer+")"),form_write_answer=form_write_answers[0],length=$("#formContent").find(".div_question").length;if(0==length)if("blank"==testFid){var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_write_sort+'</div><div class="div_title_question">'+form_write_title+'</div><div class="form_id">'+form_write_id+'</div><div class="form_type">5</div><div class="form_score">'+form_write_score+'</div><div class="form_answer">'+form_write_answer+'</div></div><div class="div_table_clear_top"></div><textarea class="write_area" disabled="true"></textarea><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="write_delete" ng-click="write_delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button></div><div class="edit_area" style="display:none"><div class="p_title col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title edit_text">'+form_write_title+'</textarea></div><div class="col-md-12"><button class="write_confirm">完成编辑</button></div></div></div>';$("div #question").after($compile(html)($scope))}else{var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_write_sort+'</div><div class="div_title_question">'+form_write_title+'</div><div class="form_id">'+form_write_id+'</div><div class="form_type">5</div><div class="form_score">'+form_write_score+'</div><div class="form_answer">'+form_write_answer+'</div></div><div class="div_table_clear_top"></div><textarea class="write_area" disabled="true"></textarea><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="write_delete" ng-click="write_delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button></div><div class="edit_area" style="display:none"><div class="p_title col-md-5"><p class="edit_title">题目标题</p><textarea class="write_title edit_text">'+form_write_title+'</textarea><div><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><textarea class="write_score">'+form_write_score+'</textarea></div></div><div class="col-md-7"><div class="edit_opt">题目答案</div><textarea class="write_answer">'+form_write_answer+'</textarea></div><div class="col-md-12"><button class="write_confirm">完成编辑</button></div></div></div>';$("div #question").after($compile(html)($scope))}else if("blank"==testFid){var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_write_sort+'</div><div class="div_title_question">'+form_write_title+'</div><div class="form_id">'+form_write_id+'</div><div class="form_type">5</div><div class="form_score">'+form_write_score+'</div><div class="form_answer">'+form_write_answer+'</div></div><div class="div_table_clear_top"></div><textarea class="write_area" disabled="true"></textarea><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="write_delete" ng-click="write_delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button></div><div class="edit_area" style="display:none"><div class="p_title col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title edit_text">'+form_write_title+'</textarea></div><div class="col-md-12"><button class="write_confirm">完成编辑</button></div></div></div>';
$("div .div_question:last").after($compile(html)($scope))}else{var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_write_sort+'</div><div class="div_title_question">'+form_write_title+'</div><div class="form_id">'+form_write_id+'</div><div class="form_type">5</div><div class="form_score">'+form_write_score+'</div><div class="form_answer">'+form_write_answer+'</div></div><div class="div_table_clear_top"></div><textarea class="write_area" disabled="true"></textarea><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="write_delete" ng-click="write_delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button></div><div class="edit_area" style="display:none"><div class="p_title col-md-5"><p class="edit_title">题目标题</p><textarea class="write_title edit_text">'+form_write_title+'</textarea><div><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><textarea class="write_score">'+form_write_score+'</textarea></div></div><div class="col-md-7"><div class="edit_opt">题目答案</div><textarea class="write_answer">'+form_write_answer+'</textarea></div><div class="col-md-12"><button class="write_confirm">完成编辑</button></div></div></div>';$("div .div_question:last").after($compile(html)($scope))}}else if(6==data.list[y].type||17==data.list[y].type){var form_vote_id=data.list[y].id,form_vote_sort=data.list[y].sort,form_vote_type=data.list[y].type,form_vote_title=data.list[y].ipttitle,form_vote_info=eval("("+data.list[y].info+")"),htmls="",htmls2="";for(a=0;a<form_vote_info.length;a++)var html='<div><div class="circle"></div><p style="display:inline-block">'+form_vote_info[a]+"</p></div>",htmls=htmls+html;for(aa=0;aa<form_vote_info.length;aa++)var vote_sort=String.fromCharCode(65+aa),html2='<div class="cont_opt"><P>'+vote_sort+'.</P><input type="text" value="'+form_vote_info[aa].substr(2)+'" class="vote_select"><button class="vote_delete_opt">删除</button></div>',htmls2=htmls2+html2;var length=$("#formContent").find(".div_question").length;if(0==length){var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_vote_sort+'</div><div class="div_title_question">'+form_vote_title+'</div><div class="form_id">'+form_vote_id+'</div><div class="form_type">'+data.list[y].type+'</div></div><div class="div_table_clear_top"></div><div class="opt_all">'+htmls+'</div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="vote_delete" ng-click="vote_delete($event)">删除</button><button class="vote_cancelEdit">取消</button><button class="vote_edit">编辑</button></div><div class="edit_area" style="display:none"><div class="p_title col-md-5"><p class="edit_title">题目标题</p><textarea class="edit_text">投票（投票）</textarea></div><div class="p_cont col-md-7"><div><div class="edit_opt">选项文字</div></div>'+htmls2+'</div><div class="col-md-offset-7"><button class="vote_add_opt">添加选项</button></div><div class="col-md-12"><button class="vote_confirm">完成编辑</button></div></div></div>';$("div #question").after($compile(html)($scope))}else{var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_vote_sort+'</div><div class="div_title_question">'+form_vote_title+'</div><div class="form_id">'+form_vote_id+'</div><div class="form_type">'+data.list[y].type+'</div></div><div class="div_table_clear_top"></div><div class="opt_all">'+htmls+'</div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="vote_delete" ng-click="vote_delete($event)">删除</button><button class="vote_cancelEdit">取消</button><button class="vote_edit">编辑</button></div><div class="edit_area" style="display:none"><div class="p_title col-md-5"><p class="edit_title">题目标题</p><textarea class="edit_text">投票（投票）</textarea></div><div class="p_cont col-md-7"><div><div class="edit_opt">选项文字</div></div>'+htmls2+'</div><div class="col-md-offset-7"><button class="vote_add_opt">添加选项</button></div><div class="col-md-12"><button class="vote_confirm">完成编辑</button></div></div></div>';$("div .div_question:last").after($compile(html)($scope))}}else if(7==data.list[y].type){var a=data.list[y].info,a=eval("("+a+")"),leftData=a.left,rightData=a.right;if(null!=leftData&&null!=rightData){leftData=leftData.replace(/&quot;/g,'"'),rightData=rightData.replace(/&quot;/g,'"'),leftObj=eval("("+leftData+")"),rightObj=eval("("+rightData+")");var leftDataLen=leftObj.length,rightDataLen=rightObj.length,pro=[],rightPro=[],htmls="",rightHtmls="",editHtmls="";for(var key in leftObj){var proName="L"+key;pro.push(proName);var html='<input disabled="disabled" class="'+proName+'" value="'+leftObj[key][proName]+'">',htmls=htmls+html}for(var key in rightObj){var proName="R"+key;pro.push(proName);var html='<input disabled="disabled" class="'+proName+'" value="'+rightObj[key][proName]+'">',editHtml='<div style="display: inline-block;" class="right_div"><input class="right" ng-click="right($event)"><div class="'+proName+'" style="display:none"></div></div>',rightHtmls=rightHtmls+html,editHtmls=editHtmls+editHtml}var length=$("#formContent").find(".div_question").length,html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+data.list[y].sort+'</div><div class="form_id">'+data.list[y].id+'</div><div class="form_type">'+data.list[y].type+'</div><div class="form_score">'+data.list[y].score+'</div><div class="form_info">'+data.list[y].iptanswer+'</div><div class="div_title_question">'+data.list[y].ipttitle+'</div></div><div class="div_table_radio_question"><canvas id="canvas'+length+'" width="400" height="220" style="position: absolute;">Your browser does not support the HTML5 canvas tag.</canvas><div class="left_jia" style="padding-left:0px;width:30%;display:inline-block;position:relative;">'+htmls+'</div><div class="right_jia" style="width:30%;display: inline-block;position:relative;">'+rightHtmls+'</div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;"><div style="height:35px"><button class="dan_delete" ng-click="atm_delete($event)" style="display: none;"><span class=""></span>删除</button><button class="cancel" style="display: none;"><span class=""></span>取消</button><button class="edit" style="display: none;"><span class=""></span>编辑</button></div><div class="edit_area" style="display:none"><div class="col-md-8"><canvas id="myCanvas'+length+'" width="400" height="170" style="position: absolute;">Your browser does not support the HTML5 canvas tag.</canvas><div class="attchment_left col-md-6" style="padding-left:0px"><input class="L0" ng-click="left($event)"><input class="L1" ng-click="left($event)"><input class="L2" ng-click="left($event)"></div><div class="attchment_right col-md-6"><div style="display: inline-block;" class="right_div"><input class="right" ng-click="right($event)"><div class="R0" style="display:none"></div></div><div style="display: inline-block;" class="right_div"><input class="right" ng-click="right($event)"><div class="R1" style="display:none"></div></div><div style="display: inline-block;" class="right_div"><input class="right" ng-click="right($event)"><div class="R2" style="display:none"></div></div></div><div class="col-md-12"><button class="attchmentbtn" ng-click="addAtm($event)">添加一项</button><button class="attchmentbtn" ng-click="atmBack($event)">重置</button></div></div><div class="col-md-4"><div class="col-md-12"><div style="height:26px;background-color:#6c0;color: #fff;padding-left: 8px;padding-top:5px;">题目：</div><textarea class="atm_title" style="background-color:#fff;width: 100%;height: 88px;margin-bottom:10px">'+data.list[y].ipttitle+'</textarea></div><div class="col-md-12"><div class="" style="width:28%;display:inline-block;height:26px;background-color:#6c0;color: #fff;padding-left: 8px;padding-top: 5px;">分数：</div><textarea class="atm_score" style="width:72%;background-color:#fff;height: 26px;display:inline-block;margin-bottom:3px">'+data.list[y].score+'</textarea></div></div><div class="col-md-12"><button class="attchment_confirm" ng-click="conAtm($event)">完成编辑</button></div></div></div></div>';0==length?$("div #question").after($compile(html)($scope)):$("div .div_question:last").after($compile(html)($scope));var canvasId=$(".div_question:last").find("canvas").eq(0).attr("id"),canvasLeft=$(".div_question:last").find("#"+canvasId).offset().left,canvasTop=$(".div_question:last").find("#"+canvasId).offset().top,inputWidth=$(".div_question:last").find(".left_jia").eq(0).children("input").css("width");inputWidth=parseInt(inputWidth);var iptanswer=eval("("+data.list[y].iptanswer+")"),c=document.getElementById(canvasId),cxt=c.getContext("2d");for(cxt.beginPath(),h=0;h<iptanswer.length;h++){var leftClass=iptanswer[h],rightClass=leftClass.substr(2);leftClass=leftClass.substring(0,2);var leftClass=$(".div_question:last").find("."+leftClass).eq(0),rightClass=$(".div_question:last").find("."+rightClass).eq(0),leftLeft=leftClass.offset().left,leftTop=leftClass.offset().top,rightLeft=rightClass.offset().left,rightTop=rightClass.offset().top;cxt.moveTo(parseInt(inputWidth),parseInt(leftTop-canvasTop+10)),cxt.lineTo(parseInt(rightLeft-canvasLeft),parseInt(rightTop-canvasTop+10)),cxt.stroke()}}else{var length=$("#formContent").find(".div_question").length,html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+data.list[y].sort+'</div><div class="form_id">'+data.list[y].id+'</div><div class="form_type">'+data.list[y].type+'</div><div class="form_score"></div><div class="form_info"></div><div class="div_title_question">连线题</div></div><div class="div_table_radio_question"><canvas id="canvas'+length+'" width="400" height="170" style="position: absolute;">Your browser does not support the HTML5 canvas tag.</canvas><div class="left_jia" style="padding-left:0px;width:30%;display:inline-block;position:relative;"></div><div class="right_jia" style="width:30%;display: inline-block;position:relative;"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;"><div style="height:35px"><button class="dan_delete" ng-click="atm_delete($event)" style="display: none;"><span class=""></span>删除</button><button class="cancel" style="display: none;"><span class=""></span>取消</button><button class="edit" style="display: none;"><span class=""></span>编辑</button></div><div class="edit_area" style="display:none"><div class="col-md-8"><canvas id="myCanvas'+length+'" width="400" height="170" style="position: absolute;">Your browser does not support the HTML5 canvas tag.</canvas><div class="attchment_left col-md-6" style="padding-left:0px"><input class="L0" ng-click="left($event)"><input class="L1" ng-click="left($event)"><input class="L2" ng-click="left($event)"></div><div class="attchment_right col-md-6"><div style="display: inline-block;" class="right_div"><input class="right" ng-click="right($event)"><div class="R0" style="display:none"></div></div><div style="display: inline-block;" class="right_div"><input class="right" ng-click="right($event)"><div class="R1" style="display:none"></div></div><div style="display: inline-block;" class="right_div"><input class="right" ng-click="right($event)"><div class="R2" style="display:none"></div></div></div><div class="col-md-12"><button ng-click="addAtm($event)">添加一项</button><button ng-click="atmBack($event)">重置</button></div></div><div class="col-md-4"><div class="col-md-12"><div style="height:26px;background-color:#6c0">题目：</div><textarea class="atm_title" style="background-color:#fff;width: 100%;height: 30px;"></textarea></div><div class="col-md-12"><div style="height:26px;background-color:#6c0">分数：</div><textarea class="atm_score" style="background-color:#fff;width: 100%;height: 80px;"></textarea></div></div><div class="col-md-12"><button class="attchment_confirm" ng-click="conAtm($event)">完成编辑</button></div></div></div></div>';0==length?$("div #question").after($compile(html)($scope)):$("div .div_question:last").after($compile(html)($scope))}var iptanswer=eval("("+data.list[y].iptanswer+")");for(m=0;m<iptanswer.length;m++)var leftClass=iptanswer[m].substring(0,2),rightClass=iptanswer[m].substr(2),canvasId=$(".div_question:last").find("canvas").eq(0).attr("id"),canvasTop=$(".div_question:last").find("canvas").eq(0).offset().top,canvasLeft=$(".div_question:last").find("canvas").eq(0).offset().left}else if(8==data.list[y].type){var form_ask_id=data.list[y].id,form_ask_sort=data.list[y].sort,form_ask_title=data.list[y].ipttitle,form_ask_type=data.list[y].type,form_ask_score=data.list[y].score,length=$("#formContent").find(".div_question").length;if(0==length){var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_ask_sort+'</div><div class="div_title_question">'+form_ask_title+'</div><div class="form_id">'+form_ask_id+'</div><div class="form_type">8</div><div class="form_score">'+form_ask_score+'</div><div class="form_answer"></div></div><div class="div_table_clear_top"></div><textarea class="write_area" disabled="true"></textarea><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="delete" ng-click="delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button><div class="ask_delete"></div></div><div class="edit_area" style="display:none"><div class="col-md-12"><div class="edit_title">题目标题</div><textarea class="write_title">'+form_ask_title+'</textarea></div><div class="col-md-12"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><textarea class="write_score">'+form_ask_score+'</textarea></div><div class="col-md-12"><button class="ask_confirm">确认</button></div></div></div>';$("div #question").after($compile(html)($scope))}else{var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_ask_sort+'</div><div class="div_title_question">'+form_ask_title+'</div><div class="form_id">'+form_ask_id+'</div><div class="form_type">8</div><div class="form_score">'+form_ask_score+'</div><div class="form_answer"></div></div><div class="div_table_clear_top"></div><textarea class="write_area" disabled="true"></textarea><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="delete" ng-click="delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button><div class="ask_delete"></div></div><div class="edit_area" style="display:none"><div class="col-md-12"><div class="edit_title">题目标题</div><textarea class="write_title">'+form_ask_title+'</textarea></div><div class="col-md-12"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><textarea class="write_score">'+form_ask_score+'</textarea></div><div class="col-md-12"><button class="ask_confirm">确认</button></div></div></div>';$("div .div_question:last").after($compile(html)($scope))}}else if(9==data.list[y].type){var form_name_id=data.list[y].id,form_name_type=data.list[y].type,form_name_sort=data.list[y].sort,form_name_title=data.list[y].ipttitle,str=eval("("+data.list[y].iptanswer+")");if("tests"==testFid&&""!=str)var str2=str[0].charCodeAt(0)-65;var length=$("#formContent").find(".div_question").length,html='<div class="div_question" style="border: 1px solid rgb(255, 255, 255); cursor: move;"><div class="div_title_question_all"><div class="div_topic_question">'+data.list[y].sort+'</div><div class="form_id">'+data.list[y].id+'</div><div class="form_type">'+data.list[y].type+'</div><div class="form_score"></div><div class="form_info"></div><div class="div_title_question">'+data.list[y].ipttitle+'</div></div><div class="div_table_radio_question"><div class="div_table_clear_top"></div><div class="del_all"><div><div class="circle"></div><div style="display:none" class="judge_opt">A</div><p style="display:inline-block">对</p></div><div><div class="circle"></div><div style="display:none" class="judge_opt">B</div><p style="display:inline-block">错</p></div></div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;"><div style="height:35px"><button class="dan_delete" ng-click="dan_delete($event)" style="display: none;"><span class=""></span>删除</button><button class="cancel" style="display: none;"><span class=""></span>取消</button><button class="edit" style="display: none;"><span class=""></span>编辑</button></div><div class="edit_area"><div class="p_title col-md-12"><p class="edit_title">标题</p><textarea class="edit_text">'+data.list[y].ipttitle+'</textarea></div><div class="col-md-12 col-xs-12"><button class="confirm">完成编辑</button></div></div></div></div>',html2='<div class="div_question" style="border: 1px solid rgb(255, 255, 255); cursor: move;"><div class="div_title_question_all"><div class="div_topic_question">'+data.list[y].sort+'</div><div class="form_id">'+data.list[y].id+'</div><div class="form_type">'+data.list[y].type+'</div><div class="form_score">'+data.list[y].score+'</div><div class="form_info">'+str[0]+'</div><div class="div_title_question">'+data.list[y].ipttitle+'</div></div><div class="div_table_radio_question"><div class="div_table_clear_top"></div><div class="del_all"><div><div class="circle"></div><div style="display:none" class="judge_opt">A</div><p style="display:inline-block">对</p></div><div><div class="circle"></div><div style="display:none" class="judge_opt">B</div><p style="display:inline-block">错</p></div></div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;"><div style="height:35px"><button class="dan_delete" ng-click="dan_delete($event)" style="display: none;"><span class=""></span>删除</button><button class="cancel" style="display: none;"><span class=""></span>取消</button><button class="edit" style="display: none;"><span class=""></span>编辑</button></div><div class="edit_area"><div class="p_title col-md-5"><p class="edit_title">标题</p><textarea class="edit_text">题目</textarea></div><div class="p_cont col-md-7"><div class="edit_opt">选项文字</div><div class="cont_opt"><p style="color:#666;display:none" class="judge_opt">A</p><input disabled="disabled" type="text" value="对" class="select_dan"><div class="dan_suan ng-scope">1</div><button class="rightAnswer ng-scope" ng-click="rightAnswer($event)">设置为正确答案</button></div><div class="cont_opt"><p style="color:#666;display:none" class="judge_opt">B</p><input disabled="disabled" type="text" value="错" class="select_dan"><div class="dan_suan ng-scope">2</div><button class="rightAnswer ng-scope" ng-click="rightAnswer($event)">设置为正确答案</button></div><div class="score"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><input value="'+data.list[y].score+'" class="edit_score"></div>\t</div><div class="col-md-12 col-xs-12"><button class="confirm">完成编辑</button></div></div></div></div>';0==length?"blank"==testFid?$("div #question").after($compile(html)($scope)):$("div #question").after($compile(html2)($scope)):"blank"==testFid?$("div .div_question:last").after($compile(html)($scope)):$("div .div_question:last").after($compile(html2)($scope)),"tests"==testFid&&$("div .div_question:last").find(".rightAnswer").eq(str2).css({"background-color":"#6c0",color:"#fff"})}else if(11==data.list[y].type||12==data.list[y].type||13==data.list[y].type||14==data.list[y].type||15==data.list[y].type){var form_name_id=data.list[y].id,form_name_type=data.list[y].type,form_name_sort=data.list[y].sort,form_name_title=data.list[y].ipttitle,length=$("#formContent").find(".div_question").length;if(0==length){var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_name_sort+'</div><div class="div_title_question">'+form_name_title+'</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title"></textarea></div><div class="col-md-12"><button id="confirm_all" class="free_confirm">完成编辑</button></div><div class="form_id">'+form_name_id+'</div><div class="form_type">'+form_name_type+"</div></div></div>";$("div #question").after($compile(html)($scope))}else{var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_name_sort+'</div><div class="div_title_question">'+form_name_title+'</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title"></textarea></div><div class="col-md-12"><button id="confirm_all" class="free_confirm">完成编辑</button></div><div class="form_id">'+form_name_id+'</div><div class="form_type">'+form_name_type+"</div></div></div>";$("div .div_question:last").after($compile(html)($scope))}}else if(16==data.list[y].type){var form_name_id=data.list[y].id,form_name_type=data.list[y].type,form_name_sort=data.list[y].sort,form_name_title=data.list[y].ipttitle,length=$("#formContent").find(".div_question").length;if(0==length){var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_name_sort+'</div><div class="div_title_question">'+form_name_title+'</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title"></textarea></div><div class="col-md-12"><button id="confirm_all" class="free_confirm">完成编辑</button></div><div class="form_id">'+form_name_id+'</div><div class="form_type">'+form_name_type+"</div></div></div>";$("div #question").after($compile(html)($scope))}else{var html='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+form_name_sort+'</div><div class="div_title_question">'+form_name_title+'</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title"></textarea></div><div class="col-md-12"><button id="confirm_all" class="free_confirm">完成编辑</button></div><div class="form_id">'+form_name_id+'</div><div class="form_type">'+form_name_type+"</div></div></div>";$("div .div_question:last").after($compile(html)($scope))}}}"tests"==testFid&&($("#pater_desc").after('<span id="total_score" style="display:none">'+data.score.total_score+"</span>"),$("#pater_desc").after('<span id="pass_score" style="display:none">'+data.score.pass_grade+"</span>"))}}}),$scope.closetitle=function(){return $(".edit_exam_bg").eq(0).animate({opacity:"0"},50),$("#titleSetWarm").animate({opacity:"0"},50),$(".edit_exam_bg").eq(0).css({display:"none"}),$("#titleSetWarm").css({display:"none"}),$scope.createTitle(),!1},$scope.get=function(){var t=$("#divId").length;return 0==t?($(".edit_exam_bg").eq(0).animate({opacity:"0.6"},50),$("#titleSetWarm").animate({opacity:"1"},50),$(".edit_exam_bg").eq(0).css({display:"block"}),$("#titleSetWarm").css({display:"block"}),!1):($scope.save(),$scope.href=$location.url(),$scope.fid=$scope.href.substr(12,$scope.href.length),$.ajax({type:"GET",url:PREFIX_HOST+"/index.php?c=form&a=publish&fid="+$scope.fid,success:function(t){}}),$location.path("form/view/"+$scope.fid),void 0)},$scope.save=function(){var href=window.location.hash,fid=href.substr(13,href.length),blankfid=href.substring(7,12),arr=[],form_title=$("#pater_title").text(),form_desc=$("#pater_desc").text(),title_id=$("#divId").find(".form_id").text(),title_type=$("#divId").find(".form_type").text(),desc_id=$("#divId p").text(),pass_score=$("#pass_score").text(),total_score=$("#total_score").text();""!=form_title&&$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+title_id,data:{type:"1",ipttitle:form_title},success:function(t){},error:function(t){}}),""!=form_desc&&$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+desc_id,data:{type:"2",ipttitle:form_desc},success:function(t){},error:function(t){}}),$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:{total_score:total_score,pass:pass_score},success:function(data){var data=eval("("+data+")")}});var type_len=$(".div_question").length;for(i=0;i<type_len;i++){var type=$(".div_question").eq(i).find(".form_type").eq(0).text();if(3==type){var opt_len=$(".div_question").eq(i).find(".del_all").children().length,info=$(".div_question").eq(i).find(".form_info").length,arr=[],arr2=[];if("blank"==blankfid)for(k=0;k<opt_len;k++){var opt=$(".div_question").eq(i).find(".del_all").children().eq(k).children().eq(1).text();arr.push(opt);var head=String.fromCharCode(65+k);arr2.push(head)}else{var x=$(".div_question").eq(i).find(".form_info").eq(0).text();for(arr2.push(x),k=0;k<opt_len;k++){var opt=$(".div_question").eq(i).find(".del_all").children().eq(k).children().eq(1).text();arr.push(opt)}}var sort=$(".div_question").eq(i).find(".div_topic_question").eq(0).text(),title=$(".div_question").eq(i).find(".div_title_question").eq(0).text(),title_score=$(".div_question").eq(i).find(".form_score").text(),id=$(".div_question").eq(i).find(".form_id").eq(0).text(),data={type:"3",ipttitle:title,info:arr,sort:sort,iptanswer:arr2,score:title_score};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+id,data:data,success:function(t){},error:function(t){}})}else if(4==type){var opt_len=$(".div_question").eq(i).find(".del_all").children().length,info=$(".div_question").eq(i).find(".form_info_dan").length,arr=[],arr2=[];if(0==info)for(k=0;k<opt_len;k++){var opt=$(".div_question").eq(i).find(".del_all").children().eq(k).children().eq(1).text();arr.push(opt);var head=String.fromCharCode(65+k);arr2.push(head)}else{var x=$(".div_question").eq(i).find(".form_info_dan").length;for(c=0;c<x;c++){var val=$(".div_question").eq(i).find(".form_info_dan").eq(c).text();arr2.push(val)}for(k=0;k<opt_len;k++){var opt=$(".div_question").eq(i).find(".del_all").children().eq(k).children().eq(1).text();arr.push(opt)}}var sort=$(".div_question").eq(i).find(".div_topic_question").eq(0).text(),title=$(".div_question").eq(i).find(".div_title_question").eq(0).text(),title_score=$(".div_question").eq(i).find(".form_score").text(),id=$(".div_question").eq(i).find(".form_id").eq(0).text(),data={type:"4",ipttitle:title,info:arr,sort:sort,iptanswer:arr2,score:title_score};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+id,data:data,success:function(t){},error:function(t){}})}else if(5==type){var id=$(".div_question").eq(i).find(".form_id").eq(0).text(),sort=$(".div_question").eq(i).find(".div_topic_question").eq(0).text(),title=$(".div_question").eq(i).find(".div_title_question").eq(0).text(),title_score=$(".div_question").eq(i).find(".form_score").text(),title_answer=[],tanswer=$(".div_question").eq(i).find(".form_answer").text();title_answer.push(tanswer);var data={type:"5",ipttitle:title,sort:sort,score:title_score,iptanswer:title_answer};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+id,data:data,success:function(t){},error:function(t){}})}else if(6==type||17==type){var arr=[],arr2=[],sort=$(".div_question").eq(i).find(".div_topic_question").eq(0).text(),title=$(".div_question").eq(i).find(".div_title_question").eq(0).text(),id=$(".div_question").eq(i).find(".form_id").eq(0).text(),opt_len=$(".div_question").eq(i).find(".opt_all").children().length;for(k=0;k<opt_len;k++){var opt=$(".div_question").eq(i).find(".opt_all").children().eq(k).children().eq(1).text();arr.push(opt);var head=String.fromCharCode(65+k);arr2.push(head)}var data={type:type,ipttitle:title,info:arr,sort:sort,iptanswer:arr2};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+id,data:data,success:function(t){},error:function(t){}})}else if(7==type){var sort=$(".div_question").eq(i).find(".div_topic_question").eq(0).text(),title=$(".div_question").eq(i).find(".div_title_question").eq(0).text(),id=$(".div_question").eq(i).find(".form_id").eq(0).text(),score=$(".div_question").eq(i).find(".form_score").text(),info=$(".div_question").eq(i).find(".form_info").text(),firstLetter=info.substring(0,1),atmInfo=[];if("["==firstLetter)info=eval("("+info+")"),atmInfo=info;else{var info=info.split(",");for(a=0;a<info.length;a++)atmInfo.push(info[a])}var leftData=[],rightData=[],leftData_len=$(".div_question").eq(i).find(".left_jia").eq(0).children("input").length,rightData_len=$(".div_question").eq(i).find(".right_jia").eq(0).children("input").length;for(l=0;l<leftData_len;l++){var leftClass=$(".div_question").eq(i).find(".left_jia").eq(0).children("input").eq(l).attr("class"),a=$(".div_question").eq(i).find(".left_jia").eq(0).children("input").eq(l).val();leftClass=leftClass.substring(0,2);var data="{"+leftClass+":"+a+"}";data=eval("("+data+")"),leftData.push(data)}for(r=0;r<rightData_len;r++){var rightClass=$(".div_question").eq(i).find(".right_jia").eq(0).children("input").eq(r).attr("class"),b=$(".div_question").eq(i).find(".right_jia").eq(0).children("input").eq(r).val();rightClass=rightClass.substring(0,2);var data="{"+rightClass+":"+b+"}";data=eval("("+data+")"),rightData.push(data)}leftData=JSON.stringify(leftData),rightData=JSON.stringify(rightData);var allData={left:leftData,right:rightData},data={type:"7",sort:sort,ipttitle:title,score:score,iptanswer:atmInfo,info:allData};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+id,data:data,success:function(data){var data=eval("("+data+")")}})}else if(8==type){var sort=$(".div_question").eq(i).find(".div_topic_question").eq(0).text(),title=$(".div_question").eq(i).find(".div_title_question").eq(0).text(),id=$(".div_question").eq(i).find(".form_id").eq(0).text(),title_score=$(".div_question").eq(i).find(".form_score").text(),title_answer=$(".div_question").eq(i).find(".form_answer").text(),data={type:"8",ipttitle:title,sort:sort,score:title_score};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+id,data:data,success:function(t){},error:function(t){}})}else if(9==type){var opt_len=$(".div_question").eq(i).find(".del_all").children().length,info=$(".div_question").eq(i).find(".form_info").length,arr=[],arr2=[];
if("blank"==blankfid)for(k=0;k<opt_len;k++){var opt=$(".div_question").eq(i).find(".del_all").children().eq(k).children().eq(1).text();arr.push(opt);var head=String.fromCharCode(65+k);arr2.push(head)}else{var x=$(".div_question").eq(i).find(".form_info").eq(0).text();for(arr2.push(x),k=0;k<opt_len;k++){var opt=$(".div_question").eq(i).find(".del_all").children().eq(k).children().eq(1).text();arr.push(opt)}}var sort=$(".div_question").eq(i).find(".div_topic_question").eq(0).text(),title=$(".div_question").eq(i).find(".div_title_question").eq(0).text(),title_score=$(".div_question").eq(i).find(".form_score").text(),id=$(".div_question").eq(i).find(".form_id").eq(0).text(),data={type:"9",ipttitle:title,info:arr,sort:sort,iptanswer:arr2,score:title_score};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+id,data:data,success:function(t){},error:function(t){}})}else if(11==type){var sort=$(".div_question").eq(i).find(".div_topic_question").eq(0).text(),title=$(".div_question").eq(i).find(".div_title_question").eq(0).text(),id=$(".div_question").eq(i).find(".form_id").eq(0).text(),data={type:"11",ipttitle:title,sort:sort};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+id,data:data,success:function(t){},error:function(t){}})}else if(12==type){var sort=$(".div_question").eq(i).find(".div_topic_question").eq(0).text(),title=$(".div_question").eq(i).find(".div_title_question").eq(0).text(),id=$(".div_question").eq(i).find(".form_id").eq(0).text(),data={type:"12",ipttitle:title,sort:sort};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+id,data:data,success:function(t){},error:function(t){}})}else if(13==type){var sort=$(".div_question").eq(i).find(".div_topic_question").eq(0).text(),title=$(".div_question").eq(i).find(".div_title_question").eq(0).text(),id=$(".div_question").eq(i).find(".form_id").eq(0).text(),data={type:"13",ipttitle:title,sort:sort};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+id,data:data,success:function(t){},error:function(t){}})}else if(14==type){var sort=$(".div_question").eq(i).find(".div_topic_question").eq(0).text(),title=$(".div_question").eq(i).find(".div_title_question").eq(0).text(),id=$(".div_question").eq(i).find(".form_id").eq(0).text(),data={type:"14",ipttitle:title,sort:sort};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+id,data:data,success:function(t){},error:function(t){}})}else if(15==type){var sort=$(".div_question").eq(i).find(".div_topic_question").eq(0).text(),title=$(".div_question").eq(i).find(".div_title_question").eq(0).text(),id=$(".div_question").eq(i).find(".form_id").eq(0).text(),data={type:"15",ipttitle:title,sort:sort};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+id,data:data,success:function(t){},error:function(t){}})}else if(16==type){var sort=$(".div_question").eq(i).find(".div_topic_question").eq(0).text(),title=$(".div_question").eq(i).find(".div_title_question").eq(0).text(),id=$(".div_question").eq(i).find(".form_id").eq(0).text(),data={type:"16",ipttitle:title,sort:sort};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid+"&id="+id,data:data,success:function(t){},error:function(t){}})}}$("#saveSuccess").css({display:"1",display:"block"}),$("#saveSuccess").attr("class","saveSuccesss"),setTimeout(function(){$("#saveSuccess").css({display:"0",display:"none"}),$("#saveSuccess").removeClass("saveSuccesss")},1e3)},$scope.createText=function(){var href=window.location.hash,fid=href.substr(13,href.length),number=$("#formContent").find(".div_question").length+1,data={type:"16",ipttitle:"自定义：",sort:number};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")");a(data.obj)}});var a=function(t){var e=$("#formContent").find(".div_question").length;if(0==e){var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">自定义：</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button></div><div class="edit_area"><div><p class="edit_title">题目标题</p><textarea class="write_title">自定义：</textarea></div><div><button class="free_confirm">确认</button></div><div class="form_id">'+t+'</div><div class="form_type">16</div></div></div>';$("div #question").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}else{var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">自定义：</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button></div><div class="edit_area"><div><p class="edit_title">题目标题</p><textarea class="write_title">自定义：</textarea></div><div><button class="free_confirm">确认</button></div><div class="form_id">'+t+'</div><div class="form_type">16</div></div></div>';$("div .div_question:last").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}};formService.toBottom()},$scope.createNumber=function(){var href=window.location.hash,fid=href.substr(13,href.length),number=$("#formContent").find(".div_question").length+1,data={type:"15",ipttitle:"员工编号：",sort:number};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")");a(data.obj)}});var a=function(t){var e=$("#formContent").find(".div_question").length;if(0==e){var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">员工编号：</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title">员工编号：</textarea></div><div class="col-md-12"><button class="number_confirm">确认</button></div><div class="form_id">'+t+'</div><div class="form_type">15</div></div></div>';$("div #question").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}else{var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">员工编号：</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title">员工编号：</textarea></div><div class="col-md-12"><button class="number_confirm">确认</button></div><div class="form_id">'+t+'</div><div class="form_type">15</div></div></div>';$("div .div_question:last").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}};formService.toBottom()},$("body").on("click",".number_confirm",function(){var t=window.location.hash,e=(t.substr(13,t.length),$(this).parent().parent().find(".write_title").eq(0).val());$(this).parent().parent().find(".form_id").eq(0).text();$(this).parent().parent().parent().children().children().eq(1).html(e),$(this).parent().parent().css("display","none")}),$scope.createEmail=function(){var href=window.location.hash,fid=href.substr(13,href.length),number=$("#formContent").find(".div_question").length+1,data={type:"14",ipttitle:"邮箱：",sort:number};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")");a(data.obj)}});var a=function(t){var e=$("#formContent").find(".div_question").length;if(0==e){var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">邮箱：</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title">邮箱：</textarea></div><div class="col-md-12"><button class="email_confirm">确认</button></div><div class="form_id">'+t+'</div><div class="form_type">14</div></div></div>';$("div #question").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}else{var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">邮箱：</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title">邮箱：</textarea></div><div class="col-md-12"><button class="email_confirm">确认</button></div><div class="form_id">'+t+'</div><div class="form_type">14</div></div></div>';$("div .div_question:last").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}};formService.toBottom()},$("body").on("click",".email_confirm",function(){var t=window.location.hash,e=(t.substr(13,t.length),$(this).parent().parent().find(".write_title").eq(0).val());$(this).parent().parent().find(".form_id").eq(0).text();$(this).parent().parent().parent().children().children().eq(1).html(e),$(this).parent().parent().css("display","none")}),$scope.createMobile=function(){var href=window.location.hash,fid=href.substr(13,href.length),number=$("#formContent").find(".div_question").length+1,data={type:"13",ipttitle:"电话号码：",sort:number};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")");a(data.obj)}});var a=function(t){var e=$("#formContent").find(".div_question").length;if(0==e){var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">电话号码：</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title">电话号码：</textarea></div><div class="col-md-12"><button class="mobile_confirm">确认</button></div><div class="form_id">'+t+'</div><div class="form_type">13</div></div></div>';$("div #question").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}else{var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">电话号码：</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title">电话号码：</textarea></div><div class="col-md-12"><button class="mobile_confirm">确认</button></div><div class="form_id">'+t+'</div><div class="form_type">13</div></div></div>';$("div .div_question:last").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}};formService.toBottom()},$("body").on("click",".mobile_confirm",function(){var t=window.location.hash,e=(t.substr(13,t.length),$(this).parent().parent().find(".write_title").eq(0).val());$(this).parent().parent().find(".form_id").eq(0).text();$(this).parent().parent().parent().children().children().eq(1).html(e),$(this).parent().parent().css("display","none")}),$scope.createDepartment=function(){var href=window.location.hash,fid=href.substr(13,href.length),number=$("#formContent").find(".div_question").length+1,data={type:"12",ipttitle:"部门：",sort:number};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")");a(data.obj)}});var a=function(t){var e=$("#formContent").find(".div_question").length;if(0==e){var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">部门：</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title">部门：</textarea></div><div class="col-md-12"><button class="depart_confirm">确认</button></div><div class="form_id">'+t+'</div><div class="form_type">12</div></div></div>';$("div #question").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}else{var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">部门：</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title">部门：</textarea></div><div class="col-md-12"><button class="depart_confirm">确认</button></div><div class="form_id">'+t+'</div><div class="form_type">12</div></div></div>';$("div .div_question:last").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}};formService.toBottom()},$("body").on("click",".depart_confirm",function(){var t=window.location.hash,e=(t.substr(13,t.length),$(this).parent().parent().find(".write_title").eq(0).val());$(this).parent().parent().find(".form_id").eq(0).text();$(this).parent().parent().parent().children().children().eq(1).html(e),$(this).parent().parent().css("display","none")}),$scope.createName=function(){var href=window.location.hash,fid=href.substr(13,href.length),number=$("#formContent").find(".div_question").length+1,data={type:"11",ipttitle:"你的姓名：",sort:number};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")");a(data.obj)}});var a=function(t){var e=$("#formContent").find(".div_question").length;if(0==e){var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">你的姓名：</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title">你的姓名：</textarea></div><div class="col-md-12"><button class="name_confirm">确认</button></div><div class="form_id">'+t+'</div><div class="form_type">11</div></div></div>';$("div #question").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}else{var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">你的姓名：</div></div><div class="div_table_clear_top"></div><input class="form_name" disabled="true"><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="name_delete" ng-click="name_delete($event)">删除</button></div><div class="edit_area" style="display:none"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title">你的姓名：</textarea></div><div class="col-md-12"><button class="name_confirm">确认</button></div><div class="form_id">'+t+'</div><div class="form_type">11</div></div></div>';$("div .div_question:last").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}};formService.toBottom()},$("body").on("click",".name_confirm",function(){var t=window.location.hash,e=(t.substr(13,t.length),$(this).parent().parent().find(".write_title").eq(0).val());$(this).parent().parent().find(".form_id").eq(0).text();$(this).parent().parent().parent().children().children().eq(1).html(e),$(this).parent().parent().css("display","none")}),$("body").on("mouseover",".form_submit",function(){$(this).css("border","1px solid #f53d05"),$(this).css("cursor","Pointer"),$(this).find(".submit_del").css("display","block")}),$("body").on("mouseout",".form_submit",function(){$(this).css("border","1px solid #fff"),$(this).find(".submit_del").css("display","none")}),$("body").on("click",".submit_del",function(){var id=$(this).parent().find(".form_id").eq(0).text();$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=del_form&del_id="+id,success:function(data){var data=eval("("+data+")")}}),$(this).parent().remove()}),$("body").on("click",".ask_confirm",function(){var t=$(this).parent().parent().children().eq(0).children().eq(1).val(),e=$(this).parent().parent().find(".write_score").val();$(this).parent().parent().parent().find(".form_score").html(e);$(this).parent().parent().parent().children().children().eq(1).html(t),$(this).parent().parent().css("display","none")}),$scope.dan_delete=function($event){var r=confirm("确定删除此题目？");if(1==r){var id=$($event.target).parent().parent().parent().children().children().eq(1).text();$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=del_form&del_id="+id,success:function(data){var data=eval("("+data+")");200==data.code&&$($event.target).parent().parent().parent().remove()},error:function(t){alert("系统出错")}}),$($event.target).parent().parent().parent().remove(),formService.sort()}},$scope.atm_delete=function($event){var r=confirm("确定删除此题目？");if(1==r){var id=$($event.target).closest(".div_question").find(".form_id").eq(0).text();$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=del_form&del_id="+id,success:function(data){var data=eval("("+data+")");200==data.code&&$($event.target).parent().parent().parent().remove()},error:function(t){alert("系统出错")}}),$($event.target).closest(".div_question").remove(),formService.sort()}},$scope.createAsk=function(element){var href=window.location.hash,fid=href.substr(13,href.length),number=$("#formContent").find(".div_question").length+1,data={type:"8",sort:number,ipttitle:"问答题："};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")");a(data.obj)}});var a=function(t){var e=$("#formContent").find(".div_question").length;if(0==e){var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">问答题</div><div class="form_id">'+t+'</div><div class="form_type">8</div><div class="form_score"></div><div class="form_answer"></div></div><div class="div_table_clear_top"></div><textarea class="write_area" disabled="true"></textarea><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="delete" ng-click="delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button><div class="ask_delete"></div></div><div class="edit_area"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title">问答题</textarea></div><div class="col-md-12 ask_score"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><textarea class="write_score"></textarea></div><div class="col-md-12"><button class="ask_confirm">确认</button></div></div></div>';$("div #question").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200),1==element&&$(".div_question").find(".ask_score").css("display","none")}else{var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">问答题</div><div class="form_id">'+t+'</div><div class="form_type">8</div><div class="form_score"></div><div class="form_answer"></div></div><div class="div_table_clear_top"></div><textarea class="write_area" disabled="true"></textarea><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="delete" ng-click="delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button><div class="ask_delete"></div></div><div class="edit_area"><div class="col-md-12"><p class="edit_title">题目标题</p><textarea class="write_title">问答题</textarea></div><div class="col-md-12 ask_score"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><textarea class="write_score"></textarea></div><div class="col-md-12"><button class="ask_confirm">确认</button></div></div></div>';$("div .div_question:last").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200),1==element&&$(".div_question").find(".ask_score").css("display","none")}};formService.toBottom()},$scope.closeVote=function(){$(".edit_exam_bg").animate({opacity:"0"},50),$("#edit_exam").animate({opacity:"0"},50),$(".edit_exam_bg").css("display","none"),$("#edit_exam").css("display","none")},$scope.voteSelect=function(type){$(".edit_exam_bg").animate({opacity:"0"},50),$("#edit_exam").animate({opacity:"0"},50),$(".edit_exam_bg").css("display","none"),$("#edit_exam").css("display","none");var href=window.location.hash,fid=href.substr(13,href.length),length=$("#formContent").find(".div_question").length,number=length+1,arr=["A","B","C","D","E"],vote_opt=["A.恒大集团","B.阿里巴巴","C.京东","D.苏宁易购","E.腾讯"],html="",html2="";for(i=0;i<vote_opt.length;i++){var htmls='<div><div class="circle"></div><div style="display:inline-block">'+vote_opt[i]+"</div></div>";html+=htmls}var data={type:type,ipttitle:"投票",info:vote_opt,sort:number,iptanswer:arr};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")");a(data.obj)}});var arr2=["A","B","C","D","E"],vote_opt2=["恒大集团","阿里巴巴","京东","苏宁易购","腾讯"];for(i=0;i<vote_opt2.length;i++){var htmls2='<div class="cont_opt"><p>'+arr2[i]+'</p>.<input type="text" value="'+vote_opt2[i]+'" class="select_dan"><button class="vote_delete_opt">删除</button></div>';html2+=htmls2}var a=function(t){if(0==length){var e='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">投票（投票）</div><div class="form_id">'+t+'</div><div class="form_type">'+type+'</div></div><div class="div_table_clear_top"></div><div class="opt_all">'+html+'</div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="vote_delete" ng-click="vote_delete($event)">删除</button><button class="vote_cancelEdit">取消</button><button class="vote_edit">编辑</button></div><div class="edit_area"><div class="p_title col-md-5"><p class="edit_title">题目标题</p><textarea class="edit_text">投票（投票）</textarea></div><div class="p_cont col-md-7"><div><p class="edit_opt">选项文字</p></div>'+html2+'</div><div><button class="vote_add_opt col-md-offset-7">添加选项</button></div><div class="col-md-12"><button class="vote_confirm">完成编辑</button></div></div></div>';$("div #question").after($compile(e)($scope));var i=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:i},200)}else{var e='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">投票（投票）</div><div class="form_id">'+t+'</div><div class="form_type">'+type+'</div></div><div class="div_table_clear_top"></div><div class="opt_all">'+html+'</div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="vote_delete" ng-click="vote_delete($event)">删除</button><button class="vote_cancelEdit">取消</button><button class="vote_edit">编辑</button></div><div class="edit_area"><div class="p_title col-md-5"><p class="edit_title">题目标题</p><textarea class="edit_text">投票（投票）</textarea></div><div class="p_cont col-md-7"><div><p class="edit_opt">选项文字</p></div>'+html2+'</div><div><button class="vote_add_opt col-md-offset-7">添加选项</button></div><div class="col-md-12"><button class="vote_confirm">完成编辑</button></div></div></div>';$("div .div_question:last").after($compile(e)($scope));var i=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:i},200)}};formService.toBottom()},$scope.createVote=function(){$(".edit_exam_bg").eq(0).css("display","block"),$("#edit_exam").css("display","block"),$(".edit_exam_bg").eq(0).animate({opacity:"0.6"},50),$("#edit_exam").animate({opacity:"1"},50),$("html, body").animate({scrollTop:0},200)},$("body").on("click",".vote_edit",function(){$(this).parent().parent().find(".edit_area").css("display","block")}),$("body").on("click",".vote_confirm",function(){var t=$(this).parent().parent().children().eq(0).children().eq(1).val(),e=[],a=$(this).parent().parent().find(".cont_opt").length;for(i=0;i<a;i++){var s=$(this).parent().parent().find(".cont_opt").eq(i).children().eq(0).text(),o=$(this).parent().parent().find(".cont_opt").eq(i).children().eq(1).val(),d=s+o;e.push(d);var l='<div><div class="circle"></div><p style="display:inline-block">'+e[i]+"</p></div>";if(n)var n=n+l;else var n=l}$(this).parent().parent().parent().find(".div_title_question").html(t),$(this).parent().parent().parent().children().eq(2).remove(),$(this).parent().parent().parent().children().eq(1).after('<div class="opt_all">'+n+"</div>"),$(this).parent().parent().css("display","none")}),$("body").on("click",".vote_delete_opt",function(){$(this).parent().removeClass();var t=$(this).parent().parent().find(".cont_opt").length;for(a=0;a<t;a++){var e=String.fromCharCode(65+a);$(this).parent().parent().children(".cont_opt").eq(a).find("p").html(e)}$(this).parent().remove()}),$("body").on("click",".vote_add_opt",function(){var t=$(this).parent().parent().find(".cont_opt").length,e=String.fromCharCode(65+t);$(this).parent().parent().find(".cont_opt:last").after('<div class="cont_opt"><p>'+e+'</p>.<input type="text" class="select_dan"><button class="vote_delete_opt">删除</button></div>')}),$("body").on("click",".vote_cancelEdit",function(){$(this).parent().parent().find(".edit_area").css("display","none")}),$("body").on("click",".write_confirm",function(){var t=$(this).parent().parent().find(".write_score").val(),e=$(this).parent().parent().find(".write_answer").val();if(""==t)return alert("未填写该题目分数"),!1;if(""==e)return alert("未选择正确答案"),!1;$(this).parent().parent().parent().find(".form_score").html(t),$(this).parent().parent().parent().find(".form_answer").html(e);var i=window.location.hash,a=(i.substr(13,i.length),$(this).parent().parent().parent().children().children().eq(2).text(),$(this).parent().parent().children().eq(0).children().eq(1).val());$(this).parent().parent().parent().children().children().eq(1).html(a),$(this).parent().parent().css("display","none")}),$scope.createWrite=function(element){var href=window.location.hash,fid=href.substr(13,href.length),number=$("#formContent").find(".div_question").length+1,data={type:"5",ipttitle:"填空题",sort:number};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")");a(data.obj)}});var a=function(t){var e=$("#formContent").find(".div_question").length;if(0==e)if(1==element){var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">填空题</div><div class="form_id">'+t+'</div><div class="form_type">5</div><div class="form_score"></div><div class="form_answer"></div></div><div class="div_table_clear_top"></div><textarea class="write_area" disabled="true"></textarea><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="write_delete" ng-click="write_delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button></div><div class="edit_area"><div class="col-md-12"><div class="edit_title">题目标题</div><textarea class="write_title edit_text">填空题</textarea></div><div class="col-md-12"><button class="write_confirm">完成编辑</button></div></div></div>';$("div #question").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}else{var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">填空题</div><div class="form_id">'+t+'</div><div class="form_type">5</div><div class="form_score"></div><div class="form_answer"></div></div><div class="div_table_clear_top"></div><textarea class="write_area" disabled="true"></textarea><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="write_delete" ng-click="write_delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button></div><div class="edit_area"><div class="col-md-5"><div class="edit_title">题目标题</div><textarea class="write_title edit_text">填空题</textarea><div class="write_score_none"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><textarea class="write_score"></textarea></div></div><div class="col-md-7" id="edit_survey"><div class="edit_opt">题目答案</div><textarea class="write_answer"></textarea></div><div class="col-md-12"><button class="write_confirm">完成编辑</button></div></div></div>';
$("div #question").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}else if(1==element){var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">填空题</div><div class="form_id">'+t+'</div><div class="form_type">5</div><div class="form_score"></div><div class="form_answer"></div></div><div class="div_table_clear_top"></div><textarea class="write_area" disabled="true"></textarea><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="write_delete" ng-click="write_delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button></div><div class="edit_area"><div class="col-md-12"><div class="edit_title">题目标题</div><textarea class="write_title edit_text">填空题</textarea></div><div class="col-md-12"><button class="write_confirm">完成编辑</button></div></div></div>';$("div .div_question:last").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}else{var i='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+number+'</div><div class="div_title_question">填空题</div><div class="form_id">'+t+'</div><div class="form_type">5</div><div class="form_score"></div><div class="form_answer"></div></div><div class="div_table_clear_top"></div><textarea class="write_area" disabled="true"></textarea><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="write_delete" ng-click="write_delete($event)">删除</button><button class="cancelEdit">取消</button><button class="edit">编辑</button></div><div class="edit_area"><div class="col-md-5"><div class="edit_title">题目标题</div><textarea class="write_title edit_text">填空题</textarea><div class="write_score_none"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><textarea class="write_score"></textarea></div></div><div class="col-md-7"><div class="edit_opt">题目答案</div><textarea class="write_answer"></textarea></div><div class="col-md-12"><button class="write_confirm">完成编辑</button></div></div></div>';$("div .div_question:last").after($compile(i)($scope));var a=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:a},200)}};formService.toBottom()},$("body").on("click",".cancelEdit",function(){$(this).parent().parent().find(".edit_area").css("display","none")}),$("body").on("click",".confirm",function(){var t=window.location.hash,e=t.substring(7,12);if("tests"==e){var a=$(this).parent().parent().find(".edit_score").val();if(""==a)return alert("未填写该题目分数"),!1;var s=$(this).parent().parent().find(".rightAnswer").length,o=0;for(y=0;y<s;y++){var d=$(this).parent().parent().find(".rightAnswer").eq(y).css("background-color");"rgb(102, 204, 0)"==d&&(o+=1)}if(0==o)return alert("未选择正确答案"),!1}var l=[],n=$(this).parent().parent().find(".p_title").children().eq(1).val(),r=$(this).parent().parent().find(".cont_opt").length;for(i=0;i<r;i++){var c=$(this).parent().parent().find(".cont_opt").eq(i).children().eq(0).text(),v=$(this).parent().parent().find(".cont_opt").eq(i).children().eq(1).val(),p=c+"."+v;l.push(p);var _='<div><div class="circle"></div><p style="display:inline-block">'+l[i]+"</p></div>";if(f)var f=f+_;else var f=_}var u=$(this).parent().parent().find(".score").children().eq(1).val();$(this).parent().parent().parent().parent().find(".form_score").html(u),$(this).parent().parent().parent().parent().find(".div_title_question").eq(0).children().remove(),$(this).parent().parent().parent().parent().find(".div_title_question").eq(0).html(n);var m=$(this).closest(".div_question").find(".form_type").text();if(9==m){var h=$(this).closest(".div_question").find(".circle").length;for(g=0;g<h;g++)$(this).closest(".div_question").find(".circle").eq(g).children().remove()}else $(this).parent().parent().parent().parent().find(".del_all").remove(),$(this).parent().parent().parent().parent().find(".div_table_clear_top").after('<div class="del_all">'+f+"</div>");$(this).parent().parent().parent().find(".edit_area").css("display","none");var b=$(this).parent().parent().find(".rightAnswer").length;for(x=0;x<b;x++){var q=$(this).parent().parent().find(".rightAnswer").eq(x).css("color");"rgb(255, 255, 255)"==q&&$(this).parent().parent().parent().parent().find(".circle").eq(x).html('<div class="selected"></div>')}}),$("body").on("click",".duo_confirm",function(){var t=window.location.hash,e=t.substring(7,12);if("tests"==e){var a=$(this).parent().parent().find(".edit_score").eq(0).val();if(""==a)return alert("还没设置题目分数"),!1;var s=$(this).parent().parent().find(".duoAnswer").length,o=0;for(y=0;y<s;y++){var d=$(this).parent().parent().find(".duoAnswer").eq(y).css("background-color");"rgb(102, 204, 0)"==d&&(o+=1)}if(0==o)return alert("未选择正确答案"),!1}var l=$(this).parent().parent().find(".score").children().eq(1).val();$(this).parent().parent().parent().parent().find(".form_score").html(l);var n=[],r=$(this).parent().parent().find(".p_title").children().eq(1).val(),c=$(this).parent().parent().find(".cont_opt").length;for(i=0;i<c;i++){var v=$(this).parent().parent().find(".cont_opt").eq(i).children().eq(0).text(),p=$(this).parent().parent().find(".cont_opt").eq(i).children().eq(1).val(),_=v+"."+p;n.push(_);var f='<div><div class="circle"></div><p style="display:inline-block">'+n[i]+"</p></div>";if(u)var u=u+f;else var u=f}$(this).parent().parent().parent().parent().find(".div_title_question").eq(0).children().remove(),$(this).parent().parent().parent().parent().find(".div_title_question").eq(0).html(r),$(this).parent().parent().parent().parent().find(".del_all").remove(),$(this).parent().parent().parent().parent().find(".div_table_clear_top").after('<div class="del_all">'+u+"</div>"),$(this).parent().parent().parent().find(".edit_area").css("display","none");var m=$(this).parent().parent().find(".duoAnswer").length;for(x=0;x<m;x++){var h=$(this).parent().parent().find(".duoAnswer").eq(x).css("color");"rgb(255, 255, 255)"==h&&$(this).parent().parent().parent().parent().find(".circle").eq(x).html('<div class="selected"></div>')}}),$("body").on("click",".edit",function(){$(this).parent().parent().find(".edit_area").css("display","block")}),$("body").on("mouseover",".div_question",function(){$(this).css("border","1px solid #fc741f"),$(this).css("cursor","move"),$(this).find(".addSelect").css("display","block"),$(this).find(".edit").css("display","inline-block"),$(this).find(".delete").css("display","inline-block"),$(this).find(".dan_delete").css("display","inline-block"),$(this).find(".cancelEdit").css("display","inline-block"),$(this).find(".vote_cancelEdit").css("display","inline-block"),$(this).find(".cancel").css("display","inline-block"),$(this).find(".vote_edit").css("display","inline-block"),$(this).find(".vote_delete").css("display","inline-block"),$(this).find(".write_delete").css("display","inline-block"),$(this).find(".name_delete").css("display","inline-block")}),$("body").on("mouseout",".div_question",function(){$(this).css("border","1px solid #fff"),$(this).find(".addSelect").css("display","none"),$(this).find(".edit").css("display","none"),$(this).find(".delete").css("display","none"),$(this).find(".dan_delete").css("display","none"),$(this).find(".cancel").css("display","none"),$(this).find(".vote_edit").css("display","none"),$(this).find(".vote_delete").css("display","none"),$(this).find(".write_delete").css("display","none"),$(this).find(".name_delete").css("display","none"),$(this).find(".cancelEdit").css("display","none"),$(this).find(".vote_cancelEdit").css("display","none")}),$(function(){$("#formContent").sortable({cursor:"move",opacity:.6,update:function(t,e){var a=$("#formContent").find(".div_question").length;for(i=0;i<a;i++){var s=i+1;$("#formContent").find(".div_question").eq(i).find(".div_topic_question").eq(0).html(s)}}}),$("#formContent").disableSelection()}),$("body").on("click",".cancel",function(){$(this).parent().parent().find(".edit_area").css("display","none")}),$scope.createRadioButtonList=function(type,test){var href=window.location.hash,fid=href.substr(13,href.length),length=$("#formContent").find(".div_question").length,lengths=length+1;if("3"==type){var arr=["A.选项1","B.选项2","C.选项3"],answer=["A","B","C"];if(1==test)var data={type:"3",ipttitle:"题目",info:arr,sort:lengths};else var data={type:"3",ipttitle:"题目",info:arr,sort:lengths,iptanswer:answer};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")"),id=data.obj,type="4";a(id,type)}})}else if("4"==type){var arr=["A.选项1","B.选项2","C.选项3"],answer=["A","B","C"];if(1==test)var data={type:"4",ipttitle:"题目",info:arr,sort:lengths};else var data={type:"4",ipttitle:"题目",info:arr,sort:lengths,iptanswer:answer};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")"),id=data.obj,type="4";a(id,type)}})}var a=function(t,i){if(3==type){if(0==length){var a='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+lengths+'</div><div class="form_id">'+t+'</div><div class="form_type">3</div><div class="form_score"></div><div class="div_title_question">题目</div></div><div class="div_table_radio_question"><div class="div_table_clear_top"></div><div class="del_all"><div><div class="circle"></div><p style="display:inline-block">A.选项1</p></div><div><div class="circle"></div><p style="display:inline-block">B.选项2</p></div><div><div class="circle"></div><p style="display:inline-block">C.选项3</p></div></div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="dan_delete" ng-click="dan_delete($event)"><span class=""></span>删除</button><button class="cancel"><span class=""></span>取消</button><button class="edit"><span class=""></span>编辑</button></div><div class="edit_area"><div class="p_title col-md-5"><p class="edit_title">标题</p><textarea class="edit_text">题目</textarea><div class="score"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><input class="edit_score"></div></div><div class="p_cont col-md-7"><div class="edit_opt">选项文字</div><div class="cont_opt"><p style="color:#666">A</p>.<input type="text" value="选项1" class="select_dan"><button class="delete_opt" ng-click="delete_opt($event)">删除</button></div><div class="cont_opt"><p style="color:#666">B</p>.<input type="text" value="选项2" class="select_dan"><button class="delete_opt" ng-click="delete_opt($event)">删除</button></div><div class="cont_opt"><p style="color:#666">C</p>.<input type="text" value="选项3" class="select_dan"><button class="delete_opt" ng-click="delete_opt($event)">删除</button></div><button class="add_opt" ng-click="asd($event)">添加选项</button></div><div class="col-md-12 col-xs-12"><button class="confirm">完成编辑</button></div></div></div></div>';if($("div #question").after($compile(a)($scope)),1==test){$("div .div_question:last").find(".form_score").after('<div class="form_info"></div>');var s=$("div .div_question:last").find(".delete_opt").length;for(e=0;e<s;e++){var o=e+1,a='<div class="dan_suan">'+o+'</div><button class="rightAnswer" ng-click="rightAnswer($event)">设置为正确答案</button>';$("div .div_question:last").find(".delete_opt").eq(e).after($compile(a)($scope))}}else $("div .div_question:last").find(".score").css("display","none");var d=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:d},200)}else{var a='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+lengths+'</div><div class="form_id">'+t+'</div><div class="form_type">3</div><div class="form_score"></div><div class="div_title_question">题目</div></div><div class="div_table_radio_question"><div class="div_table_clear_top"></div><div class="del_all"><div><div class="circle"></div><p style="display:inline-block">A.选项1</p></div><div><div class="circle"></div><p style="display:inline-block">B.选项2</p></div><div><div class="circle"></div><p style="display:inline-block">C.选项3</p></div></div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="dan_delete" ng-click="dan_delete($event)"><span class=""></span>删除</button><button class="cancel"><span class=""></span>取消</button><button class="edit"><span class=""></span>编辑</button></div><div class="edit_area"><div class="p_title col-md-5"><p class="edit_title">标题</p><textarea class="edit_text">题目</textarea><div class="score"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><input class="edit_score"></div></div><div class="p_cont col-md-7"><div class="edit_opt">选项文字</div><div class="cont_opt"><p style="color:#666">A</p>.<input type="text" value="选项1" class="select_dan"><button class="delete_opt" ng-click="delete_opt($event)">删除</button></div><div class="cont_opt"><p style="color:#666">B</p>.<input type="text" value="选项2" class="select_dan"><button class="delete_opt" ng-click="delete_opt($event)">删除</button></div><div class="cont_opt"><p style="color:#666">C</p>.<input type="text" value="选项3" class="select_dan"><button class="delete_opt" ng-click="delete_opt($event)">删除</button></div><button class="add_opt" ng-click="asd($event)">添加选项</button></div><div class="col-md-12 col-xs-12"><button class="confirm">完成编辑</button></div></div></div></div>';if($("div .div_question:last").after($compile(a)($scope)),1==test){$("div .div_question:last").find(".form_score").after('<div class="form_info"></div>');var s=$("div .div_question:last").find(".delete_opt").length;for(e=0;e<s;e++){var o=e+1,a='<div class="dan_suan">'+o+'</div><button class="rightAnswer" ng-click="rightAnswer($event)">设置为正确答案</button>';$("div .div_question:last").find(".delete_opt").eq(e).after($compile(a)($scope))}}else $("div .div_question:last").find(".score").css("display","none")}var d=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:d},200)}else if(4==type)if(0==length){var a='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+lengths+'</div><div class="form_id">'+t+'</div><div class="form_type">4</div><div class="form_score"></div><div class="div_title_question">题目</div><div class="duo" style="display: inline-block;color: red;">【多选题】</div></div><div class="div_table_radio_question"><div class="div_table_clear_top"></div><div class="del_all"><div><div class="circle"></div><p style="display:inline-block">A.选项1</p></div><div><div class="circle"></div><p style="display:inline-block">B.选项2</p></div><div><div class="circle"></div><p style="display:inline-block">C.选项3</p></div></div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="dan_delete" ng-click="dan_delete($event)"><span class=""></span>删除</button><button class="cancel"><span class=""></span>取消</button><button class="edit"><span class=""></span>编辑</button></div><div class="edit_area"><div class="p_title col-md-5"><p class="edit_title">标题</p><textarea class="edit_text">题目</textarea><div class="score"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><input class="edit_score"></div></div><div class="p_cont col-md-7"><div class="edit_opt">选项文字</div><div class="cont_opt"><p style="color:#666">A</p>.<input type="text" value="选项1" class="select_dan"><button class="delete_opt" ng-click="delete_opt($event)">删除</button></div><div class="cont_opt"><p style="color:#666">B</p>.<input type="text" value="选项2" class="select_dan"><button class="delete_opt" ng-click="delete_opt($event)">删除</button></div><div class="cont_opt"><p style="color:#666">C</p>.<input type="text" value="选项3" class="select_dan"><button class="delete_opt" ng-click="delete_opt($event)">删除</button></div><button class="add_opt" ng-click="asd($event)">添加选项</button></div><div class="col-md-12 col-xs-12"><button class="duo_confirm">完成编辑</button></div></div></div></div>';if($("div #question").after($compile(a)($scope)),1==test){$("div .div_question:last").find(".form_score").after('<div class="form_info"></div>');var s=($("div .div_question:last").find(".delete_opt").length,$("div .div_question:last").find(".delete_opt").length);for(e=0;e<s;e++){var o=e+1,a='<div class="dan_suan">'+o+'</div><button class="duoAnswer" ng-click="duoAnswer($event)">设置为正确答案</button>';$("div .div_question:last").find(".delete_opt").eq(e).after($compile(a)($scope))}}else $("div .div_question:last").find(".score").css("display","none");var d=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:d},200)}else{var a='<div class="div_question"><div class="div_title_question_all"><div class="div_topic_question">'+lengths+'</div><div class="form_id">'+t+'</div><div class="form_type">4</div><div class="form_score"></div><div class="div_title_question">题目</div><div class="duo" style="display: inline-block;color: red;">【多选题】</div></div><div class="div_table_radio_question"><div class="div_table_clear_top"></div><div class="del_all"><div><div class="circle"></div><p style="display:inline-block">A.选项1</p></div><div><div class="circle"></div><p style="display:inline-block">B.选项2</p></div><div><div class="circle"></div><p style="display:inline-block">C.选项3</p></div></div><div class="div_table_clear_bottom"></div><hr style="height:1px;border:none;border-top:1px solid #e6e6e6;margin-bottom:0px;" /><div style="height:35px"><button class="dan_delete" ng-click="dan_delete($event)"><span class=""></span>删除</button><button class="cancel"><span class=""></span>取消</button><button class="edit"><span class=""></span>编辑</button></div><div class="edit_area"><div class="p_title col-md-5"><p class="edit_title">标题</p><textarea class="edit_text">题目</textarea><div class="score"><div style="display:inline-block;color:#666;position: relative;top: 3px;">题目分数：</div><input class="edit_score"></div></div><div class="p_cont col-md-7"><div class="edit_opt">选项文字</div><div class="cont_opt"><p style="color:#666">A</p>.<input type="text" value="选项1" class="select_dan"><button class="delete_opt" ng-click="delete_opt($event)">删除</button></div><div class="cont_opt"><p style="color:#666">B</p>.<input type="text" value="选项2" class="select_dan"><button class="delete_opt" ng-click="delete_opt($event)">删除</button></div><div class="cont_opt"><p style="color:#666">C</p>.<input type="text" value="选项3" class="select_dan"><button class="delete_opt" ng-click="delete_opt($event)">删除</button></div><button class="add_opt" ng-click="asd($event)">添加选项</button></div><div class="col-md-12 col-xs-12"><button class="duo_confirm">完成编辑</button></div></div></div></div>';if($("div .div_question:last").after($compile(a)($scope)),1==test){$("div .div_question:last").find(".form_score").after('<div class="form_info"></div>');var s=($("div .div_question:last").find(".delete_opt").length,$("div .div_question:last").find(".delete_opt").length);for(e=0;e<s;e++){var o=e+1,a='<div class="dan_suan">'+o+'</div><button class="duoAnswer" ng-click="duoAnswer($event)">设置为正确答案</button>';$("div .div_question:last").find(".delete_opt").eq(e).after($compile(a)($scope))}}else $("div .div_question:last").find(".score").css("display","none");var d=$(document).height()-$(window).height()-24;$("html, body").animate({scrollTop:d},200)}};formService.toBottom()},$scope.rightAnswer=function(t){var e=$(t.target).parent().parent().find(".rightAnswer").length;for(i=0;i<e;i++)$(t.target).parent().parent().find(".rightAnswer").eq(i).css("color",""),$(t.target).parent().parent().find(".rightAnswer").eq(i).css("background-color","#fff");$(t.target).css("color","#fff"),$(t.target).css("background-color","#6c0");var a=$(t.target).parent().children().eq(0).text();$(t.target).parent().parent().parent().parent().parent().find(".form_info").html(a)},$scope.duoAnswer=function(t){$(t.target).parent().parent().parent().parent().parent().find(".form_info").html("");var e=$(t.target).css("color");"rgb(255, 255, 255)"==e?($(t.target).css("color",""),$(t.target).css("background-color","#fff")):($(t.target).css("color","#fff"),$(t.target).css("background-color","#6c0"));var a=$(t.target).parent().parent().find(".cont_opt").length,s="";for(i=0;i<a;i++){var e=$(t.target).parent().parent().children(".cont_opt").eq(i).find(".duoAnswer").css("color");if("rgb(255, 255, 255)"==e){var o=String.fromCharCode(65+i),d='<div class="form_info_dan">'+o+"</div>";s+=d}}$(t.target).parent().parent().parent().parent().parent().find(".form_info_dan").remove(),$(t.target).parent().parent().parent().parent().parent().find(".form_info").after(s)}}]),angular.module("aaaaa",[]).controller("createNameCtrl",function($scope,$modal){$scope.formType=1,$scope.createForm=function(){$location.path("/form")},document.onkeydown=function(){if(e=event?event:window.event?window.event:null,13==e.keyCode){var href=window.location.hash,fid=href.substr(13,href.length);$scope.title=document.getElementById("nameInput").value,$scope.desc=document.getElementById("descInput").value;var data={type:"1",ipttitle:$scope.title,iptval:$scope.desc};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")");$("#question").html('<div id="divId"><h1 id="pater_title" style="color:#f53d05">'+$scope.title+'</h1><div id="pater_desc">'+$scope.desc+'</div><hr style="height:1px;border:none;border-top:1px dashed #c1c1c1;" /><div class="form_id">'+data.obj+'</div><div class="form_type">1</div></div>'),document.getElementById("divId").addEventListener("mouseover",function(){$("#question").css("border","1px solid #f53d05"),$("#question").css("cursor","Pointer")}),document.getElementById("divId").addEventListener("click",function(){$modal.open({windowClass:"console six-contain",templateUrl:BASE_URL+"templates/form/create_name.html",controller:"createNameCtrl2",files:["controllers/formController"]})}),document.getElementById("divId").addEventListener("mouseout",function(){$("#question").css("border","1px solid #fff"),$("#question").css("cursor","")})}}),$scope.$dismiss()}},$scope.cancel=function(){$scope.$dismiss()},$scope.getPater=function(){var href=window.location.hash,fid=href.substr(13,href.length);if($scope.title=document.getElementById("nameInput").value,$scope.desc=document.getElementById("descInput").value,$scope.zongfen=$("#zongfen_form").val(),$scope.pass=$("#pass_form").val(),""==$scope.title)return alert("未填写标题！~"),!1;var data={type:"1",ipttitle:$scope.title},data2={type:"2",ipttitle:$scope.desc};$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:{total_score:$scope.zongfen,pass:$scope.pass},success:function(data){var data=eval("("+data+")")}}),$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data,success:function(data){var data=eval("("+data+")");$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:data2,success:function(data){var data2=eval("("+data+")");$("#question").html('<div id="divId"><h1 id="pater_title" style="color:#f53d05">'+$scope.title+'</h1><div id="pater_desc"></div><hr style="height:1px;border:none;border-top:1px dashed #c1c1c1;margin-bottom:0px" /><div class="form_id">'+data.obj+'</div><div class="form_type">1</div></div>'),document.getElementById("divId").addEventListener("mouseover",function(){$("#question").css("border","1px solid #f53d05"),$("#question").css("cursor","Pointer")}),document.getElementById("divId").addEventListener("click",function(){$modal.open({windowClass:"console six-contain",templateUrl:BASE_URL+"templates/form/create_name.html",controller:"createNameCtrl2",files:["controllers/formController"]})}),document.getElementById("divId").addEventListener("mouseout",function(){$("#question").css("border","1px solid #fff"),$("#question").css("cursor","")}),$("#pater_desc").html($scope.desc),$("#pater_desc").after('<p style="display:none">'+data2.obj+"</p>"),$("#pater_desc").after('<span id="total_score" style="display:none">'+$scope.zongfen+"</span>"),$("#pater_desc").after('<span id="pass_score" style="display:none">'+$scope.pass+"</span>")}})}}),$scope.$dismiss()}}),angular.module("createname",[]).controller("createNameCtrl2",["$scope",function($scope){$scope.formType=1,$scope.createForm=function(){$location.path("/form")},document.onkeydown=function(){if(e=event?event:window.event?window.event:null,13==e.keyCode){var t=window.location.hash;t.substr(13,t.length),$("#question").find(".form_id").eq(0).text();$scope.title=$("#nameInput").val(),$scope.dec=$("#descInput").val(),$scope.data={type:"1",ipttitle:$scope.title,iptval:$scope.dec},$("#pater_title").html($scope.title),$("#pater_desc").html($scope.dec),$scope.$dismiss()}},setTimeout(function(){var t=$("#pater_title").text(),e=$("#pater_desc").text();$("#nameInput").val(t),$("#descInput").val(e);var i=$("#total_score").text();$scope.pass_score=$("#pass_score").text(),$("#zongfen_form").val(i),$("#pass_form").val($scope.pass_score)},0),$scope.getPater=function(){var href=window.location.hash,fid=href.substr(13,href.length),id=$("#question").find(".form_id").eq(0).text();return $scope.title=$("#nameInput").val(),$scope.dec=$("#descInput").val(),$scope.zongfen=$("#zongfen_form").val(),$scope.pass=$("#pass_form").val(),$("#total_score").html($scope.zongfen),$("#pass_score").html($scope.pass),$.ajax({type:"POST",url:PREFIX_HOST+"/index.php?c=form&a=create&fid="+fid,data:{total_score:$scope.zongfen,pass:$scope.pass},success:function(data){var data=eval("("+data+")")}}),""==$scope.title?(alert("未填写标题！~"),!1):($("#pater_title").html($scope.title),$("#pater_desc").html($scope.dec),void $scope.$dismiss())},$scope.cancel=function(){$scope.$dismiss()},$scope.cancel=function(){$scope.$dismiss()}}]),angular.module("toBottom",[]).service("formService",["$rootScope","$location",function(t,e){var a=function(){},s=function(){var t=$("#formContent").find(".div_topic_question").length;for(i=0;i<t;i++){var e=i+1;$("#formContent").find(".div_topic_question").eq(i).html(e)}},o=function(){e.path("form/myForm")},d=function(){e.path("form/myTest")},l={toBottom:a,sort:s,myForm:o,myTest:d};return l}]);