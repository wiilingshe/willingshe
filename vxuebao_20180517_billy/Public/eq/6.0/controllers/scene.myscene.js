angular.module("scenePreview",["services.scene","services.mine","services.data","scene.create.console","app.directives.addelement","services.usercenter","app.directives.qrcode","services.i18nNotifications"]),angular.module("scenePreview").controller("MySceneCtrl",["$location","$rootScope","$scope","$stateParams","$modal","usercenterService","ModalService","sceneService","security","$sce",function(e,c,s,r,n,a,t,i,d,o){s.loading=!1,s.sceneId=r.sceneId,s.iframeUrl=o.trustAsResourceUrl(PREFIX_URL+"index.php?c=view&id="+s.sceneId+".html?preview=myscene"),s.tpl=c.tplObj,s.userXd=0,a.getUserXd().then(function(e){s.userXd=e.data.obj||0}),c.backurl?s.backurl=c.backurl:s.backurl="#/main",i.getSceneDetail(s.sceneId).then(function(e){e.data.success&&(e.data.obj.createUser==d.currentUser.id?s.isTpl=!1:s.isTpl=!0,s.scene=e.data.obj,c.user&&c.user.domain?(s.url=c.user.domain+"/v-"+s.scene.code,s.canvasUrl="http://"+s.url):(s.url=PREFIX_HOST+"/v-"+s.scene.code,s.canvasUrl=s.url))}),s.editScene=function(){e.path("scene/create/"+s.sceneId).search("pageId",1)},s.setSceneInfo=function(){e.path("scene/create/"+s.sceneId).search("pageId",1).search("openSetting","show")},s.moreShareWay=function(){e.path("spread/share/"+s.sceneId+"/socialShare")},s.userTpl=function(){e.path("/scene"),c.tplId=s.scene};var l,u;document.getElementById("sharescript")?($("#sharescript").remove(),l=document.getElementsByTagName("head")[0],u=document.createElement("script"),u.id="sharescript",u.src="http://bdimg.share.baidu.com/static/api/js/share.js?cdnversion="+~(-new Date/36e5),l.appendChild(u)):(l=document.getElementsByTagName("head")[0],u=document.createElement("script"),u.id="sharescript",u.src="http://bdimg.share.baidu.com/static/api/js/share.js?cdnversion="+~(-new Date/36e5),l.appendChild(u)),window._bd_share_config={common:{bdText:"aa",bdDesc:"aa",bdUrl:"aa",bdSign:"on",bdSnsKey:{}},share:[{bdSize:32}],slide:[{bdImg:0,bdPos:"right",bdTop:100}]},s.scrollPage=function(e){c.$broadcast("scene.page.scroll",e)}}]).directive("ctrlPageScroll",function(){function e(e,c,s){e.$on("scene.page.scroll",function(e,c){var s=$("iframe").get(0).contentWindow;c?s.eqxiu.nextPage():s.eqxiu.prePage()})}return{restrict:"EA",link:e}});