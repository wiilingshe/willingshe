angular.module("scene.create.new",["services.scene","services.staticRes"]),angular.module("scene.create.new").controller("SceneNewCtrl",["$scope","$location","$translate","sceneService","items","ModalService","staticResService",function(e,a,n,c,t,s,p){if(e.scene={name:""},e.scene.types=p.getSceneType(),t.tpl){var l=!0;angular.forEach(e.scene.types,function(a,n){if(l){var c=""+t.tpl.type;a.value===c?(e.scene.type=a,l=!1):e.scene.type=e.scene.types[0]}})}else e.scene.type=e.scene.types[0];var i=0;e.create=function(){if(3==t.fileType)i=1,c.createBlankScene(null,e.scene.type.value,e.scene.pageMode.id,i).then(function(e){200==e.data.code?(a.path("scene/create/"+e.data.obj+"/"+i),a.search("pageId",1)):s.openMsgDialog({msg:e.data.msg,btn:"确定"})});else if(0==t.fileType)i=0,c.createBlankScene(null,e.scene.type.value,e.scene.pageMode.id,i).then(function(e){200==e.data.code?(a.path("scene/create/"+e.data.obj),a.search("pageId",1)):s.openMsgDialog({msg:e.data.msg,btn:"确定"})});else if(1==t.fileType){var n={id:t.tpl.id,type:e.scene.type.value,pageMode:e.scene.pageMode.id,price:t.tpl.price};c.createByTpl(n).then(function(e){200==e.data.code?(a.path("scene/create/"+e.data.obj),a.search("pageId",1)):s.openMsgDialog({msg:e.data.msg})},function(e){})}else c.createBlankScene(null,e.scene.type.value,e.scene.pageMode.id).then(function(e){a.path("scene/create/"+e.data.obj),a.search("pageId",1)});e.$close()},e.cancel=function(){e.$dismiss()},e.pagemodes=[{id:2,name:"上下翻页"},{id:1,name:"左右翻页"}],e.scene.pageMode=e.pagemodes[0]}]);