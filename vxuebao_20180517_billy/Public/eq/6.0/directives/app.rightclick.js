angular.module("app.directives.rightclick",[]).directive("rightClick",["$compile",function(e){return{restrict:"EA",link:function(t,i,a){var n;$(i).on("contextmenu",function(a){if(a.preventDefault(),n&&n[0]&&n.remove(),"0"==t.categoryId){n=$('<ul class="right-menu dropdown-menu"></ul>'),n.appendTo($(i)),n.css({left:a.pageX-$(i).offset().left,top:a.pageY-$(i).offset().top}).show();for(var o in t.myTags){var l='<li class="tag_list" ng-class="{selected: dropTagIndex == '+o+'}" ng-click="selectTag('+t.myTags[o].id+","+o+')">'+t.myTags[o].name+"</li>",c=e(l)(t);n.append(c)}var p=e('<li class="tag_list add_cate clearfix" style="border-top:1px solid #ccc;margin-bottom:0px;" ng-click="createCategory()"><em>+</em><span>创建分类</span></li>')(t);n.append(p);var s=e('<li class="btn-main" style="width:100%; padding:0px; border: 0;margin:0px;height:25px; line-height:25px;"><a style="height:25px;line-height:25px;text-indent:0;color:#FFF;padding:0px;text-align:center;" ng-click="setCategory('+t.dropTagIndex+","+t.img.id+')">确定</a></li>')(t);n.append(s),$(s).on("click",function(){n.hide()}),$(document).mousemove(function(e){(e.pageX<n.offset().left-20||e.pageX>n.offset().left+n.width()+20||e.pageY<n.offset().top-20||e.pageY>n.offset().top+n.height()+20)&&(n.hide(),$(this).unbind("mousemove"))})}})}}}]);