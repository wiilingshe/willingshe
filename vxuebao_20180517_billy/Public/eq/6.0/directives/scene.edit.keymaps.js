!function(){function e(e,t,o,n){function r(o,r,a,d){var l=$(document);o.$on("$destroy",function(){l.unbind("keydown")});var i,y={deltaX:0,deltaY:0};l.unbind("keydown").keydown(function(r){if(8==r.keyCode||46==r.keyCode){if($(".modal-dialog").length||$("#pageList").find("input").is(":focus"))return;n.getElements().length&&(r.preventDefault(),e.$broadcast("element.delete"))}if((37==r.keyCode||38==r.keyCode||39==r.keyCode||40==r.keyCode)&&(n.getElements().length&&r.preventDefault(),i||(i=!0,d.compDragStart(y)),37==r.keyCode&&(y.deltaX-=1,d.compDragMove(y)),38==r.keyCode&&(y.deltaY-=1,d.compDragMove(y)),39==r.keyCode&&(y.deltaX+=1,d.compDragMove(y)),40==r.keyCode&&(y.deltaY+=1,d.compDragMove(y))),(r.ctrlKey||r.metaKey)&&65==r.keyCode){if($(".modal-dialog").length)return;if(r.preventDefault(),i)return;i=!0,e.$broadcast("element.selectall")}if((r.ctrlKey||r.metaKey)&&90==r.keyCode&&t.historyBack(),(r.ctrlKey||r.metaKey)&&89==r.keyCode&&t.historyForward(),(r.ctrlKey||r.metaKey)&&67==r.keyCode){if($(".modal-dialog").length)return;t.copyElement()}if((r.ctrlKey||r.metaKey)&&86==r.keyCode){if($(".modal-dialog").length)return;t.getCopy()&&t.pasteElement()}o.$apply()}).unbind("keyup").keyup(function(e){i=!1,(y.deltaX||y.deltaY)&&d.compDragEnd(y),y.deltaX=0,y.deltaY=0,o.$apply()})}return{restrict:"A",link:r,require:"^multiCompDrag"}}angular.module("scene.edit.keymap",["services.scene","services.history","services.select"]).directive("editKeymap",["$rootScope","sceneService","historyService","selectService",e])}();