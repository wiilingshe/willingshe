angular.module("app.directives.addelement",[]).directive("addElement",["$compile",function(e){return{restrict:"EA",link:function(t,i,n){var r=$("#emailAddress"),a=$("#emailAddress").size()+1;i.bind("click",function(){var i=angular.element('<div><input type="text" id="p_scnt" style="width:100%; height: 30px; margin-top: 15px;" ng-model="attrs.addElement" name="p_scnt_'+a+'" placeholder="Input Value" /></div>');r.append(i);var n=i.find("input");e(n)(t),a++})}}}]).directive("showIcon",["$compile","$translate",function(e,t){return{restrict:"EA",require:"ngModel",scope:{check:"&callbackFn"},link:function(i,n,r,a){var c,o,s=e('<a><span class = "glyphicon glyphicon-ok-circle" ng-show="enabled" style = "margin-top: 8px; color: #9ad64b; font-size: 15px;"></span></a>')(i);i.update=function(){n[0].blur(),i.check({arg1:{name:a.$name}})},n.bind("focus",function(){c=a.$viewValue,n.parent().after(s),i.enabled=!0,("email"===r.name||"mobile"===r.name||"tel"===r.name)&&(i.enabled=!1),i.$apply()}).bind("blur",function(){i.enabled=!1,o=a.$viewValue;var e=new RegExp(/(\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$/g);if("mobile"===r.name&&o&&!e.test(d.val()))return alert(t.instant("common.PHONE_ERROR")),$('input[name="mobile"]').addClass("error"),void $('input[name="mobile"]').change(function(){$(this).removeClass("error")});if("email"===r.name&&o){var s=new RegExp(/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/g);if(!s.test(n.val()))return alert("邮箱格式错误！")}(o||c)&&c!==o&&i.update(),i.$apply()})}}}]).directive("ngHover",function(){return{restrict:"EA",scope:{resource:"="},link:function(e,t,i){t.hover(function(){e.$apply(function(){e.resource.show=!0})},function(){e.$apply(function(){e.resource.show=!1})})}}}).directive("imgClick",function(){return{restrict:"EA",link:function(e,t,i){$(t).bind("click",function(){$(t).find("img").css("border","4px solid #F60"),$(t).siblings().find("img").css("border",0)})}}}).directive("customFocus",function(){return{restrict:"EA",link:function(e,t,i){$(t).siblings().bind("click",function(){t[0].focus()})}}}).directive("blurChildren",function(){return{restrict:"EA",link:function(e,t,i){$(t).on("click",function(e){(e.target==t[0]||$(e.target).hasClass("badge"))&&$(".blurClass").find("input:visible").blur()})}}}).directive("forbiddenClose",function(){return{restrict:"EAC",link:function(e,t,i){$(t).on("click",function(e){e.stopPropagation()})}}}).directive("customeImage",function(){return{restrict:"EA",link:function(e,t,i){$(t).hover(function(){$("<div><a></a></div>")},function(){})}}}).directive("slides",["configService",function(e){return{restrict:"EA",link:function(t,i,n){var r=$(i).find(".slides_container");e.getBanners().then(function(e){for(var t=e.data.split(","),n=0;n<t.length;n++){var a=[];a.push(t[n].split("|"));for(var c=0;c<a.length;c++)r.append('<img src="'+a[c][0]+'" usemap="#active'+n+'" width="1000px" height="720px" alt="Slide 1">'),a[c][1]&&r.after('<map name="active'+n+'" id="active'+n+'"><area shape="rect" coords="0,0,1000,720" target="_blank" href ="'+a[c][1]+'" /></map>')}$(i).slides({preload:!0,play:5e3,pause:2500,hoverPause:!0})},function(){r.append('<img src="'+CLIENT_CDN+'assets/images/3.jpg" width="1000px" height="720px" alt="Slide 1">'),r.append('<img src="'+CLIENT_CDN+'assets/images/2.jpg" width="1000px" height="720px" alt="Slide 1">'),r.append('<img src="'+CLIENT_CDN+'assets/images/1a.jpg" width="1000px" height="720px" alt="Slide 1">'),$(i).slides({preload:!0,play:5e3,pause:2500,hoverPause:!0})})}}}]).directive("slides3",["configSerService",function(e){return{restrict:"EA",link:function(t,i,n){var r=$(i).find(".slides_container");e.getActivityBanner(n.id).then(function(e){for(var t=e.data.list,a=0;a<t.length;a++){var c=$('<a href="'+t[a].url+'" style="display:block;" target="'+t[a].target+'" ></a>');c.append('<img src="'+t[a].path+'" width="'+n.width+'" height="'+n.height+'" alt="'+t[a].title+'" title="'+t[a].title+'" > '),r.append(c)}$(i).slides({preload:!0,play:5e3,pause:2500,hoverPause:!0})})}}}]).directive("addClass",function(){return{restrict:"EA",link:function(e,t,i){$(t).closest(".textbox-wrap").find("[autofocus]").focus(),$(t).on("blur",function(){$(t).closest(".textbox-wrap").removeClass("focused")}).on("focus",function(){$(t).closest(".textbox-wrap").addClass("focused")})}}}).directive("loadScript",["$http","$timeout","$rootScope",function(e,t,i){return{link:function(t,i,n){var r=function(){t.captchaLoaded=!0};t.$watch(function(){return i[0].getAttribute("src")},function(t,n){t&&e.jsonp(i[0].getAttribute("src")).success(r).error(r)})}}}]);