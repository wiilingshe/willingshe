angular.module("app.spread.console",[]).controller("ApplyConsoleCtrl",["$scope","$rootScope","applyObj","sceneSettingCache","SpreadService","pageTplService",function(e,t,p,i,s,a){e.apply||(e.apply={}),e.applyObj=p,2==p.type?(e.title="申请加入微课",e.description="申请加入微学宝官方微课平台，获取更多朋友的关注",i.sceneTagsPromise.then(function(t){var p=t.data.list||[];e.$watch("applyObj.sceneType",function(t){t&&(e.sceneTags=[],angular.forEach(p,function(p){t==p.bizType&&e.sceneTags.push(p)}))})})):1==p.type?(e.title="申请成为样例",e.description="申请微学宝官方推荐，成为其他用户创建微课的原型样例，还可以赚取微币",4==t.user.type&&i.sceneTplPricesPromise.then(function(t){e.tplPrices=t.data.list||[],e.apply.tplObj=e.tplPrices[0]})):3==p.type?(e.title="加入活动",e.description="与其他高手过招，展示自我深厚的制作功力，有机会获得活动大奖",a.getPageTpls(p.value).then(function(t){e.activityPageTpls=t.data.list||[]})):4==p.type&&(e.title="申请为企业样例");var c,l;e.apply=function(){if(2==p.type){if(!e.apply.showObj)return void(e.authError="请先选择微课类型！");c=e.apply.showObj.id}else if(1==p.type)c=4==t.user.type?e.apply.tplObj.value:0;else if(3==p.type){if(!n)return void(e.authError="请先选择活动尾页！");c=p.id+","+n}s.applyShareWay(p.sceneId,p.type,c)},e.$on("apply.scene.share",function(t,p){p.success?e.$close({value:c,src:l}):(alert(p.msg),e.$dismiss())});var n;e.selectActivePage=function(t){$.each(e.activityPageTpls,function(e,t){t.checked=!1}),t.checked=!0,n=t.id,t.properties&&t.properties.thumbSrc&&(l=t.properties.thumbSrc)},e.cancel=function(){e.$dismiss()}}]);